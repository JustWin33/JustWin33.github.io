<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content='CentOS/Ubuntuå·¥å…· ä¸€ã€ç³»ç»Ÿæ ¸å¿ƒå‘½ä»¤ 1.1 ç³»ç»Ÿä¿¡æ¯ä¾¦æŸ¥ 1 2 3 4 5 6 7 8 9 10 11 # ç»¼åˆä¿¡æ¯ï¼ˆæ¨èï¼‰ hostnamectl # CentOS 7+/Ubuntu 16.04+ cat /etc/os-release # æ‰€æœ‰å‘è¡Œç‰ˆæ ‡å‡† lscpu | grep "Model name" # CPUå‹å· free -h # å†…å­˜ df -hT # ç£ç›˜ uptime # è´Ÿè½½ dmesg | tail -50 # å†…æ ¸æ—¥å¿— # å¿«é€Ÿè¯Šæ–­ alias sysinfo=&#39;echo "--- CPU ---"; lscpu | grep "Model name"; echo "--- Memory ---"; free -h; echo "--- Disk ---"; df -hT | grep -v tmpfs; echo "--- Network ---"; ip a | grep "inet "; echo "--- Load ---"; uptime&#39; 1.2 LVMé€»è¾‘å·ç®¡ç†ï¼ˆå®Œæ•´æµç¨‹ï¼‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 # 1. åˆ›å»ºPV pvcreate /dev/sdb /dev/sdc pvs # 2. åˆ›å»ºVG vgcreate vg_data /dev/sdb /dev/sdc vgs # 3. åˆ›å»ºLV lvcreate -L 50G -n lv_app vg_data lvcreate -l 100%FREE -n lv_backup vg_data lvs # 4. æ ¼å¼åŒ– mkfs.xfs /dev/vg_data/lv_app # CentOSæ¨è mkfs.ext4 /dev/vg_data/lv_backup # Ubuntuæ¨è # 5. æŒ‚è½½ mkdir /app /backup mount /dev/vg_data/lv_app /app mount /dev/vg_data/lv_backup /backup # 6. æ‰©å®¹ï¼ˆåœ¨çº¿ï¼‰ lvextend -L +20G /dev/vg_data/lv_app xfs_growfs /app # XFSæ ¼å¼ # æˆ– resize2fs /dev/vg_data/lv_app # ext4æ ¼å¼ äºŒã€æ–‡ä»¶ä¸ç£ç›˜ç®¡ç† 2.1 ç£ç›˜ç®¡ç† 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 # æŸ¥çœ‹å¤§æ–‡ä»¶ du -ah --max-depth=2 /var | sort -rh | head -20 find / -type f -size +100M -exec ls -lh {} \\; 2>/dev/null | head # æ£€æŸ¥inode df -i # ç£ç›˜å¥åº· smartctl -a /dev/sda yum install -y smartmontools # CentOS apt install -y smartmontools # Ubuntu # ç£ç›˜æ¸…ç† ncdu / # äº¤äº’å¼ç£ç›˜åˆ†æ yum install -y ncdu # CentOS apt install -y ncdu # Ubuntu # ä¸´æ—¶æ–‡ä»¶æ¸…ç† find /tmp -type f -atime +7 -delete # åˆ é™¤7å¤©æœªè®¿é—®æ–‡ä»¶ 2.2 æ–‡ä»¶ä¼ è¾“ 1 2 3 4 5 6 7 8 9 10 11 # lrzszï¼ˆXshell/SecureCRTå¿…å¤‡ï¼‰ yum install -y lrzsz # CentOS apt install -y lrzsz # Ubuntu rz -y # ä¸Šä¼  sz filename # ä¸‹è½½ # rsyncé«˜çº§ç”¨æ³• rsync -avz --progress --partial --bwlimit=10000 /src/ user@remote:/dst/ # é™é€Ÿ10MB/s # æ–­ç‚¹ç»­ä¼  rsync --partial --progress large_file.iso user@remote:/tmp/ ä¸‰ã€ç½‘ç»œè¯Šæ–­å·¥å…· 3.1 åŸºç¡€ç½‘ç»œ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # æŸ¥çœ‹è¿æ¥ ss -antp | grep ESTAB # å·²å»ºç«‹è¿æ¥ ss -s # è¿æ¥ç»Ÿè®¡ lsof -i :8080 # ç«¯å£å ç”¨è¿›ç¨‹ # è·¯ç”±è¿½è¸ª mtr -r -c 10 baidu.com # 10æ¬¡æŠ¥å‘Šæ¨¡å¼ yum install -y mtr # CentOS apt install -y mtr-tiny # Ubuntu # å¸¦å®½æµ‹è¯• iperf3 -s # æœåŠ¡ç«¯ iperf3 -c server_ip -P 8 # å®¢æˆ·ç«¯8çº¿ç¨‹ yum install -y iperf3 # CentOS (EPEL) apt install -y iperf3 # Ubuntu 3.2 æŠ“åŒ…åˆ†æ 1 2 3 4 5 6 7 8 # tcpdumpç²¾ç¡®è¿‡æ»¤ tcpdump -i eth0 -w capture.pcap port 80 and host 192.168.1.100 tcpdump -A -s0 port 3306 and &#39;tcp[((tcp[12:1] & 0xf0) >> 2):4] = 0x73656c65&#39; # è¿‡æ»¤"select" # tsharkå®æ—¶åˆ†æ yum install -y wireshark # CentOS apt install -y tshark # Ubuntu tshark -i eth0 -Y "http.request" -T fields -e http.host -e http.request.uri 3.3 ç«¯å£æ‰«æ 1 2 3 4 5 6 7 8 nmap -sP 192.168.1.0/24 # å­˜æ´»ä¸»æœºæ‰«æ nmap -sS -p 1-65535 -T4 target # å…¨ç«¯å£SYNæ‰«æ nmap --script=vuln target # æ¼æ´æ‰«æ yum install -y nmap # CentOS apt install -y nmap # Ubuntu # Masscanè¶…é«˜é€Ÿæ‰«æ masscan 192.168.0.0/16 -p 80,443 --rate=10000 å››ã€ç›‘æ§ä¸æ€§èƒ½åˆ†æ 4.1 å®æ—¶ç›‘æ§ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 # glanceså…¨èƒ½ç›‘æ§ yum install -y glances # CentOS (EPEL) apt install -y glances # Ubuntu glances -w # Webæ¨¡å¼ http://ip:61208 # nethogsè¿›ç¨‹çº§æµé‡ yum install -y nethogs # CentOS (EPEL) apt install -y nethogs # Ubuntu nethogs -d 5 -v 3 # 5ç§’åˆ·æ–°ï¼Œæ˜¾ç¤ºMB # iotop IOç›‘æ§ yum install -y iotop # CentOS (EPEL) apt install -y iotop # Ubuntu iotop -oP # åªæ˜¾ç¤ºæœ‰IOçš„è¿›ç¨‹ # iftop æµé‡ç›‘æ§ yum install -y iftop # CentOS (EPEL) apt install -y iftop # Ubuntu iftop -i eth0 -n -P # æ˜¾ç¤ºç«¯å£å’ŒIP 4.2 æ€§èƒ½åˆ†æ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 # straceç³»ç»Ÿè°ƒç”¨ strace -c -p PID # ç»Ÿè®¡è€—æ—¶ strace -f -p PID # è·Ÿè¸ªå­è¿›ç¨‹ # perfå†…æ ¸çº§åˆ†æ yum install -y perf # CentOS apt install -y linux-tools-common # Ubuntu perf top -p PID # å®æ—¶åˆ†æ perf record -p PID -g # è®°å½•é‡‡æ · perf report # ç”ŸæˆæŠ¥å‘Š # lsofæŸ¥çœ‹æ–‡ä»¶å¥æŸ„ lsof -p PID | wc -l # ç»Ÿè®¡å¥æŸ„æ•° lsof -i TCP:3306 # æŸ¥çœ‹æ•°æ®åº“è¿æ¥ 4.3 å†å²æ•°æ® 1 2 3 4 5 6 7 8 9 # sarç³»ç»Ÿæ´»åŠ¨æŠ¥å‘Š yum install -y sysstat # CentOS apt install -y sysstat # Ubuntu systemctl enable --now sysstat # å¯ç”¨æ”¶é›† sar -u 1 10 # CPU sar -r 1 10 # å†…å­˜ sar -d 1 10 # ç£ç›˜ sar -n DEV 1 10 # ç½‘ç»œ äº”ã€æ–‡æœ¬ç¼–è¾‘å™¨é…ç½® 5.1 Vim è¿ç»´ç»ˆæé…ç½® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 # å®‰è£… yum install -y vim-enhanced vim-X11 # CentOS apt install -y vim vim-gtk3 # Ubuntu # å®Œæ•´é…ç½®ï¼ˆ~/.vimrcï¼‰ cat > ~/.vimrc << &#39;EOF&#39; " ==================== è¿ç»´ä¸“ç”¨ Vim é…ç½® ==================== set nocompatible syntax on set number relativenumber set cursorline ruler showcmd set incsearch hlsearch ignorecase smartcase set wrap linebreak set tabstop=4 shiftwidth=4 expandtab autoindent smartindent set mouse=a clipboard=unnamedplus set encoding=utf-8 fileencodings=utf-8,gbk,gb2312,gb18030 set pastetoggle=<F2> set listchars=tab:>-,trail:Â·,space:Â· nnoremap <F3> :set list!<cr> " å¿«é€Ÿç¼–è¾‘vimrc nnoremap <leader>ev :vsplit $MYVIMRC<cr> nnoremap <leader>sv :source $MYVIMRC<cr> " æ’ä»¶ç®¡ç†å™¨ curl -fLo ~/.vim/autoload/plug.vim --create-dirs \\ https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim call plug#begin(&#39;~/.vim/plugged&#39;) " æ–‡ä»¶æµè§ˆå™¨ Plug &#39;preservim/nerdtree&#39; nnoremap <F5> :NERDTreeToggle<cr> let NERDTreeShowHidden=1 " çŠ¶æ€æ  Plug &#39;vim-airline/vim-airline&#39; Plug &#39;vim-airline/vim-airline-themes&#39; " Gité›†æˆ Plug &#39;tpope/vim-fugitive&#39; nnoremap <leader>gs :Gstatus<cr> " æ™ºèƒ½è¡¥å…¨ Plug &#39;neoclide/coc.nvim&#39;, {&#39;branch&#39;: &#39;release&#39;} " è¯­æ³•æ£€æŸ¥ Plug &#39;dense-analysis/ale&#39; " å¿«é€Ÿæ³¨é‡Š Plug &#39;preservim/nerdcommenter&#39; " å½©è™¹æ‹¬å· Plug &#39;luochen1990/rainbow&#39; " æ–‡ä»¶æœç´¢ Plug &#39;ctrlpvim/ctrlp.vim&#39; " ç¼©è¿›çº¿ Plug &#39;Yggdroot/indentLine&#39; " æ—¥å¿—é«˜äº® Plug &#39;MTDL9/vim-log-highlighting&#39; " Kubernetes Plug &#39;andrewstuart/vim-kubernetes&#39; call plug#end() " YAMLç¼©è¿› autocmd FileType yaml setlocal ts=2 sts=2 sw=2 expandtab " å¤§æ–‡ä»¶ä¼˜åŒ– let g:LargeFile=10 autocmd BufReadPre * let f=getfsize(expand(&#39;%&#39;)) autocmd BufReadPre * if f > g:LargeFile*1024*1024 | set eventignore+=FileType | set syntax=OFF | set filetype=conf | endif EOF # å®‰è£…æ’ä»¶ vim +PlugInstall +qall 5.2 Nano åŸºç¡€é…ç½® 1 2 3 4 5 6 7 cat > ~/.nanorc << EOF include /usr/share/nano/*.nanorc set tabsize 4 set tabstospaces set autoindent set linenumbers EOF å…­ã€å®‰å…¨å®¡è®¡å·¥å…· 6.1 ç³»ç»Ÿå®‰å…¨æ‰«æ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # Lynis å®‰å…¨å®¡è®¡ yum install -y lynis # CentOS (EPEL) apt install -y lynis # Ubuntu lynis audit system --quick # å¿«é€Ÿæ‰«æ lynis audit system --pentest # æ¸—é€æµ‹è¯•æ¨¡å¼ # chkrootkit/rkhunter yum install -y rkhunter # CentOS apt install -y rkhunter chkrootkit # Ubuntu rkhunter --check --sk # æ£€æŸ¥rootkit # ClamAV æ€æ¯’ yum install -y clamav clamav-update # CentOS apt install -y clamav # Ubuntu freshclam # æ›´æ–°ç—…æ¯’åº“ clamscan -r /var/www # æ‰«æç›®å½• 6.2 å…¥ä¾µæ£€æµ‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 # Fail2ban é˜²æš´åŠ›ç ´è§£ yum install -y fail2ban # CentOS apt install -y fail2ban # Ubuntu cat > /etc/fail2ban/jail.local << EOF [sshd] enabled = true port = 22 filter = sshd logpath = /var/log/secure # Ubuntuä¸º/var/log/auth.log maxretry = 3 bantime = 3600 findtime = 600 EOF systemctl enable --now fail2ban fail2ban-client status sshd # AIDE æ–‡ä»¶å®Œæ•´æ€§æ£€æŸ¥ yum install -y aide # CentOS apt install -y aide # Ubuntu aideinit # åˆå§‹åŒ–æ•°æ®åº“ 6.3 æƒé™æ£€æŸ¥ 1 2 3 4 5 6 7 8 9 # SUID/SGIDæ–‡ä»¶ï¼ˆææƒé£é™©ï¼‰ find / -perm -4000 -type f 2>/dev/null find / -perm -2000 -type f 2>/dev/null # å…¨å±€å¯å†™æ–‡ä»¶ find / -type f -perm -002 2>/dev/null # æ— å±ä¸»æ–‡ä»¶ find / -nouser -o -nogroup 2>/dev/null ä¸ƒã€è‡ªåŠ¨åŒ–è¿ç»´å¹³å° 7.1 Ansible å¿«é€Ÿéƒ¨ç½² 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 # å®‰è£… pip3 install ansible --user # é…ç½® cat > ~/.ansible.cfg << EOF [defaults] host_key_checking = False inventory = ./hosts remote_user = root forks = 50 timeout = 30 [privilege_escalation] become = True become_method = sudo become_user = root EOF # hostsæ¸…å•ç¤ºä¾‹ cat > hosts << EOF [web] web[01:10].example.com [db] db01.example.com db02.example.com [k8s] k8s-master.example.com k8s-node[01:05].example.com EOF # å¸¸ç”¨æ¨¡å— ansible all -m ping ansible web -m shell -a "uptime" ansible db -m yum -a "name=mysql state=present" # CentOS ansible db -m apt -a "name=mysql-server state=present" # Ubuntu 7.2 SaltStack 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # å®‰è£… yum install -y salt-master salt-minion # CentOS apt install -y salt-master salt-minion # Ubuntu # é…ç½®minionæŒ‡å‘master sed -i &#39;s/#master: salt/master: salt-master.example.com/&#39; /etc/salt/minion systemctl enable --now salt-minion # æ¥å—key salt-key -L # åˆ—å‡ºå¾…æ¥å— salt-key -A # æ¥å—å…¨éƒ¨ # æ‰§è¡Œå‘½ä»¤ salt &#39;*&#39; test.ping salt &#39;*&#39; cmd.run &#39;uptime&#39; å…«ã€ç»ˆç«¯æ•ˆç‡å·¥å…· 8.1 tmux ç»ˆæé…ç½® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 # å®‰è£… yum install -y tmux # CentOS apt install -y tmux # Ubuntu # é…ç½®ï¼ˆ~/.tmux.confï¼‰ cat > ~/.tmux.conf << EOF # ä¿®æ”¹å‰ç¼€ä¸ºCtrl+A unbind C-b set -g prefix C-a bind C-a send-prefix # é¼ æ ‡æ”¯æŒ set -g mouse on # çŠ¶æ€æ  set -g status-right "%Y-%m-%d %H:%M" set -g status-interval 60 # çª—å£/é¢æ¿ bind c new-window -c "#{pane_current_path}" bind % split-window -h -c "#{pane_current_path}" bind &#39;"&#39; split-window -v -c "#{pane_current_path}" # é‡æ–°åŠ è½½ bind r source-file ~/.tmux.conf \\; display "Reloaded!" EOF # æ’ä»¶ç®¡ç†å™¨ git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm # å¸¸ç”¨æ“ä½œ tmux new -s ops # æ–°å»ºä¼šè¯ tmux attach -t ops # è¿æ¥ tmux ls # åˆ—å‡º Ctrl+A d # åˆ†ç¦» Ctrl+A c # æ–°çª—å£ Ctrl+A % # å‚ç›´åˆ†å± Ctrl+A " # æ°´å¹³åˆ†å± 8.2 fzf æ¨¡ç³ŠæŸ¥æ‰¾ 1 2 3 4 5 6 7 # å®‰è£… git clone --depth 1 https://github.com/junegunn/fzf.git ~/.fzf ~/.fzf/install # ä½¿ç”¨ç¤ºä¾‹ history | fzf find . -type f | fzf 8.3 autojump ç›®å½•è·³è½¬ 1 2 3 yum install -y autojump # CentOS (EPEL) apt install -y autojump # Ubuntu # ä½¿ç”¨: j myproject # è‡ªåŠ¨åŒ¹é…è·³è½¬ ä¹ã€äº‘åŸç”Ÿå·¥å…·é›† 9.1 Docker å…¨å®¶æ¡¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 # å®‰è£… curl -fsSL https://get.docker.com | bash # é…ç½®é•œåƒåŠ é€Ÿ cat > /etc/docker/daemon.json << EOF { "registry-mirrors": ["https://mirror.gcr.io"], "log-driver": "json-file", "log-opts": { "max-size": "100m", "max-file": "3" } } EOF # å¸¸ç”¨å·¥å…· docker stats # å®¹å™¨èµ„æº docker system df # ç£ç›˜ä½¿ç”¨ docker exec -it container_id bash # dive é•œåƒåˆ†æ curl -L https://github.com/wagoodman/dive/releases/download/v0.9.2/dive_0.9.2_linux_amd64.rpm -o dive.rpm && yum install -y dive # Ubuntuç”¨ https://github.com/wagoodman/dive/releases/download/v0.9.2/dive_0.9.2_linux_amd64.deb dive nginx:latest 9.2 Kubernetes å·¥å…· 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 # kubectl curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl" chmod +x kubectl && mv kubectl /usr/local/bin/ # k9s ç»ˆç«¯UI curl -sS https://webinstall.dev/k9s | bash # kubectx/kubens curl -L https://raw.githubusercontent.com/ahmetb/kubectx/master/kubectx -o /usr/local/bin/kubectx curl -L https://raw.githubusercontent.com/ahmetb/kubectx/master/kubens -o /usr/local/bin/kubens chmod +x /usr/local/bin/kubectx /usr/local/bin/kubens # Helm curl https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3 | bash # åˆ«å alias k=&#39;kubectl&#39; alias kg=&#39;kubectl get&#39; alias kd=&#39;kubectl describe&#39; alias ke=&#39;kubectl exec -it&#39; alias klog=&#39;kubectl logs -f&#39; åã€ä¸€é”®å®‰è£…è„šæœ¬ 10.1 CentOS è¿ç»´å…¨å®¶æ¡¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 cat > install_ops_tools_centos.sh << &#39;EOF&#39; #!/bin/bash set -e echo ">>> å®‰è£…EPELæº" yum install -y epel-release echo ">>> å®‰è£…åŸºç¡€å·¥å…·" yum install -y vim htop iotop iftop nethogs glances git telnet net-tools bind-utils traceroute mtr nc tcpdump nmap lsof strace ltrace sysstat dstat bash-completion chrony unzip zip psmisc screen tmux expect pv jq python3-pip ncdu tree smartmontools ipmitool dmidecode echo ">>> å®‰è£…ç½‘ç»œå·¥å…·" yum install -y nethogs iftop mtr nmap tcpdump echo ">>> å®‰è£…ç›‘æ§å·¥å…·" yum install -y htop iotop glances dstat echo ">>> å®‰è£…æ—¥å¿—å·¥å…·" yum install -y lnav multitail echo ">>> å®‰è£…Docker" curl -fsSL https://get.docker.com | bash systemctl enable --now docker echo ">>> å®‰è£…Pythonå·¥å…·" pip3 install --user mycli pgcli ansible yq thefuck echo ">>> å®‰è£…Tmuxæ’ä»¶ç®¡ç†å™¨" git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm echo ">>> å®‰è£…Vimæ’ä»¶ç®¡ç†å™¨" curl -fLo ~/.vim/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim echo ">>> å®‰è£…fzf" git clone --depth 1 https://github.com/junegunn/fzf.git ~/.fzf ~/.fzf/install echo ">>> å®‰è£…neofetch" yum install -y neofetch echo "å®Œæˆï¼è¯·æ‰‹åŠ¨è¿è¡Œ vim +PlugInstall å’Œ tmuxæ’ä»¶å®‰è£…(Ctrl+A I)" EOF chmod +x install_ops_tools_centos.sh 10.2 Ubuntu è¿ç»´å…¨å®¶æ¡¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 cat > install_ops_tools_ubuntu.sh << &#39;EOF&#39; #!/bin/bash set -e echo ">>> æ›´æ–°æº" apt update echo ">>> å®‰è£…åŸºç¡€å·¥å…·" apt install -y vim htop iotop iftop nethogs glances git telnet net-tools dnsutils traceroute mtr netcat-openbsd tcpdump nmap lsof strace ltrace sysstat dstat bash-completion chrony unzip zip psmisc screen tmux expect pv jq python3-pip ncdu tree smartmontools ipmitool dmidecode echo ">>> å®‰è£…ç½‘ç»œå·¥å…·" apt install -y nethogs iftop mtr nmap tcpdump echo ">>> å®‰è£…ç›‘æ§å·¥å…·" apt install -y htop iotop glances dstat echo ">>> å®‰è£…æ—¥å¿—å·¥å…·" apt install -y lnav multitail echo ">>> å®‰è£…Docker" curl -fsSL https://get.docker.com | bash systemctl enable --now docker echo ">>> å®‰è£…Pythonå·¥å…·" pip3 install --user mycli pgcli ansible yq thefuck echo ">>> å®‰è£…Tmuxæ’ä»¶ç®¡ç†å™¨" git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm echo ">>> å®‰è£…Vimæ’ä»¶ç®¡ç†å™¨" curl -fLo ~/.vim/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim echo ">>> å®‰è£…fzf" git clone --depth 1 https://github.com/junegunn/fzf.git ~/.fzf ~/.fzf/install echo ">>> å®‰è£…neofetch" apt install -y neofetch echo "å®Œæˆï¼è¯·æ‰‹åŠ¨è¿è¡Œ vim +PlugInstall å’Œ tmuxæ’ä»¶å®‰è£…(Ctrl+A I)" EOF chmod +x install_ops_tools_ubuntu.sh åä¸€ã€è¿ç»´åˆ«ååº“ï¼ˆ~/.bashrcï¼‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 cat >> ~/.bashrc << &#39;EOF&#39; # ==================== è¿ç»´åˆ«ååº“ ==================== # ç³»ç»Ÿä¿¡æ¯ alias sysinfo=&#39;echo "--- CPU ---"; lscpu | grep "Model name"; echo "--- Memory ---"; free -h; echo "--- Disk ---"; df -hT | grep -v tmpfs; echo "--- Network ---"; ip a | grep "inet "; echo "--- Load ---"; uptime&#39; alias ports=&#39;ss -tuln | grep LISTEN&#39; alias bigfiles=&#39;find / -type f -size +100M -exec ls -lh {} \\; 2>/dev/null | head -20&#39; alias iplist=&#39;ip a | grep "inet " | awk \\&#39;{print $2}\\&#39;&#39; # åŒ…ç®¡ç† alias yup=&#39;yum update -y&#39; alias yin=&#39;yum install -y&#39; alias yrm=&#39;yum remove -y&#39; alias ysearch=&#39;yum search&#39; alias aup=&#39;apt update && apt upgrade -y&#39; alias ain=&#39;apt install -y&#39; alias arm=&#39;apt remove -y&#39; alias asearch=&#39;apt search&#39; # Docker alias dps=&#39;docker ps --format "table {{.ID}}\\t{{.Names}}\\t{{.Status}}\\t{{.Ports}}"&#39; alias dsa=&#39;docker stop $(docker ps -aq)&#39; alias drma=&#39;docker rm $(docker ps -aq)&#39; alias dcl=&#39;docker system prune -a&#39; # K8s alias k=&#39;kubectl&#39; alias kg=&#39;kubectl get&#39; alias kd=&#39;kubectl describe&#39; alias ke=&#39;kubectl exec -it&#39; alias klog=&#39;kubectl logs -f&#39; alias kdel=&#39;kubectl delete&#39; # æ—¥å¿— alias tailf=&#39;tail -f&#39; alias grepall=&#39;grep -r --include="*.log" --include="*.txt"&#39; alias journalerr=&#39;journalctl -p err -f&#39; alias journalboot=&#39;journalctl -b&#39; # ç½‘ç»œ alias nettest=&#39;ping 114.114.114.114 -c 3 && ping 8.8.8.8 -c 3 && ping baidu.com -c 3&#39; alias ports80=&#39;ss -ant | grep :80 | wc -l&#39; alias ports443=&#39;ss -ant | grep :443 | wc -l&#39; # å®‰å…¨ alias ssh20=&#39;ssh -o ServerAliveInterval=60 -o TCPKeepAlive=yes&#39; alias sshproxy=&#39;ssh -D 1080 -C -N&#39; # é¢œè‰² alias ls=&#39;ls --color=auto&#39; alias ll=&#39;ls -lhF&#39; alias grep=&#39;grep --color=auto&#39; alias ip=&#39;ip -c&#39; # Ubuntu # å†å²è®°å½•å¢å¼º export HISTTIMEFORMAT="%Y-%m-%d %H:%M:%S " export HISTSIZE=10000 export HISTFILESIZE=10000 shopt -s histappend export PROMPT_COMMAND="history -a; history -c; history -r; $PROMPT_COMMAND" # è·¯å¾„ export PATH=$PATH:/usr/local/bin:/usr/local/sbin:$HOME/.local/bin # å®‰å…¨åˆ é™¤ alias rm=&#39;rm -i&#39; alias cp=&#39;cp -i&#39; alias mv=&#39;mv -i&#39; # è§£å‹ä¸‡èƒ½å‡½æ•° extract() { if [ -f $1 ]; then case $1 in *.tar.bz2) tar xjf $1 ;; *.tar.gz) tar xzf $1 ;; *.bz2) bunzip2 $1 ;; *.rar) unrar x $1 ;; *.gz) gunzip $1 ;; *.tar) tar xf $1 ;; *.tbz2) tar xjf $1 ;; *.tgz) tar xzf $1 ;; *.zip) unzip $1 ;; *.Z) uncompress $1 ;; *.7z) 7z x $1 ;; *) echo "&#39;$1&#39; cannot be extracted via extract()" ;; esac else echo "&#39;$1&#39; is not a valid file" fi } # å¿«é€ŸSSH keyåˆ†å‘ ssh-copy-id() { if [ -z "$1" ]; then echo "Usage: ssh-copy-id user@host" return 1 fi cat ~/.ssh/id_rsa.pub | ssh $1 "mkdir -p ~/.ssh && chmod 700 ~/.ssh && cat >> ~/.ssh/authorized_keys && chmod 600 ~/.ssh/authorized_keys" } # å¤‡ä»½é…ç½® backup_cfg() { local dest="/tmp/config_backup_$(date +%Y%m%d_%H%M%S).tar.gz" tar -czf $dest /etc/nginx /etc/httpd /etc/mysql /etc/redis /etc/sysconfig 2>/dev/null echo "é…ç½®å·²å¤‡ä»½åˆ°: $dest" } # åŠ è½½é…ç½® source ~/.bashrc EOF åäºŒã€åº”æ€¥å“åº”æ‰‹å†Œ 12.1 ç³»ç»Ÿè¢«å…¥ä¾µåº”æ€¥ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 #!/bin/bash # incident_response.sh echo ">>> 1. éš”ç¦»ç½‘ç»œï¼ˆå¦‚å¿…è¦ï¼‰" # iptables -A OUTPUT -j DROP echo ">>> 2. ä¿å­˜ç°åœº" mkdir -p /tmp/incident_$(date +%Y%m%d) cd /tmp/incident_$(date +%Y%m%d) # ä¿å­˜è¿›ç¨‹ä¿¡æ¯ ps aux > ps.aux.txt lsof > lsof.txt # ä¿å­˜ç½‘ç»œè¿æ¥ ss -antp > ss.antp.txt netstat -tulpn > netstat.tulpn.txt # ä¿å­˜ç”¨æˆ·ä¿¡æ¯ cat /etc/passwd > passwd.txt cat /etc/shadow > shadow.txt last > last.txt # ä¿å­˜æ—¥å¿— cp /var/log/secure . 2>/dev/null cp /var/log/auth.log . 2>/dev/null cp /var/log/nginx/access.log . 2>/dev/null echo ">>> 3. æŸ¥æ‰¾å¯ç–‘æ–‡ä»¶" find /tmp /var/tmp -type f -executable -exec ls -lh {} \\; > suspicious_files.txt echo ">>> 4. æŸ¥æ‰¾å¯ç–‘è¿›ç¨‹" ps aux | awk &#39;$3 > 50 {print $0}&#39; > high_cpu.txt ps aux | awk &#39;$4 > 10 {print $0}&#39; > high_mem.txt echo ">>> 5. æŸ¥æ‰¾å¯ç–‘è¿æ¥" ss -antp | grep -v &#39;127.0.0.1&#39; > suspicious_conn.txt echo ">>> æ•°æ®å·²ä¿å­˜åˆ°: /tmp/incident_$(date +%Y%m%d)" 12.2 DDoSæ”»å‡»åº”å¯¹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # æŸ¥çœ‹SYNæ´ªæ°´ netstat -n | awk &#39;/^tcp/ {++state[$6]} END {for(key in state) print key,state[key]}&#39; # é™åˆ¶SYN iptables -A INPUT -p tcp --syn -m limit --limit 1/s -j ACCEPT iptables -A INPUT -p tcp --syn -j DROP # å°ç¦IPï¼ˆä½¿ç”¨firewalldï¼‰ firewall-cmd --permanent --add-rich-rule=&#39;rule source address="192.168.1.100" reject&#39; firewall-cmd --reload # å°ç¦IPï¼ˆä½¿ç”¨ufwï¼‰ ufw deny from 192.168.1.100 # CloudFlareæ¨¡å¼ï¼ˆè·å–çœŸå®IPï¼‰ # åœ¨nginxä¸­é…ç½®: set_real_ip_from 103.21.244.0/22; åä¸‰ã€æ—¥å¸¸å·¡æ£€è„šæœ¬ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 cat > daily_check.sh << &#39;EOF&#39; #!/bin/bash REPORT="/tmp/daily_report_$(hostname)_$(date +%Y%m%d).txt" echo "===== ä¸»æœº: $(hostname) | æ—¶é—´: $(date) =====" > $REPORT echo "" >> $REPORT echo "--- CPUè´Ÿè½½ ---" >> $REPORT uptime >> $REPORT echo "" >> $REPORT echo "--- å†…å­˜ä½¿ç”¨ ---" >> $REPORT free -h >> $REPORT echo "" >> $REPORT echo "--- ç£ç›˜ä½¿ç”¨ ---" >> $REPORT df -hT >> $REPORT echo "" >> $REPORT echo "--- ç£ç›˜IO ---" >> $REPORT iostat -x 1 5 >> $REPORT echo "" >> $REPORT echo "--- ç½‘ç»œè¿æ¥ ---" >> $REPORT ss -ant | grep ESTAB | wc -l >> $REPORT echo "" >> $REPORT echo "--- ç›‘å¬ç«¯å£ ---" >> $REPORT ss -tuln | grep LISTEN >> $REPORT echo "" >> $REPORT echo "--- ç™»å½•å¤±è´¥ ---" >> $REPORT grep "Failed password" /var/log/secure 2>/dev/null | tail -20 >> $REPORT grep "Failed password" /var/log/auth.log 2>/dev/null | tail -20 >> $REPORT echo "" >> $REPORT echo "--- åƒµå°¸è¿›ç¨‹ ---" >> $REPORT ps aux | awk &#39;$8~/Z/ {print $0}&#39; >> $REPORT echo "" >> $REPORT echo "--- æœåŠ¡çŠ¶æ€ ---" >> $REPORT systemctl list-units --state=failed --no-pager >> $REPORT echo "" >> $REPORT echo "--- æœ€è¿‘å˜æ›´ ---" >> $REPORT find /etc /usr/local/bin -type f -mtime -1 2>/dev/null | head -20 >> $REPORT mail -s "Daily Check Report: $(hostname)" ops@company.com < $REPORT echo "æŠ¥å‘Šå·²å‘é€åˆ°é‚®ç®±" EOF chmod +x daily_check.sh # åŠ å…¥crontab: 0 8 * * * /path/to/daily_check.sh ğŸ¯ ä½¿ç”¨å»ºè®® æ–°æœåŠ¡å™¨åˆå§‹åŒ–ï¼šè¿è¡Œå¯¹åº”ç³»ç»Ÿçš„ä¸€é”®å®‰è£…è„šæœ¬ ä¸ªäººç¯å¢ƒé…ç½®ï¼šå¤åˆ¶æ‰€æœ‰é…ç½®æ–‡ä»¶ï¼ˆ.vimrc, .bashrc, .tmux.confï¼‰ æ—¥å¸¸å·¡æ£€ï¼šéƒ¨ç½²daily_check.shåˆ°æ‰€æœ‰æœåŠ¡å™¨ åº”æ€¥å“åº”ï¼šå‡†å¤‡å¥½incident_response.shï¼Œéšæ—¶å¯ç”¨ æŒç»­å­¦ä¹ ï¼šæ¯å‘¨å°è¯•ä¸€ä¸ªæ–°å·¥å…·ï¼Œé€æ­¥æ›¿æ¢ä½æ•ˆæ“ä½œ å®Œæ•´é…ç½®å·²å°±ç»ªï¼Œç›´æ¥å¤åˆ¶ä½¿ç”¨å³å¯ï¼ç¥è¿ç»´å·¥ä½œé¡ºåˆ©ï¼\n'><title>Linuxå·¥å…·</title><link rel=canonical href=http://localhost:1313/posts/linux%E5%B7%A5%E5%85%B7/><link rel=stylesheet href=/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css><meta property='og:title' content="Linuxå·¥å…·"><meta property='og:description' content='CentOS/Ubuntuå·¥å…· ä¸€ã€ç³»ç»Ÿæ ¸å¿ƒå‘½ä»¤ 1.1 ç³»ç»Ÿä¿¡æ¯ä¾¦æŸ¥ 1 2 3 4 5 6 7 8 9 10 11 # ç»¼åˆä¿¡æ¯ï¼ˆæ¨èï¼‰ hostnamectl # CentOS 7+/Ubuntu 16.04+ cat /etc/os-release # æ‰€æœ‰å‘è¡Œç‰ˆæ ‡å‡† lscpu | grep "Model name" # CPUå‹å· free -h # å†…å­˜ df -hT # ç£ç›˜ uptime # è´Ÿè½½ dmesg | tail -50 # å†…æ ¸æ—¥å¿— # å¿«é€Ÿè¯Šæ–­ alias sysinfo=&#39;echo "--- CPU ---"; lscpu | grep "Model name"; echo "--- Memory ---"; free -h; echo "--- Disk ---"; df -hT | grep -v tmpfs; echo "--- Network ---"; ip a | grep "inet "; echo "--- Load ---"; uptime&#39; 1.2 LVMé€»è¾‘å·ç®¡ç†ï¼ˆå®Œæ•´æµç¨‹ï¼‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 # 1. åˆ›å»ºPV pvcreate /dev/sdb /dev/sdc pvs # 2. åˆ›å»ºVG vgcreate vg_data /dev/sdb /dev/sdc vgs # 3. åˆ›å»ºLV lvcreate -L 50G -n lv_app vg_data lvcreate -l 100%FREE -n lv_backup vg_data lvs # 4. æ ¼å¼åŒ– mkfs.xfs /dev/vg_data/lv_app # CentOSæ¨è mkfs.ext4 /dev/vg_data/lv_backup # Ubuntuæ¨è # 5. æŒ‚è½½ mkdir /app /backup mount /dev/vg_data/lv_app /app mount /dev/vg_data/lv_backup /backup # 6. æ‰©å®¹ï¼ˆåœ¨çº¿ï¼‰ lvextend -L +20G /dev/vg_data/lv_app xfs_growfs /app # XFSæ ¼å¼ # æˆ– resize2fs /dev/vg_data/lv_app # ext4æ ¼å¼ äºŒã€æ–‡ä»¶ä¸ç£ç›˜ç®¡ç† 2.1 ç£ç›˜ç®¡ç† 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 # æŸ¥çœ‹å¤§æ–‡ä»¶ du -ah --max-depth=2 /var | sort -rh | head -20 find / -type f -size +100M -exec ls -lh {} \\; 2>/dev/null | head # æ£€æŸ¥inode df -i # ç£ç›˜å¥åº· smartctl -a /dev/sda yum install -y smartmontools # CentOS apt install -y smartmontools # Ubuntu # ç£ç›˜æ¸…ç† ncdu / # äº¤äº’å¼ç£ç›˜åˆ†æ yum install -y ncdu # CentOS apt install -y ncdu # Ubuntu # ä¸´æ—¶æ–‡ä»¶æ¸…ç† find /tmp -type f -atime +7 -delete # åˆ é™¤7å¤©æœªè®¿é—®æ–‡ä»¶ 2.2 æ–‡ä»¶ä¼ è¾“ 1 2 3 4 5 6 7 8 9 10 11 # lrzszï¼ˆXshell/SecureCRTå¿…å¤‡ï¼‰ yum install -y lrzsz # CentOS apt install -y lrzsz # Ubuntu rz -y # ä¸Šä¼  sz filename # ä¸‹è½½ # rsyncé«˜çº§ç”¨æ³• rsync -avz --progress --partial --bwlimit=10000 /src/ user@remote:/dst/ # é™é€Ÿ10MB/s # æ–­ç‚¹ç»­ä¼  rsync --partial --progress large_file.iso user@remote:/tmp/ ä¸‰ã€ç½‘ç»œè¯Šæ–­å·¥å…· 3.1 åŸºç¡€ç½‘ç»œ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # æŸ¥çœ‹è¿æ¥ ss -antp | grep ESTAB # å·²å»ºç«‹è¿æ¥ ss -s # è¿æ¥ç»Ÿè®¡ lsof -i :8080 # ç«¯å£å ç”¨è¿›ç¨‹ # è·¯ç”±è¿½è¸ª mtr -r -c 10 baidu.com # 10æ¬¡æŠ¥å‘Šæ¨¡å¼ yum install -y mtr # CentOS apt install -y mtr-tiny # Ubuntu # å¸¦å®½æµ‹è¯• iperf3 -s # æœåŠ¡ç«¯ iperf3 -c server_ip -P 8 # å®¢æˆ·ç«¯8çº¿ç¨‹ yum install -y iperf3 # CentOS (EPEL) apt install -y iperf3 # Ubuntu 3.2 æŠ“åŒ…åˆ†æ 1 2 3 4 5 6 7 8 # tcpdumpç²¾ç¡®è¿‡æ»¤ tcpdump -i eth0 -w capture.pcap port 80 and host 192.168.1.100 tcpdump -A -s0 port 3306 and &#39;tcp[((tcp[12:1] & 0xf0) >> 2):4] = 0x73656c65&#39; # è¿‡æ»¤"select" # tsharkå®æ—¶åˆ†æ yum install -y wireshark # CentOS apt install -y tshark # Ubuntu tshark -i eth0 -Y "http.request" -T fields -e http.host -e http.request.uri 3.3 ç«¯å£æ‰«æ 1 2 3 4 5 6 7 8 nmap -sP 192.168.1.0/24 # å­˜æ´»ä¸»æœºæ‰«æ nmap -sS -p 1-65535 -T4 target # å…¨ç«¯å£SYNæ‰«æ nmap --script=vuln target # æ¼æ´æ‰«æ yum install -y nmap # CentOS apt install -y nmap # Ubuntu # Masscanè¶…é«˜é€Ÿæ‰«æ masscan 192.168.0.0/16 -p 80,443 --rate=10000 å››ã€ç›‘æ§ä¸æ€§èƒ½åˆ†æ 4.1 å®æ—¶ç›‘æ§ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 # glanceså…¨èƒ½ç›‘æ§ yum install -y glances # CentOS (EPEL) apt install -y glances # Ubuntu glances -w # Webæ¨¡å¼ http://ip:61208 # nethogsè¿›ç¨‹çº§æµé‡ yum install -y nethogs # CentOS (EPEL) apt install -y nethogs # Ubuntu nethogs -d 5 -v 3 # 5ç§’åˆ·æ–°ï¼Œæ˜¾ç¤ºMB # iotop IOç›‘æ§ yum install -y iotop # CentOS (EPEL) apt install -y iotop # Ubuntu iotop -oP # åªæ˜¾ç¤ºæœ‰IOçš„è¿›ç¨‹ # iftop æµé‡ç›‘æ§ yum install -y iftop # CentOS (EPEL) apt install -y iftop # Ubuntu iftop -i eth0 -n -P # æ˜¾ç¤ºç«¯å£å’ŒIP 4.2 æ€§èƒ½åˆ†æ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 # straceç³»ç»Ÿè°ƒç”¨ strace -c -p PID # ç»Ÿè®¡è€—æ—¶ strace -f -p PID # è·Ÿè¸ªå­è¿›ç¨‹ # perfå†…æ ¸çº§åˆ†æ yum install -y perf # CentOS apt install -y linux-tools-common # Ubuntu perf top -p PID # å®æ—¶åˆ†æ perf record -p PID -g # è®°å½•é‡‡æ · perf report # ç”ŸæˆæŠ¥å‘Š # lsofæŸ¥çœ‹æ–‡ä»¶å¥æŸ„ lsof -p PID | wc -l # ç»Ÿè®¡å¥æŸ„æ•° lsof -i TCP:3306 # æŸ¥çœ‹æ•°æ®åº“è¿æ¥ 4.3 å†å²æ•°æ® 1 2 3 4 5 6 7 8 9 # sarç³»ç»Ÿæ´»åŠ¨æŠ¥å‘Š yum install -y sysstat # CentOS apt install -y sysstat # Ubuntu systemctl enable --now sysstat # å¯ç”¨æ”¶é›† sar -u 1 10 # CPU sar -r 1 10 # å†…å­˜ sar -d 1 10 # ç£ç›˜ sar -n DEV 1 10 # ç½‘ç»œ äº”ã€æ–‡æœ¬ç¼–è¾‘å™¨é…ç½® 5.1 Vim è¿ç»´ç»ˆæé…ç½® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 # å®‰è£… yum install -y vim-enhanced vim-X11 # CentOS apt install -y vim vim-gtk3 # Ubuntu # å®Œæ•´é…ç½®ï¼ˆ~/.vimrcï¼‰ cat > ~/.vimrc << &#39;EOF&#39; " ==================== è¿ç»´ä¸“ç”¨ Vim é…ç½® ==================== set nocompatible syntax on set number relativenumber set cursorline ruler showcmd set incsearch hlsearch ignorecase smartcase set wrap linebreak set tabstop=4 shiftwidth=4 expandtab autoindent smartindent set mouse=a clipboard=unnamedplus set encoding=utf-8 fileencodings=utf-8,gbk,gb2312,gb18030 set pastetoggle=<F2> set listchars=tab:>-,trail:Â·,space:Â· nnoremap <F3> :set list!<cr> " å¿«é€Ÿç¼–è¾‘vimrc nnoremap <leader>ev :vsplit $MYVIMRC<cr> nnoremap <leader>sv :source $MYVIMRC<cr> " æ’ä»¶ç®¡ç†å™¨ curl -fLo ~/.vim/autoload/plug.vim --create-dirs \\ https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim call plug#begin(&#39;~/.vim/plugged&#39;) " æ–‡ä»¶æµè§ˆå™¨ Plug &#39;preservim/nerdtree&#39; nnoremap <F5> :NERDTreeToggle<cr> let NERDTreeShowHidden=1 " çŠ¶æ€æ  Plug &#39;vim-airline/vim-airline&#39; Plug &#39;vim-airline/vim-airline-themes&#39; " Gité›†æˆ Plug &#39;tpope/vim-fugitive&#39; nnoremap <leader>gs :Gstatus<cr> " æ™ºèƒ½è¡¥å…¨ Plug &#39;neoclide/coc.nvim&#39;, {&#39;branch&#39;: &#39;release&#39;} " è¯­æ³•æ£€æŸ¥ Plug &#39;dense-analysis/ale&#39; " å¿«é€Ÿæ³¨é‡Š Plug &#39;preservim/nerdcommenter&#39; " å½©è™¹æ‹¬å· Plug &#39;luochen1990/rainbow&#39; " æ–‡ä»¶æœç´¢ Plug &#39;ctrlpvim/ctrlp.vim&#39; " ç¼©è¿›çº¿ Plug &#39;Yggdroot/indentLine&#39; " æ—¥å¿—é«˜äº® Plug &#39;MTDL9/vim-log-highlighting&#39; " Kubernetes Plug &#39;andrewstuart/vim-kubernetes&#39; call plug#end() " YAMLç¼©è¿› autocmd FileType yaml setlocal ts=2 sts=2 sw=2 expandtab " å¤§æ–‡ä»¶ä¼˜åŒ– let g:LargeFile=10 autocmd BufReadPre * let f=getfsize(expand(&#39;%&#39;)) autocmd BufReadPre * if f > g:LargeFile*1024*1024 | set eventignore+=FileType | set syntax=OFF | set filetype=conf | endif EOF # å®‰è£…æ’ä»¶ vim +PlugInstall +qall 5.2 Nano åŸºç¡€é…ç½® 1 2 3 4 5 6 7 cat > ~/.nanorc << EOF include /usr/share/nano/*.nanorc set tabsize 4 set tabstospaces set autoindent set linenumbers EOF å…­ã€å®‰å…¨å®¡è®¡å·¥å…· 6.1 ç³»ç»Ÿå®‰å…¨æ‰«æ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # Lynis å®‰å…¨å®¡è®¡ yum install -y lynis # CentOS (EPEL) apt install -y lynis # Ubuntu lynis audit system --quick # å¿«é€Ÿæ‰«æ lynis audit system --pentest # æ¸—é€æµ‹è¯•æ¨¡å¼ # chkrootkit/rkhunter yum install -y rkhunter # CentOS apt install -y rkhunter chkrootkit # Ubuntu rkhunter --check --sk # æ£€æŸ¥rootkit # ClamAV æ€æ¯’ yum install -y clamav clamav-update # CentOS apt install -y clamav # Ubuntu freshclam # æ›´æ–°ç—…æ¯’åº“ clamscan -r /var/www # æ‰«æç›®å½• 6.2 å…¥ä¾µæ£€æµ‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 # Fail2ban é˜²æš´åŠ›ç ´è§£ yum install -y fail2ban # CentOS apt install -y fail2ban # Ubuntu cat > /etc/fail2ban/jail.local << EOF [sshd] enabled = true port = 22 filter = sshd logpath = /var/log/secure # Ubuntuä¸º/var/log/auth.log maxretry = 3 bantime = 3600 findtime = 600 EOF systemctl enable --now fail2ban fail2ban-client status sshd # AIDE æ–‡ä»¶å®Œæ•´æ€§æ£€æŸ¥ yum install -y aide # CentOS apt install -y aide # Ubuntu aideinit # åˆå§‹åŒ–æ•°æ®åº“ 6.3 æƒé™æ£€æŸ¥ 1 2 3 4 5 6 7 8 9 # SUID/SGIDæ–‡ä»¶ï¼ˆææƒé£é™©ï¼‰ find / -perm -4000 -type f 2>/dev/null find / -perm -2000 -type f 2>/dev/null # å…¨å±€å¯å†™æ–‡ä»¶ find / -type f -perm -002 2>/dev/null # æ— å±ä¸»æ–‡ä»¶ find / -nouser -o -nogroup 2>/dev/null ä¸ƒã€è‡ªåŠ¨åŒ–è¿ç»´å¹³å° 7.1 Ansible å¿«é€Ÿéƒ¨ç½² 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 # å®‰è£… pip3 install ansible --user # é…ç½® cat > ~/.ansible.cfg << EOF [defaults] host_key_checking = False inventory = ./hosts remote_user = root forks = 50 timeout = 30 [privilege_escalation] become = True become_method = sudo become_user = root EOF # hostsæ¸…å•ç¤ºä¾‹ cat > hosts << EOF [web] web[01:10].example.com [db] db01.example.com db02.example.com [k8s] k8s-master.example.com k8s-node[01:05].example.com EOF # å¸¸ç”¨æ¨¡å— ansible all -m ping ansible web -m shell -a "uptime" ansible db -m yum -a "name=mysql state=present" # CentOS ansible db -m apt -a "name=mysql-server state=present" # Ubuntu 7.2 SaltStack 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # å®‰è£… yum install -y salt-master salt-minion # CentOS apt install -y salt-master salt-minion # Ubuntu # é…ç½®minionæŒ‡å‘master sed -i &#39;s/#master: salt/master: salt-master.example.com/&#39; /etc/salt/minion systemctl enable --now salt-minion # æ¥å—key salt-key -L # åˆ—å‡ºå¾…æ¥å— salt-key -A # æ¥å—å…¨éƒ¨ # æ‰§è¡Œå‘½ä»¤ salt &#39;*&#39; test.ping salt &#39;*&#39; cmd.run &#39;uptime&#39; å…«ã€ç»ˆç«¯æ•ˆç‡å·¥å…· 8.1 tmux ç»ˆæé…ç½® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 # å®‰è£… yum install -y tmux # CentOS apt install -y tmux # Ubuntu # é…ç½®ï¼ˆ~/.tmux.confï¼‰ cat > ~/.tmux.conf << EOF # ä¿®æ”¹å‰ç¼€ä¸ºCtrl+A unbind C-b set -g prefix C-a bind C-a send-prefix # é¼ æ ‡æ”¯æŒ set -g mouse on # çŠ¶æ€æ  set -g status-right "%Y-%m-%d %H:%M" set -g status-interval 60 # çª—å£/é¢æ¿ bind c new-window -c "#{pane_current_path}" bind % split-window -h -c "#{pane_current_path}" bind &#39;"&#39; split-window -v -c "#{pane_current_path}" # é‡æ–°åŠ è½½ bind r source-file ~/.tmux.conf \\; display "Reloaded!" EOF # æ’ä»¶ç®¡ç†å™¨ git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm # å¸¸ç”¨æ“ä½œ tmux new -s ops # æ–°å»ºä¼šè¯ tmux attach -t ops # è¿æ¥ tmux ls # åˆ—å‡º Ctrl+A d # åˆ†ç¦» Ctrl+A c # æ–°çª—å£ Ctrl+A % # å‚ç›´åˆ†å± Ctrl+A " # æ°´å¹³åˆ†å± 8.2 fzf æ¨¡ç³ŠæŸ¥æ‰¾ 1 2 3 4 5 6 7 # å®‰è£… git clone --depth 1 https://github.com/junegunn/fzf.git ~/.fzf ~/.fzf/install # ä½¿ç”¨ç¤ºä¾‹ history | fzf find . -type f | fzf 8.3 autojump ç›®å½•è·³è½¬ 1 2 3 yum install -y autojump # CentOS (EPEL) apt install -y autojump # Ubuntu # ä½¿ç”¨: j myproject # è‡ªåŠ¨åŒ¹é…è·³è½¬ ä¹ã€äº‘åŸç”Ÿå·¥å…·é›† 9.1 Docker å…¨å®¶æ¡¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 # å®‰è£… curl -fsSL https://get.docker.com | bash # é…ç½®é•œåƒåŠ é€Ÿ cat > /etc/docker/daemon.json << EOF { "registry-mirrors": ["https://mirror.gcr.io"], "log-driver": "json-file", "log-opts": { "max-size": "100m", "max-file": "3" } } EOF # å¸¸ç”¨å·¥å…· docker stats # å®¹å™¨èµ„æº docker system df # ç£ç›˜ä½¿ç”¨ docker exec -it container_id bash # dive é•œåƒåˆ†æ curl -L https://github.com/wagoodman/dive/releases/download/v0.9.2/dive_0.9.2_linux_amd64.rpm -o dive.rpm && yum install -y dive # Ubuntuç”¨ https://github.com/wagoodman/dive/releases/download/v0.9.2/dive_0.9.2_linux_amd64.deb dive nginx:latest 9.2 Kubernetes å·¥å…· 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 # kubectl curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl" chmod +x kubectl && mv kubectl /usr/local/bin/ # k9s ç»ˆç«¯UI curl -sS https://webinstall.dev/k9s | bash # kubectx/kubens curl -L https://raw.githubusercontent.com/ahmetb/kubectx/master/kubectx -o /usr/local/bin/kubectx curl -L https://raw.githubusercontent.com/ahmetb/kubectx/master/kubens -o /usr/local/bin/kubens chmod +x /usr/local/bin/kubectx /usr/local/bin/kubens # Helm curl https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3 | bash # åˆ«å alias k=&#39;kubectl&#39; alias kg=&#39;kubectl get&#39; alias kd=&#39;kubectl describe&#39; alias ke=&#39;kubectl exec -it&#39; alias klog=&#39;kubectl logs -f&#39; åã€ä¸€é”®å®‰è£…è„šæœ¬ 10.1 CentOS è¿ç»´å…¨å®¶æ¡¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 cat > install_ops_tools_centos.sh << &#39;EOF&#39; #!/bin/bash set -e echo ">>> å®‰è£…EPELæº" yum install -y epel-release echo ">>> å®‰è£…åŸºç¡€å·¥å…·" yum install -y vim htop iotop iftop nethogs glances git telnet net-tools bind-utils traceroute mtr nc tcpdump nmap lsof strace ltrace sysstat dstat bash-completion chrony unzip zip psmisc screen tmux expect pv jq python3-pip ncdu tree smartmontools ipmitool dmidecode echo ">>> å®‰è£…ç½‘ç»œå·¥å…·" yum install -y nethogs iftop mtr nmap tcpdump echo ">>> å®‰è£…ç›‘æ§å·¥å…·" yum install -y htop iotop glances dstat echo ">>> å®‰è£…æ—¥å¿—å·¥å…·" yum install -y lnav multitail echo ">>> å®‰è£…Docker" curl -fsSL https://get.docker.com | bash systemctl enable --now docker echo ">>> å®‰è£…Pythonå·¥å…·" pip3 install --user mycli pgcli ansible yq thefuck echo ">>> å®‰è£…Tmuxæ’ä»¶ç®¡ç†å™¨" git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm echo ">>> å®‰è£…Vimæ’ä»¶ç®¡ç†å™¨" curl -fLo ~/.vim/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim echo ">>> å®‰è£…fzf" git clone --depth 1 https://github.com/junegunn/fzf.git ~/.fzf ~/.fzf/install echo ">>> å®‰è£…neofetch" yum install -y neofetch echo "å®Œæˆï¼è¯·æ‰‹åŠ¨è¿è¡Œ vim +PlugInstall å’Œ tmuxæ’ä»¶å®‰è£…(Ctrl+A I)" EOF chmod +x install_ops_tools_centos.sh 10.2 Ubuntu è¿ç»´å…¨å®¶æ¡¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 cat > install_ops_tools_ubuntu.sh << &#39;EOF&#39; #!/bin/bash set -e echo ">>> æ›´æ–°æº" apt update echo ">>> å®‰è£…åŸºç¡€å·¥å…·" apt install -y vim htop iotop iftop nethogs glances git telnet net-tools dnsutils traceroute mtr netcat-openbsd tcpdump nmap lsof strace ltrace sysstat dstat bash-completion chrony unzip zip psmisc screen tmux expect pv jq python3-pip ncdu tree smartmontools ipmitool dmidecode echo ">>> å®‰è£…ç½‘ç»œå·¥å…·" apt install -y nethogs iftop mtr nmap tcpdump echo ">>> å®‰è£…ç›‘æ§å·¥å…·" apt install -y htop iotop glances dstat echo ">>> å®‰è£…æ—¥å¿—å·¥å…·" apt install -y lnav multitail echo ">>> å®‰è£…Docker" curl -fsSL https://get.docker.com | bash systemctl enable --now docker echo ">>> å®‰è£…Pythonå·¥å…·" pip3 install --user mycli pgcli ansible yq thefuck echo ">>> å®‰è£…Tmuxæ’ä»¶ç®¡ç†å™¨" git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm echo ">>> å®‰è£…Vimæ’ä»¶ç®¡ç†å™¨" curl -fLo ~/.vim/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim echo ">>> å®‰è£…fzf" git clone --depth 1 https://github.com/junegunn/fzf.git ~/.fzf ~/.fzf/install echo ">>> å®‰è£…neofetch" apt install -y neofetch echo "å®Œæˆï¼è¯·æ‰‹åŠ¨è¿è¡Œ vim +PlugInstall å’Œ tmuxæ’ä»¶å®‰è£…(Ctrl+A I)" EOF chmod +x install_ops_tools_ubuntu.sh åä¸€ã€è¿ç»´åˆ«ååº“ï¼ˆ~/.bashrcï¼‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 cat >> ~/.bashrc << &#39;EOF&#39; # ==================== è¿ç»´åˆ«ååº“ ==================== # ç³»ç»Ÿä¿¡æ¯ alias sysinfo=&#39;echo "--- CPU ---"; lscpu | grep "Model name"; echo "--- Memory ---"; free -h; echo "--- Disk ---"; df -hT | grep -v tmpfs; echo "--- Network ---"; ip a | grep "inet "; echo "--- Load ---"; uptime&#39; alias ports=&#39;ss -tuln | grep LISTEN&#39; alias bigfiles=&#39;find / -type f -size +100M -exec ls -lh {} \\; 2>/dev/null | head -20&#39; alias iplist=&#39;ip a | grep "inet " | awk \\&#39;{print $2}\\&#39;&#39; # åŒ…ç®¡ç† alias yup=&#39;yum update -y&#39; alias yin=&#39;yum install -y&#39; alias yrm=&#39;yum remove -y&#39; alias ysearch=&#39;yum search&#39; alias aup=&#39;apt update && apt upgrade -y&#39; alias ain=&#39;apt install -y&#39; alias arm=&#39;apt remove -y&#39; alias asearch=&#39;apt search&#39; # Docker alias dps=&#39;docker ps --format "table {{.ID}}\\t{{.Names}}\\t{{.Status}}\\t{{.Ports}}"&#39; alias dsa=&#39;docker stop $(docker ps -aq)&#39; alias drma=&#39;docker rm $(docker ps -aq)&#39; alias dcl=&#39;docker system prune -a&#39; # K8s alias k=&#39;kubectl&#39; alias kg=&#39;kubectl get&#39; alias kd=&#39;kubectl describe&#39; alias ke=&#39;kubectl exec -it&#39; alias klog=&#39;kubectl logs -f&#39; alias kdel=&#39;kubectl delete&#39; # æ—¥å¿— alias tailf=&#39;tail -f&#39; alias grepall=&#39;grep -r --include="*.log" --include="*.txt"&#39; alias journalerr=&#39;journalctl -p err -f&#39; alias journalboot=&#39;journalctl -b&#39; # ç½‘ç»œ alias nettest=&#39;ping 114.114.114.114 -c 3 && ping 8.8.8.8 -c 3 && ping baidu.com -c 3&#39; alias ports80=&#39;ss -ant | grep :80 | wc -l&#39; alias ports443=&#39;ss -ant | grep :443 | wc -l&#39; # å®‰å…¨ alias ssh20=&#39;ssh -o ServerAliveInterval=60 -o TCPKeepAlive=yes&#39; alias sshproxy=&#39;ssh -D 1080 -C -N&#39; # é¢œè‰² alias ls=&#39;ls --color=auto&#39; alias ll=&#39;ls -lhF&#39; alias grep=&#39;grep --color=auto&#39; alias ip=&#39;ip -c&#39; # Ubuntu # å†å²è®°å½•å¢å¼º export HISTTIMEFORMAT="%Y-%m-%d %H:%M:%S " export HISTSIZE=10000 export HISTFILESIZE=10000 shopt -s histappend export PROMPT_COMMAND="history -a; history -c; history -r; $PROMPT_COMMAND" # è·¯å¾„ export PATH=$PATH:/usr/local/bin:/usr/local/sbin:$HOME/.local/bin # å®‰å…¨åˆ é™¤ alias rm=&#39;rm -i&#39; alias cp=&#39;cp -i&#39; alias mv=&#39;mv -i&#39; # è§£å‹ä¸‡èƒ½å‡½æ•° extract() { if [ -f $1 ]; then case $1 in *.tar.bz2) tar xjf $1 ;; *.tar.gz) tar xzf $1 ;; *.bz2) bunzip2 $1 ;; *.rar) unrar x $1 ;; *.gz) gunzip $1 ;; *.tar) tar xf $1 ;; *.tbz2) tar xjf $1 ;; *.tgz) tar xzf $1 ;; *.zip) unzip $1 ;; *.Z) uncompress $1 ;; *.7z) 7z x $1 ;; *) echo "&#39;$1&#39; cannot be extracted via extract()" ;; esac else echo "&#39;$1&#39; is not a valid file" fi } # å¿«é€ŸSSH keyåˆ†å‘ ssh-copy-id() { if [ -z "$1" ]; then echo "Usage: ssh-copy-id user@host" return 1 fi cat ~/.ssh/id_rsa.pub | ssh $1 "mkdir -p ~/.ssh && chmod 700 ~/.ssh && cat >> ~/.ssh/authorized_keys && chmod 600 ~/.ssh/authorized_keys" } # å¤‡ä»½é…ç½® backup_cfg() { local dest="/tmp/config_backup_$(date +%Y%m%d_%H%M%S).tar.gz" tar -czf $dest /etc/nginx /etc/httpd /etc/mysql /etc/redis /etc/sysconfig 2>/dev/null echo "é…ç½®å·²å¤‡ä»½åˆ°: $dest" } # åŠ è½½é…ç½® source ~/.bashrc EOF åäºŒã€åº”æ€¥å“åº”æ‰‹å†Œ 12.1 ç³»ç»Ÿè¢«å…¥ä¾µåº”æ€¥ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 #!/bin/bash # incident_response.sh echo ">>> 1. éš”ç¦»ç½‘ç»œï¼ˆå¦‚å¿…è¦ï¼‰" # iptables -A OUTPUT -j DROP echo ">>> 2. ä¿å­˜ç°åœº" mkdir -p /tmp/incident_$(date +%Y%m%d) cd /tmp/incident_$(date +%Y%m%d) # ä¿å­˜è¿›ç¨‹ä¿¡æ¯ ps aux > ps.aux.txt lsof > lsof.txt # ä¿å­˜ç½‘ç»œè¿æ¥ ss -antp > ss.antp.txt netstat -tulpn > netstat.tulpn.txt # ä¿å­˜ç”¨æˆ·ä¿¡æ¯ cat /etc/passwd > passwd.txt cat /etc/shadow > shadow.txt last > last.txt # ä¿å­˜æ—¥å¿— cp /var/log/secure . 2>/dev/null cp /var/log/auth.log . 2>/dev/null cp /var/log/nginx/access.log . 2>/dev/null echo ">>> 3. æŸ¥æ‰¾å¯ç–‘æ–‡ä»¶" find /tmp /var/tmp -type f -executable -exec ls -lh {} \\; > suspicious_files.txt echo ">>> 4. æŸ¥æ‰¾å¯ç–‘è¿›ç¨‹" ps aux | awk &#39;$3 > 50 {print $0}&#39; > high_cpu.txt ps aux | awk &#39;$4 > 10 {print $0}&#39; > high_mem.txt echo ">>> 5. æŸ¥æ‰¾å¯ç–‘è¿æ¥" ss -antp | grep -v &#39;127.0.0.1&#39; > suspicious_conn.txt echo ">>> æ•°æ®å·²ä¿å­˜åˆ°: /tmp/incident_$(date +%Y%m%d)" 12.2 DDoSæ”»å‡»åº”å¯¹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # æŸ¥çœ‹SYNæ´ªæ°´ netstat -n | awk &#39;/^tcp/ {++state[$6]} END {for(key in state) print key,state[key]}&#39; # é™åˆ¶SYN iptables -A INPUT -p tcp --syn -m limit --limit 1/s -j ACCEPT iptables -A INPUT -p tcp --syn -j DROP # å°ç¦IPï¼ˆä½¿ç”¨firewalldï¼‰ firewall-cmd --permanent --add-rich-rule=&#39;rule source address="192.168.1.100" reject&#39; firewall-cmd --reload # å°ç¦IPï¼ˆä½¿ç”¨ufwï¼‰ ufw deny from 192.168.1.100 # CloudFlareæ¨¡å¼ï¼ˆè·å–çœŸå®IPï¼‰ # åœ¨nginxä¸­é…ç½®: set_real_ip_from 103.21.244.0/22; åä¸‰ã€æ—¥å¸¸å·¡æ£€è„šæœ¬ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 cat > daily_check.sh << &#39;EOF&#39; #!/bin/bash REPORT="/tmp/daily_report_$(hostname)_$(date +%Y%m%d).txt" echo "===== ä¸»æœº: $(hostname) | æ—¶é—´: $(date) =====" > $REPORT echo "" >> $REPORT echo "--- CPUè´Ÿè½½ ---" >> $REPORT uptime >> $REPORT echo "" >> $REPORT echo "--- å†…å­˜ä½¿ç”¨ ---" >> $REPORT free -h >> $REPORT echo "" >> $REPORT echo "--- ç£ç›˜ä½¿ç”¨ ---" >> $REPORT df -hT >> $REPORT echo "" >> $REPORT echo "--- ç£ç›˜IO ---" >> $REPORT iostat -x 1 5 >> $REPORT echo "" >> $REPORT echo "--- ç½‘ç»œè¿æ¥ ---" >> $REPORT ss -ant | grep ESTAB | wc -l >> $REPORT echo "" >> $REPORT echo "--- ç›‘å¬ç«¯å£ ---" >> $REPORT ss -tuln | grep LISTEN >> $REPORT echo "" >> $REPORT echo "--- ç™»å½•å¤±è´¥ ---" >> $REPORT grep "Failed password" /var/log/secure 2>/dev/null | tail -20 >> $REPORT grep "Failed password" /var/log/auth.log 2>/dev/null | tail -20 >> $REPORT echo "" >> $REPORT echo "--- åƒµå°¸è¿›ç¨‹ ---" >> $REPORT ps aux | awk &#39;$8~/Z/ {print $0}&#39; >> $REPORT echo "" >> $REPORT echo "--- æœåŠ¡çŠ¶æ€ ---" >> $REPORT systemctl list-units --state=failed --no-pager >> $REPORT echo "" >> $REPORT echo "--- æœ€è¿‘å˜æ›´ ---" >> $REPORT find /etc /usr/local/bin -type f -mtime -1 2>/dev/null | head -20 >> $REPORT mail -s "Daily Check Report: $(hostname)" ops@company.com < $REPORT echo "æŠ¥å‘Šå·²å‘é€åˆ°é‚®ç®±" EOF chmod +x daily_check.sh # åŠ å…¥crontab: 0 8 * * * /path/to/daily_check.sh ğŸ¯ ä½¿ç”¨å»ºè®® æ–°æœåŠ¡å™¨åˆå§‹åŒ–ï¼šè¿è¡Œå¯¹åº”ç³»ç»Ÿçš„ä¸€é”®å®‰è£…è„šæœ¬ ä¸ªäººç¯å¢ƒé…ç½®ï¼šå¤åˆ¶æ‰€æœ‰é…ç½®æ–‡ä»¶ï¼ˆ.vimrc, .bashrc, .tmux.confï¼‰ æ—¥å¸¸å·¡æ£€ï¼šéƒ¨ç½²daily_check.shåˆ°æ‰€æœ‰æœåŠ¡å™¨ åº”æ€¥å“åº”ï¼šå‡†å¤‡å¥½incident_response.shï¼Œéšæ—¶å¯ç”¨ æŒç»­å­¦ä¹ ï¼šæ¯å‘¨å°è¯•ä¸€ä¸ªæ–°å·¥å…·ï¼Œé€æ­¥æ›¿æ¢ä½æ•ˆæ“ä½œ å®Œæ•´é…ç½®å·²å°±ç»ªï¼Œç›´æ¥å¤åˆ¶ä½¿ç”¨å³å¯ï¼ç¥è¿ç»´å·¥ä½œé¡ºåˆ©ï¼\n'><meta property='og:url' content='http://localhost:1313/posts/linux%E5%B7%A5%E5%85%B7/'><meta property='og:site_name' content='JustWin'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:published_time' content='2025-11-09T00:00:00+00:00'><meta property='article:modified_time' content='2025-11-09T00:00:00+00:00'><meta property='og:image' content='http://localhost:1313/'><meta name=twitter:title content="Linuxå·¥å…·"><meta name=twitter:description content='CentOS/Ubuntuå·¥å…· ä¸€ã€ç³»ç»Ÿæ ¸å¿ƒå‘½ä»¤ 1.1 ç³»ç»Ÿä¿¡æ¯ä¾¦æŸ¥ 1 2 3 4 5 6 7 8 9 10 11 # ç»¼åˆä¿¡æ¯ï¼ˆæ¨èï¼‰ hostnamectl # CentOS 7+/Ubuntu 16.04+ cat /etc/os-release # æ‰€æœ‰å‘è¡Œç‰ˆæ ‡å‡† lscpu | grep "Model name" # CPUå‹å· free -h # å†…å­˜ df -hT # ç£ç›˜ uptime # è´Ÿè½½ dmesg | tail -50 # å†…æ ¸æ—¥å¿— # å¿«é€Ÿè¯Šæ–­ alias sysinfo=&#39;echo "--- CPU ---"; lscpu | grep "Model name"; echo "--- Memory ---"; free -h; echo "--- Disk ---"; df -hT | grep -v tmpfs; echo "--- Network ---"; ip a | grep "inet "; echo "--- Load ---"; uptime&#39; 1.2 LVMé€»è¾‘å·ç®¡ç†ï¼ˆå®Œæ•´æµç¨‹ï¼‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 # 1. åˆ›å»ºPV pvcreate /dev/sdb /dev/sdc pvs # 2. åˆ›å»ºVG vgcreate vg_data /dev/sdb /dev/sdc vgs # 3. åˆ›å»ºLV lvcreate -L 50G -n lv_app vg_data lvcreate -l 100%FREE -n lv_backup vg_data lvs # 4. æ ¼å¼åŒ– mkfs.xfs /dev/vg_data/lv_app # CentOSæ¨è mkfs.ext4 /dev/vg_data/lv_backup # Ubuntuæ¨è # 5. æŒ‚è½½ mkdir /app /backup mount /dev/vg_data/lv_app /app mount /dev/vg_data/lv_backup /backup # 6. æ‰©å®¹ï¼ˆåœ¨çº¿ï¼‰ lvextend -L +20G /dev/vg_data/lv_app xfs_growfs /app # XFSæ ¼å¼ # æˆ– resize2fs /dev/vg_data/lv_app # ext4æ ¼å¼ äºŒã€æ–‡ä»¶ä¸ç£ç›˜ç®¡ç† 2.1 ç£ç›˜ç®¡ç† 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 # æŸ¥çœ‹å¤§æ–‡ä»¶ du -ah --max-depth=2 /var | sort -rh | head -20 find / -type f -size +100M -exec ls -lh {} \\; 2>/dev/null | head # æ£€æŸ¥inode df -i # ç£ç›˜å¥åº· smartctl -a /dev/sda yum install -y smartmontools # CentOS apt install -y smartmontools # Ubuntu # ç£ç›˜æ¸…ç† ncdu / # äº¤äº’å¼ç£ç›˜åˆ†æ yum install -y ncdu # CentOS apt install -y ncdu # Ubuntu # ä¸´æ—¶æ–‡ä»¶æ¸…ç† find /tmp -type f -atime +7 -delete # åˆ é™¤7å¤©æœªè®¿é—®æ–‡ä»¶ 2.2 æ–‡ä»¶ä¼ è¾“ 1 2 3 4 5 6 7 8 9 10 11 # lrzszï¼ˆXshell/SecureCRTå¿…å¤‡ï¼‰ yum install -y lrzsz # CentOS apt install -y lrzsz # Ubuntu rz -y # ä¸Šä¼  sz filename # ä¸‹è½½ # rsyncé«˜çº§ç”¨æ³• rsync -avz --progress --partial --bwlimit=10000 /src/ user@remote:/dst/ # é™é€Ÿ10MB/s # æ–­ç‚¹ç»­ä¼  rsync --partial --progress large_file.iso user@remote:/tmp/ ä¸‰ã€ç½‘ç»œè¯Šæ–­å·¥å…· 3.1 åŸºç¡€ç½‘ç»œ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # æŸ¥çœ‹è¿æ¥ ss -antp | grep ESTAB # å·²å»ºç«‹è¿æ¥ ss -s # è¿æ¥ç»Ÿè®¡ lsof -i :8080 # ç«¯å£å ç”¨è¿›ç¨‹ # è·¯ç”±è¿½è¸ª mtr -r -c 10 baidu.com # 10æ¬¡æŠ¥å‘Šæ¨¡å¼ yum install -y mtr # CentOS apt install -y mtr-tiny # Ubuntu # å¸¦å®½æµ‹è¯• iperf3 -s # æœåŠ¡ç«¯ iperf3 -c server_ip -P 8 # å®¢æˆ·ç«¯8çº¿ç¨‹ yum install -y iperf3 # CentOS (EPEL) apt install -y iperf3 # Ubuntu 3.2 æŠ“åŒ…åˆ†æ 1 2 3 4 5 6 7 8 # tcpdumpç²¾ç¡®è¿‡æ»¤ tcpdump -i eth0 -w capture.pcap port 80 and host 192.168.1.100 tcpdump -A -s0 port 3306 and &#39;tcp[((tcp[12:1] & 0xf0) >> 2):4] = 0x73656c65&#39; # è¿‡æ»¤"select" # tsharkå®æ—¶åˆ†æ yum install -y wireshark # CentOS apt install -y tshark # Ubuntu tshark -i eth0 -Y "http.request" -T fields -e http.host -e http.request.uri 3.3 ç«¯å£æ‰«æ 1 2 3 4 5 6 7 8 nmap -sP 192.168.1.0/24 # å­˜æ´»ä¸»æœºæ‰«æ nmap -sS -p 1-65535 -T4 target # å…¨ç«¯å£SYNæ‰«æ nmap --script=vuln target # æ¼æ´æ‰«æ yum install -y nmap # CentOS apt install -y nmap # Ubuntu # Masscanè¶…é«˜é€Ÿæ‰«æ masscan 192.168.0.0/16 -p 80,443 --rate=10000 å››ã€ç›‘æ§ä¸æ€§èƒ½åˆ†æ 4.1 å®æ—¶ç›‘æ§ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 # glanceså…¨èƒ½ç›‘æ§ yum install -y glances # CentOS (EPEL) apt install -y glances # Ubuntu glances -w # Webæ¨¡å¼ http://ip:61208 # nethogsè¿›ç¨‹çº§æµé‡ yum install -y nethogs # CentOS (EPEL) apt install -y nethogs # Ubuntu nethogs -d 5 -v 3 # 5ç§’åˆ·æ–°ï¼Œæ˜¾ç¤ºMB # iotop IOç›‘æ§ yum install -y iotop # CentOS (EPEL) apt install -y iotop # Ubuntu iotop -oP # åªæ˜¾ç¤ºæœ‰IOçš„è¿›ç¨‹ # iftop æµé‡ç›‘æ§ yum install -y iftop # CentOS (EPEL) apt install -y iftop # Ubuntu iftop -i eth0 -n -P # æ˜¾ç¤ºç«¯å£å’ŒIP 4.2 æ€§èƒ½åˆ†æ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 # straceç³»ç»Ÿè°ƒç”¨ strace -c -p PID # ç»Ÿè®¡è€—æ—¶ strace -f -p PID # è·Ÿè¸ªå­è¿›ç¨‹ # perfå†…æ ¸çº§åˆ†æ yum install -y perf # CentOS apt install -y linux-tools-common # Ubuntu perf top -p PID # å®æ—¶åˆ†æ perf record -p PID -g # è®°å½•é‡‡æ · perf report # ç”ŸæˆæŠ¥å‘Š # lsofæŸ¥çœ‹æ–‡ä»¶å¥æŸ„ lsof -p PID | wc -l # ç»Ÿè®¡å¥æŸ„æ•° lsof -i TCP:3306 # æŸ¥çœ‹æ•°æ®åº“è¿æ¥ 4.3 å†å²æ•°æ® 1 2 3 4 5 6 7 8 9 # sarç³»ç»Ÿæ´»åŠ¨æŠ¥å‘Š yum install -y sysstat # CentOS apt install -y sysstat # Ubuntu systemctl enable --now sysstat # å¯ç”¨æ”¶é›† sar -u 1 10 # CPU sar -r 1 10 # å†…å­˜ sar -d 1 10 # ç£ç›˜ sar -n DEV 1 10 # ç½‘ç»œ äº”ã€æ–‡æœ¬ç¼–è¾‘å™¨é…ç½® 5.1 Vim è¿ç»´ç»ˆæé…ç½® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 # å®‰è£… yum install -y vim-enhanced vim-X11 # CentOS apt install -y vim vim-gtk3 # Ubuntu # å®Œæ•´é…ç½®ï¼ˆ~/.vimrcï¼‰ cat > ~/.vimrc << &#39;EOF&#39; " ==================== è¿ç»´ä¸“ç”¨ Vim é…ç½® ==================== set nocompatible syntax on set number relativenumber set cursorline ruler showcmd set incsearch hlsearch ignorecase smartcase set wrap linebreak set tabstop=4 shiftwidth=4 expandtab autoindent smartindent set mouse=a clipboard=unnamedplus set encoding=utf-8 fileencodings=utf-8,gbk,gb2312,gb18030 set pastetoggle=<F2> set listchars=tab:>-,trail:Â·,space:Â· nnoremap <F3> :set list!<cr> " å¿«é€Ÿç¼–è¾‘vimrc nnoremap <leader>ev :vsplit $MYVIMRC<cr> nnoremap <leader>sv :source $MYVIMRC<cr> " æ’ä»¶ç®¡ç†å™¨ curl -fLo ~/.vim/autoload/plug.vim --create-dirs \\ https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim call plug#begin(&#39;~/.vim/plugged&#39;) " æ–‡ä»¶æµè§ˆå™¨ Plug &#39;preservim/nerdtree&#39; nnoremap <F5> :NERDTreeToggle<cr> let NERDTreeShowHidden=1 " çŠ¶æ€æ  Plug &#39;vim-airline/vim-airline&#39; Plug &#39;vim-airline/vim-airline-themes&#39; " Gité›†æˆ Plug &#39;tpope/vim-fugitive&#39; nnoremap <leader>gs :Gstatus<cr> " æ™ºèƒ½è¡¥å…¨ Plug &#39;neoclide/coc.nvim&#39;, {&#39;branch&#39;: &#39;release&#39;} " è¯­æ³•æ£€æŸ¥ Plug &#39;dense-analysis/ale&#39; " å¿«é€Ÿæ³¨é‡Š Plug &#39;preservim/nerdcommenter&#39; " å½©è™¹æ‹¬å· Plug &#39;luochen1990/rainbow&#39; " æ–‡ä»¶æœç´¢ Plug &#39;ctrlpvim/ctrlp.vim&#39; " ç¼©è¿›çº¿ Plug &#39;Yggdroot/indentLine&#39; " æ—¥å¿—é«˜äº® Plug &#39;MTDL9/vim-log-highlighting&#39; " Kubernetes Plug &#39;andrewstuart/vim-kubernetes&#39; call plug#end() " YAMLç¼©è¿› autocmd FileType yaml setlocal ts=2 sts=2 sw=2 expandtab " å¤§æ–‡ä»¶ä¼˜åŒ– let g:LargeFile=10 autocmd BufReadPre * let f=getfsize(expand(&#39;%&#39;)) autocmd BufReadPre * if f > g:LargeFile*1024*1024 | set eventignore+=FileType | set syntax=OFF | set filetype=conf | endif EOF # å®‰è£…æ’ä»¶ vim +PlugInstall +qall 5.2 Nano åŸºç¡€é…ç½® 1 2 3 4 5 6 7 cat > ~/.nanorc << EOF include /usr/share/nano/*.nanorc set tabsize 4 set tabstospaces set autoindent set linenumbers EOF å…­ã€å®‰å…¨å®¡è®¡å·¥å…· 6.1 ç³»ç»Ÿå®‰å…¨æ‰«æ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # Lynis å®‰å…¨å®¡è®¡ yum install -y lynis # CentOS (EPEL) apt install -y lynis # Ubuntu lynis audit system --quick # å¿«é€Ÿæ‰«æ lynis audit system --pentest # æ¸—é€æµ‹è¯•æ¨¡å¼ # chkrootkit/rkhunter yum install -y rkhunter # CentOS apt install -y rkhunter chkrootkit # Ubuntu rkhunter --check --sk # æ£€æŸ¥rootkit # ClamAV æ€æ¯’ yum install -y clamav clamav-update # CentOS apt install -y clamav # Ubuntu freshclam # æ›´æ–°ç—…æ¯’åº“ clamscan -r /var/www # æ‰«æç›®å½• 6.2 å…¥ä¾µæ£€æµ‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 # Fail2ban é˜²æš´åŠ›ç ´è§£ yum install -y fail2ban # CentOS apt install -y fail2ban # Ubuntu cat > /etc/fail2ban/jail.local << EOF [sshd] enabled = true port = 22 filter = sshd logpath = /var/log/secure # Ubuntuä¸º/var/log/auth.log maxretry = 3 bantime = 3600 findtime = 600 EOF systemctl enable --now fail2ban fail2ban-client status sshd # AIDE æ–‡ä»¶å®Œæ•´æ€§æ£€æŸ¥ yum install -y aide # CentOS apt install -y aide # Ubuntu aideinit # åˆå§‹åŒ–æ•°æ®åº“ 6.3 æƒé™æ£€æŸ¥ 1 2 3 4 5 6 7 8 9 # SUID/SGIDæ–‡ä»¶ï¼ˆææƒé£é™©ï¼‰ find / -perm -4000 -type f 2>/dev/null find / -perm -2000 -type f 2>/dev/null # å…¨å±€å¯å†™æ–‡ä»¶ find / -type f -perm -002 2>/dev/null # æ— å±ä¸»æ–‡ä»¶ find / -nouser -o -nogroup 2>/dev/null ä¸ƒã€è‡ªåŠ¨åŒ–è¿ç»´å¹³å° 7.1 Ansible å¿«é€Ÿéƒ¨ç½² 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 # å®‰è£… pip3 install ansible --user # é…ç½® cat > ~/.ansible.cfg << EOF [defaults] host_key_checking = False inventory = ./hosts remote_user = root forks = 50 timeout = 30 [privilege_escalation] become = True become_method = sudo become_user = root EOF # hostsæ¸…å•ç¤ºä¾‹ cat > hosts << EOF [web] web[01:10].example.com [db] db01.example.com db02.example.com [k8s] k8s-master.example.com k8s-node[01:05].example.com EOF # å¸¸ç”¨æ¨¡å— ansible all -m ping ansible web -m shell -a "uptime" ansible db -m yum -a "name=mysql state=present" # CentOS ansible db -m apt -a "name=mysql-server state=present" # Ubuntu 7.2 SaltStack 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 # å®‰è£… yum install -y salt-master salt-minion # CentOS apt install -y salt-master salt-minion # Ubuntu # é…ç½®minionæŒ‡å‘master sed -i &#39;s/#master: salt/master: salt-master.example.com/&#39; /etc/salt/minion systemctl enable --now salt-minion # æ¥å—key salt-key -L # åˆ—å‡ºå¾…æ¥å— salt-key -A # æ¥å—å…¨éƒ¨ # æ‰§è¡Œå‘½ä»¤ salt &#39;*&#39; test.ping salt &#39;*&#39; cmd.run &#39;uptime&#39; å…«ã€ç»ˆç«¯æ•ˆç‡å·¥å…· 8.1 tmux ç»ˆæé…ç½® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 # å®‰è£… yum install -y tmux # CentOS apt install -y tmux # Ubuntu # é…ç½®ï¼ˆ~/.tmux.confï¼‰ cat > ~/.tmux.conf << EOF # ä¿®æ”¹å‰ç¼€ä¸ºCtrl+A unbind C-b set -g prefix C-a bind C-a send-prefix # é¼ æ ‡æ”¯æŒ set -g mouse on # çŠ¶æ€æ  set -g status-right "%Y-%m-%d %H:%M" set -g status-interval 60 # çª—å£/é¢æ¿ bind c new-window -c "#{pane_current_path}" bind % split-window -h -c "#{pane_current_path}" bind &#39;"&#39; split-window -v -c "#{pane_current_path}" # é‡æ–°åŠ è½½ bind r source-file ~/.tmux.conf \\; display "Reloaded!" EOF # æ’ä»¶ç®¡ç†å™¨ git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm # å¸¸ç”¨æ“ä½œ tmux new -s ops # æ–°å»ºä¼šè¯ tmux attach -t ops # è¿æ¥ tmux ls # åˆ—å‡º Ctrl+A d # åˆ†ç¦» Ctrl+A c # æ–°çª—å£ Ctrl+A % # å‚ç›´åˆ†å± Ctrl+A " # æ°´å¹³åˆ†å± 8.2 fzf æ¨¡ç³ŠæŸ¥æ‰¾ 1 2 3 4 5 6 7 # å®‰è£… git clone --depth 1 https://github.com/junegunn/fzf.git ~/.fzf ~/.fzf/install # ä½¿ç”¨ç¤ºä¾‹ history | fzf find . -type f | fzf 8.3 autojump ç›®å½•è·³è½¬ 1 2 3 yum install -y autojump # CentOS (EPEL) apt install -y autojump # Ubuntu # ä½¿ç”¨: j myproject # è‡ªåŠ¨åŒ¹é…è·³è½¬ ä¹ã€äº‘åŸç”Ÿå·¥å…·é›† 9.1 Docker å…¨å®¶æ¡¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 # å®‰è£… curl -fsSL https://get.docker.com | bash # é…ç½®é•œåƒåŠ é€Ÿ cat > /etc/docker/daemon.json << EOF { "registry-mirrors": ["https://mirror.gcr.io"], "log-driver": "json-file", "log-opts": { "max-size": "100m", "max-file": "3" } } EOF # å¸¸ç”¨å·¥å…· docker stats # å®¹å™¨èµ„æº docker system df # ç£ç›˜ä½¿ç”¨ docker exec -it container_id bash # dive é•œåƒåˆ†æ curl -L https://github.com/wagoodman/dive/releases/download/v0.9.2/dive_0.9.2_linux_amd64.rpm -o dive.rpm && yum install -y dive # Ubuntuç”¨ https://github.com/wagoodman/dive/releases/download/v0.9.2/dive_0.9.2_linux_amd64.deb dive nginx:latest 9.2 Kubernetes å·¥å…· 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 # kubectl curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl" chmod +x kubectl && mv kubectl /usr/local/bin/ # k9s ç»ˆç«¯UI curl -sS https://webinstall.dev/k9s | bash # kubectx/kubens curl -L https://raw.githubusercontent.com/ahmetb/kubectx/master/kubectx -o /usr/local/bin/kubectx curl -L https://raw.githubusercontent.com/ahmetb/kubectx/master/kubens -o /usr/local/bin/kubens chmod +x /usr/local/bin/kubectx /usr/local/bin/kubens # Helm curl https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3 | bash # åˆ«å alias k=&#39;kubectl&#39; alias kg=&#39;kubectl get&#39; alias kd=&#39;kubectl describe&#39; alias ke=&#39;kubectl exec -it&#39; alias klog=&#39;kubectl logs -f&#39; åã€ä¸€é”®å®‰è£…è„šæœ¬ 10.1 CentOS è¿ç»´å…¨å®¶æ¡¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 cat > install_ops_tools_centos.sh << &#39;EOF&#39; #!/bin/bash set -e echo ">>> å®‰è£…EPELæº" yum install -y epel-release echo ">>> å®‰è£…åŸºç¡€å·¥å…·" yum install -y vim htop iotop iftop nethogs glances git telnet net-tools bind-utils traceroute mtr nc tcpdump nmap lsof strace ltrace sysstat dstat bash-completion chrony unzip zip psmisc screen tmux expect pv jq python3-pip ncdu tree smartmontools ipmitool dmidecode echo ">>> å®‰è£…ç½‘ç»œå·¥å…·" yum install -y nethogs iftop mtr nmap tcpdump echo ">>> å®‰è£…ç›‘æ§å·¥å…·" yum install -y htop iotop glances dstat echo ">>> å®‰è£…æ—¥å¿—å·¥å…·" yum install -y lnav multitail echo ">>> å®‰è£…Docker" curl -fsSL https://get.docker.com | bash systemctl enable --now docker echo ">>> å®‰è£…Pythonå·¥å…·" pip3 install --user mycli pgcli ansible yq thefuck echo ">>> å®‰è£…Tmuxæ’ä»¶ç®¡ç†å™¨" git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm echo ">>> å®‰è£…Vimæ’ä»¶ç®¡ç†å™¨" curl -fLo ~/.vim/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim echo ">>> å®‰è£…fzf" git clone --depth 1 https://github.com/junegunn/fzf.git ~/.fzf ~/.fzf/install echo ">>> å®‰è£…neofetch" yum install -y neofetch echo "å®Œæˆï¼è¯·æ‰‹åŠ¨è¿è¡Œ vim +PlugInstall å’Œ tmuxæ’ä»¶å®‰è£…(Ctrl+A I)" EOF chmod +x install_ops_tools_centos.sh 10.2 Ubuntu è¿ç»´å…¨å®¶æ¡¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 cat > install_ops_tools_ubuntu.sh << &#39;EOF&#39; #!/bin/bash set -e echo ">>> æ›´æ–°æº" apt update echo ">>> å®‰è£…åŸºç¡€å·¥å…·" apt install -y vim htop iotop iftop nethogs glances git telnet net-tools dnsutils traceroute mtr netcat-openbsd tcpdump nmap lsof strace ltrace sysstat dstat bash-completion chrony unzip zip psmisc screen tmux expect pv jq python3-pip ncdu tree smartmontools ipmitool dmidecode echo ">>> å®‰è£…ç½‘ç»œå·¥å…·" apt install -y nethogs iftop mtr nmap tcpdump echo ">>> å®‰è£…ç›‘æ§å·¥å…·" apt install -y htop iotop glances dstat echo ">>> å®‰è£…æ—¥å¿—å·¥å…·" apt install -y lnav multitail echo ">>> å®‰è£…Docker" curl -fsSL https://get.docker.com | bash systemctl enable --now docker echo ">>> å®‰è£…Pythonå·¥å…·" pip3 install --user mycli pgcli ansible yq thefuck echo ">>> å®‰è£…Tmuxæ’ä»¶ç®¡ç†å™¨" git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm echo ">>> å®‰è£…Vimæ’ä»¶ç®¡ç†å™¨" curl -fLo ~/.vim/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim echo ">>> å®‰è£…fzf" git clone --depth 1 https://github.com/junegunn/fzf.git ~/.fzf ~/.fzf/install echo ">>> å®‰è£…neofetch" apt install -y neofetch echo "å®Œæˆï¼è¯·æ‰‹åŠ¨è¿è¡Œ vim +PlugInstall å’Œ tmuxæ’ä»¶å®‰è£…(Ctrl+A I)" EOF chmod +x install_ops_tools_ubuntu.sh åä¸€ã€è¿ç»´åˆ«ååº“ï¼ˆ~/.bashrcï¼‰ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 cat >> ~/.bashrc << &#39;EOF&#39; # ==================== è¿ç»´åˆ«ååº“ ==================== # ç³»ç»Ÿä¿¡æ¯ alias sysinfo=&#39;echo "--- CPU ---"; lscpu | grep "Model name"; echo "--- Memory ---"; free -h; echo "--- Disk ---"; df -hT | grep -v tmpfs; echo "--- Network ---"; ip a | grep "inet "; echo "--- Load ---"; uptime&#39; alias ports=&#39;ss -tuln | grep LISTEN&#39; alias bigfiles=&#39;find / -type f -size +100M -exec ls -lh {} \\; 2>/dev/null | head -20&#39; alias iplist=&#39;ip a | grep "inet " | awk \\&#39;{print $2}\\&#39;&#39; # åŒ…ç®¡ç† alias yup=&#39;yum update -y&#39; alias yin=&#39;yum install -y&#39; alias yrm=&#39;yum remove -y&#39; alias ysearch=&#39;yum search&#39; alias aup=&#39;apt update && apt upgrade -y&#39; alias ain=&#39;apt install -y&#39; alias arm=&#39;apt remove -y&#39; alias asearch=&#39;apt search&#39; # Docker alias dps=&#39;docker ps --format "table {{.ID}}\\t{{.Names}}\\t{{.Status}}\\t{{.Ports}}"&#39; alias dsa=&#39;docker stop $(docker ps -aq)&#39; alias drma=&#39;docker rm $(docker ps -aq)&#39; alias dcl=&#39;docker system prune -a&#39; # K8s alias k=&#39;kubectl&#39; alias kg=&#39;kubectl get&#39; alias kd=&#39;kubectl describe&#39; alias ke=&#39;kubectl exec -it&#39; alias klog=&#39;kubectl logs -f&#39; alias kdel=&#39;kubectl delete&#39; # æ—¥å¿— alias tailf=&#39;tail -f&#39; alias grepall=&#39;grep -r --include="*.log" --include="*.txt"&#39; alias journalerr=&#39;journalctl -p err -f&#39; alias journalboot=&#39;journalctl -b&#39; # ç½‘ç»œ alias nettest=&#39;ping 114.114.114.114 -c 3 && ping 8.8.8.8 -c 3 && ping baidu.com -c 3&#39; alias ports80=&#39;ss -ant | grep :80 | wc -l&#39; alias ports443=&#39;ss -ant | grep :443 | wc -l&#39; # å®‰å…¨ alias ssh20=&#39;ssh -o ServerAliveInterval=60 -o TCPKeepAlive=yes&#39; alias sshproxy=&#39;ssh -D 1080 -C -N&#39; # é¢œè‰² alias ls=&#39;ls --color=auto&#39; alias ll=&#39;ls -lhF&#39; alias grep=&#39;grep --color=auto&#39; alias ip=&#39;ip -c&#39; # Ubuntu # å†å²è®°å½•å¢å¼º export HISTTIMEFORMAT="%Y-%m-%d %H:%M:%S " export HISTSIZE=10000 export HISTFILESIZE=10000 shopt -s histappend export PROMPT_COMMAND="history -a; history -c; history -r; $PROMPT_COMMAND" # è·¯å¾„ export PATH=$PATH:/usr/local/bin:/usr/local/sbin:$HOME/.local/bin # å®‰å…¨åˆ é™¤ alias rm=&#39;rm -i&#39; alias cp=&#39;cp -i&#39; alias mv=&#39;mv -i&#39; # è§£å‹ä¸‡èƒ½å‡½æ•° extract() { if [ -f $1 ]; then case $1 in *.tar.bz2) tar xjf $1 ;; *.tar.gz) tar xzf $1 ;; *.bz2) bunzip2 $1 ;; *.rar) unrar x $1 ;; *.gz) gunzip $1 ;; *.tar) tar xf $1 ;; *.tbz2) tar xjf $1 ;; *.tgz) tar xzf $1 ;; *.zip) unzip $1 ;; *.Z) uncompress $1 ;; *.7z) 7z x $1 ;; *) echo "&#39;$1&#39; cannot be extracted via extract()" ;; esac else echo "&#39;$1&#39; is not a valid file" fi } # å¿«é€ŸSSH keyåˆ†å‘ ssh-copy-id() { if [ -z "$1" ]; then echo "Usage: ssh-copy-id user@host" return 1 fi cat ~/.ssh/id_rsa.pub | ssh $1 "mkdir -p ~/.ssh && chmod 700 ~/.ssh && cat >> ~/.ssh/authorized_keys && chmod 600 ~/.ssh/authorized_keys" } # å¤‡ä»½é…ç½® backup_cfg() { local dest="/tmp/config_backup_$(date +%Y%m%d_%H%M%S).tar.gz" tar -czf $dest /etc/nginx /etc/httpd /etc/mysql /etc/redis /etc/sysconfig 2>/dev/null echo "é…ç½®å·²å¤‡ä»½åˆ°: $dest" } # åŠ è½½é…ç½® source ~/.bashrc EOF åäºŒã€åº”æ€¥å“åº”æ‰‹å†Œ 12.1 ç³»ç»Ÿè¢«å…¥ä¾µåº”æ€¥ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 #!/bin/bash # incident_response.sh echo ">>> 1. éš”ç¦»ç½‘ç»œï¼ˆå¦‚å¿…è¦ï¼‰" # iptables -A OUTPUT -j DROP echo ">>> 2. ä¿å­˜ç°åœº" mkdir -p /tmp/incident_$(date +%Y%m%d) cd /tmp/incident_$(date +%Y%m%d) # ä¿å­˜è¿›ç¨‹ä¿¡æ¯ ps aux > ps.aux.txt lsof > lsof.txt # ä¿å­˜ç½‘ç»œè¿æ¥ ss -antp > ss.antp.txt netstat -tulpn > netstat.tulpn.txt # ä¿å­˜ç”¨æˆ·ä¿¡æ¯ cat /etc/passwd > passwd.txt cat /etc/shadow > shadow.txt last > last.txt # ä¿å­˜æ—¥å¿— cp /var/log/secure . 2>/dev/null cp /var/log/auth.log . 2>/dev/null cp /var/log/nginx/access.log . 2>/dev/null echo ">>> 3. æŸ¥æ‰¾å¯ç–‘æ–‡ä»¶" find /tmp /var/tmp -type f -executable -exec ls -lh {} \\; > suspicious_files.txt echo ">>> 4. æŸ¥æ‰¾å¯ç–‘è¿›ç¨‹" ps aux | awk &#39;$3 > 50 {print $0}&#39; > high_cpu.txt ps aux | awk &#39;$4 > 10 {print $0}&#39; > high_mem.txt echo ">>> 5. æŸ¥æ‰¾å¯ç–‘è¿æ¥" ss -antp | grep -v &#39;127.0.0.1&#39; > suspicious_conn.txt echo ">>> æ•°æ®å·²ä¿å­˜åˆ°: /tmp/incident_$(date +%Y%m%d)" 12.2 DDoSæ”»å‡»åº”å¯¹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # æŸ¥çœ‹SYNæ´ªæ°´ netstat -n | awk &#39;/^tcp/ {++state[$6]} END {for(key in state) print key,state[key]}&#39; # é™åˆ¶SYN iptables -A INPUT -p tcp --syn -m limit --limit 1/s -j ACCEPT iptables -A INPUT -p tcp --syn -j DROP # å°ç¦IPï¼ˆä½¿ç”¨firewalldï¼‰ firewall-cmd --permanent --add-rich-rule=&#39;rule source address="192.168.1.100" reject&#39; firewall-cmd --reload # å°ç¦IPï¼ˆä½¿ç”¨ufwï¼‰ ufw deny from 192.168.1.100 # CloudFlareæ¨¡å¼ï¼ˆè·å–çœŸå®IPï¼‰ # åœ¨nginxä¸­é…ç½®: set_real_ip_from 103.21.244.0/22; åä¸‰ã€æ—¥å¸¸å·¡æ£€è„šæœ¬ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 cat > daily_check.sh << &#39;EOF&#39; #!/bin/bash REPORT="/tmp/daily_report_$(hostname)_$(date +%Y%m%d).txt" echo "===== ä¸»æœº: $(hostname) | æ—¶é—´: $(date) =====" > $REPORT echo "" >> $REPORT echo "--- CPUè´Ÿè½½ ---" >> $REPORT uptime >> $REPORT echo "" >> $REPORT echo "--- å†…å­˜ä½¿ç”¨ ---" >> $REPORT free -h >> $REPORT echo "" >> $REPORT echo "--- ç£ç›˜ä½¿ç”¨ ---" >> $REPORT df -hT >> $REPORT echo "" >> $REPORT echo "--- ç£ç›˜IO ---" >> $REPORT iostat -x 1 5 >> $REPORT echo "" >> $REPORT echo "--- ç½‘ç»œè¿æ¥ ---" >> $REPORT ss -ant | grep ESTAB | wc -l >> $REPORT echo "" >> $REPORT echo "--- ç›‘å¬ç«¯å£ ---" >> $REPORT ss -tuln | grep LISTEN >> $REPORT echo "" >> $REPORT echo "--- ç™»å½•å¤±è´¥ ---" >> $REPORT grep "Failed password" /var/log/secure 2>/dev/null | tail -20 >> $REPORT grep "Failed password" /var/log/auth.log 2>/dev/null | tail -20 >> $REPORT echo "" >> $REPORT echo "--- åƒµå°¸è¿›ç¨‹ ---" >> $REPORT ps aux | awk &#39;$8~/Z/ {print $0}&#39; >> $REPORT echo "" >> $REPORT echo "--- æœåŠ¡çŠ¶æ€ ---" >> $REPORT systemctl list-units --state=failed --no-pager >> $REPORT echo "" >> $REPORT echo "--- æœ€è¿‘å˜æ›´ ---" >> $REPORT find /etc /usr/local/bin -type f -mtime -1 2>/dev/null | head -20 >> $REPORT mail -s "Daily Check Report: $(hostname)" ops@company.com < $REPORT echo "æŠ¥å‘Šå·²å‘é€åˆ°é‚®ç®±" EOF chmod +x daily_check.sh # åŠ å…¥crontab: 0 8 * * * /path/to/daily_check.sh ğŸ¯ ä½¿ç”¨å»ºè®® æ–°æœåŠ¡å™¨åˆå§‹åŒ–ï¼šè¿è¡Œå¯¹åº”ç³»ç»Ÿçš„ä¸€é”®å®‰è£…è„šæœ¬ ä¸ªäººç¯å¢ƒé…ç½®ï¼šå¤åˆ¶æ‰€æœ‰é…ç½®æ–‡ä»¶ï¼ˆ.vimrc, .bashrc, .tmux.confï¼‰ æ—¥å¸¸å·¡æ£€ï¼šéƒ¨ç½²daily_check.shåˆ°æ‰€æœ‰æœåŠ¡å™¨ åº”æ€¥å“åº”ï¼šå‡†å¤‡å¥½incident_response.shï¼Œéšæ—¶å¯ç”¨ æŒç»­å­¦ä¹ ï¼šæ¯å‘¨å°è¯•ä¸€ä¸ªæ–°å·¥å…·ï¼Œé€æ­¥æ›¿æ¢ä½æ•ˆæ“ä½œ å®Œæ•´é…ç½®å·²å°±ç»ªï¼Œç›´æ¥å¤åˆ¶ä½¿ç”¨å³å¯ï¼ç¥è¿ç»´å·¥ä½œé¡ºåˆ©ï¼\n'><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='http://localhost:1313/'><link rel=stylesheet href=/css/custom.css><link rel="shortcut icon" href=/favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"light")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/images/avatar_hu_89ca753ea8ea85c7.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>âœï¸</span></figure><div class=site-meta><h1 class=site-name><a href=/>JustWin</a></h1><h2 class=site-description>åˆ†äº«æŠ€æœ¯ä¸ç”Ÿæ´»</h2></div></header><ol class=menu-social><li><a href=https://github.com/passion-win target=_blank title=GitHub rel=me><svg width="800" height="800" viewBox="0 0 20 20" xmlns:xlink="http://www.w3.org/1999/xlink"><title>github [#142]</title><desc>Created with Sketch.</desc><defs/><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Dribbble-Light-Preview" transform="translate(-140.000000, -7559.000000)" fill="#000"><g id="icons" transform="translate(56.000000, 160.000000)"><path d="M94 7399C99.523 7399 104 7403.59 104 7409.253 104 7413.782 101.138 7417.624 97.167 7418.981 96.66 7419.082 96.48 7418.762 96.48 7418.489 96.48 7418.151 96.492 7417.047 96.492 7415.675 96.492 7414.719 96.172 7414.095 95.813 7413.777 98.04 7413.523 100.38 7412.656 100.38 7408.718 100.38 7407.598 99.992 7406.684 99.35 7405.966 99.454 7405.707 99.797 7404.664 99.252 7403.252 99.252 7403.252 98.414 7402.977 96.505 7404.303 95.706 7404.076 94.85 7403.962 94 7403.958 93.15 7403.962 92.295 7404.076 91.497 7404.303 89.586 7402.977 88.746 7403.252 88.746 7403.252 88.203 7404.664 88.546 7405.707 88.649 7405.966 88.01 7406.684 87.619 7407.598 87.619 7408.718 87.619 7412.646 89.954 7413.526 92.175 7413.785 91.889 7414.041 91.63 7414.493 91.54 7415.156 90.97 7415.418 89.522 7415.871 88.63 7414.304 88.63 7414.304 88.101 7413.319 87.097 7413.247 87.097 7413.247 86.122 7413.234 87.029 7413.87 87.029 7413.87 87.684 7414.185 88.139 7415.37 88.139 7415.37 88.726 7417.2 91.508 7416.58 91.513 7417.437 91.522 7418.245 91.522 7418.489 91.522 7418.76 91.338 7419.077 90.839 7418.982 86.865 7417.627 84 7413.783 84 7409.253 84 7403.59 88.478 7399 94 7399" id="github-[#142]"/></g></g></g></svg></a></li><li><a href=https://t.me/+TFjBeZzowwU1YTY1 target=_blank title=telegram rel=me><svg viewBox="0 0 640 640"><path d="M320 72C183 72 72 183 72 320S183 568 320 568 568 457 568 320 457 72 320 72zM435 240.7C431.3 279.9 415.1 375.1 406.9 419c-3.5 18.6-10.3 24.8-16.9 25.4C375.6 445.7 364.7 434.9 350.7 425.7c-21.8-14.3-34.2-23.2-55.3-37.2C270.9 372.4 286.8 363.5 300.7 349 304.4 345.2 367.8 287.5 369 282.3 369.2 281.6 369.3 279.2 367.8 277.9 366.3 276.6 364.2 277.1 362.7 277.4 360.5 277.9 325.6 300.9 258.1 346.5 248.2 353.3 239.2 356.6 231.2 356.4 222.3 356.2 205.3 351.4 192.6 347.3 177.1 342.3 164.7 339.6 165.8 331 166.4 326.5 172.5 322 184.2 317.3 256.5 285.8 304.7 265 328.8 255c68.9-28.6 83.2-33.6 92.5-33.8C423.4 221.2 427.9 221.7 430.9 224.1 432.9 225.8 434.1 228.2 434.4 230.8 434.9 234 435 237.3 434.8 240.6z"/></svg></a></li><li><a href=https://twitter.com/@win1688888888 target=_blank title=twitter rel=me><svg width="800" height="800" viewBox="0 -2 20 20" xmlns:xlink="http://www.w3.org/1999/xlink"><title>twitter [#154]</title><desc>Created with Sketch.</desc><defs/><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Dribbble-Light-Preview" transform="translate(-60.000000, -7521.000000)" fill="#000"><g id="icons" transform="translate(56.000000, 160.000000)"><path d="M10.29 7377C17.837 7377 21.965 7370.84365 21.965 7365.50546 21.965 7365.33021 21.965 7365.15595 21.953 7364.98267 22.756 7364.41163 23.449 7363.70276 24 7362.8915 23.252 7363.21837 22.457 7363.433 21.644 7363.52751 22.5 7363.02244 23.141 7362.2289 23.448 7361.2926 22.642 7361.76321 21.761 7362.095 20.842 7362.27321 19.288 7360.64674 16.689 7360.56798 15.036 7362.09796 13.971 7363.08447 13.518 7364.55538 13.849 7365.95835 10.55 7365.79492 7.476 7364.261 5.392 7361.73762 4.303 7363.58363 4.86 7365.94457 6.663 7367.12996 6.01 7367.11125 5.371 7366.93797 4.8 7366.62489V7366.67608C4.801 7368.5989 6.178 7370.2549 8.092 7370.63591 7.488 7370.79836 6.854 7370.82199 6.24 7370.70483 6.777 7372.35099 8.318 7373.47829 10.073 7373.51078 8.62 7374.63513 6.825 7375.24554 4.977 7375.24358 4.651 7375.24259 4.325 7375.22388 4 7375.18549 5.877 7376.37088 8.06 7377 10.29 7376.99705" id="twitter-[#154]"/></g></g></g></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><span>é¦–é¡µ</span></a></li><li><a href=/archives/><span>å½’æ¡£</span></a></li><li><a href=/about/><span>å…³äº</span></a></li><li><a href=/links/><span>ç½‘ç«™åˆ†äº«</span></a></li><li><a href=/blockchain/><span>å¾…å®š</span></a></li><li><a href><span></span></a></li><li class=menu-bottom-section><ol class=menu><li id=i18n-switch><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language title=language onchange="window.location.href=this.selectedOptions[0].value"><option value=http://localhost:1313/ selected>ä¸­æ–‡</option><option value=http://localhost:1313/en/>English</option></select></li><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#ä¸€ç³»ç»Ÿæ ¸å¿ƒå‘½ä»¤>ä¸€ã€ç³»ç»Ÿæ ¸å¿ƒå‘½ä»¤</a><ol><li><a href=#11-ç³»ç»Ÿä¿¡æ¯ä¾¦æŸ¥>1.1 ç³»ç»Ÿä¿¡æ¯ä¾¦æŸ¥</a></li><li><a href=#12-lvmé€»è¾‘å·ç®¡ç†å®Œæ•´æµç¨‹>1.2 LVMé€»è¾‘å·ç®¡ç†ï¼ˆå®Œæ•´æµç¨‹ï¼‰</a></li></ol></li><li><a href=#äºŒæ–‡ä»¶ä¸ç£ç›˜ç®¡ç†>äºŒã€æ–‡ä»¶ä¸ç£ç›˜ç®¡ç†</a><ol><li><a href=#21-ç£ç›˜ç®¡ç†>2.1 ç£ç›˜ç®¡ç†</a></li><li><a href=#22-æ–‡ä»¶ä¼ è¾“>2.2 æ–‡ä»¶ä¼ è¾“</a></li></ol></li><li><a href=#ä¸‰ç½‘ç»œè¯Šæ–­å·¥å…·>ä¸‰ã€ç½‘ç»œè¯Šæ–­å·¥å…·</a><ol><li><a href=#31-åŸºç¡€ç½‘ç»œ>3.1 åŸºç¡€ç½‘ç»œ</a></li><li><a href=#32-æŠ“åŒ…åˆ†æ>3.2 æŠ“åŒ…åˆ†æ</a></li><li><a href=#33-ç«¯å£æ‰«æ>3.3 ç«¯å£æ‰«æ</a></li></ol></li><li><a href=#å››ç›‘æ§ä¸æ€§èƒ½åˆ†æ>å››ã€ç›‘æ§ä¸æ€§èƒ½åˆ†æ</a><ol><li><a href=#41-å®æ—¶ç›‘æ§>4.1 å®æ—¶ç›‘æ§</a></li><li><a href=#42-æ€§èƒ½åˆ†æ>4.2 æ€§èƒ½åˆ†æ</a></li><li><a href=#43-å†å²æ•°æ®>4.3 å†å²æ•°æ®</a></li></ol></li><li><a href=#äº”æ–‡æœ¬ç¼–è¾‘å™¨é…ç½®>äº”ã€æ–‡æœ¬ç¼–è¾‘å™¨é…ç½®</a><ol><li><a href=#51-vim-è¿ç»´ç»ˆæé…ç½®>5.1 Vim è¿ç»´ç»ˆæé…ç½®</a></li><li><a href=#52-nano-åŸºç¡€é…ç½®>5.2 Nano åŸºç¡€é…ç½®</a></li></ol></li><li><a href=#å…­å®‰å…¨å®¡è®¡å·¥å…·>å…­ã€å®‰å…¨å®¡è®¡å·¥å…·</a><ol><li><a href=#61-ç³»ç»Ÿå®‰å…¨æ‰«æ>6.1 ç³»ç»Ÿå®‰å…¨æ‰«æ</a></li><li><a href=#62-å…¥ä¾µæ£€æµ‹>6.2 å…¥ä¾µæ£€æµ‹</a></li><li><a href=#63-æƒé™æ£€æŸ¥>6.3 æƒé™æ£€æŸ¥</a></li></ol></li><li><a href=#ä¸ƒè‡ªåŠ¨åŒ–è¿ç»´å¹³å°>ä¸ƒã€è‡ªåŠ¨åŒ–è¿ç»´å¹³å°</a><ol><li><a href=#71-ansible-å¿«é€Ÿéƒ¨ç½²>7.1 Ansible å¿«é€Ÿéƒ¨ç½²</a></li><li><a href=#72-saltstack>7.2 SaltStack</a></li></ol></li><li><a href=#å…«ç»ˆç«¯æ•ˆç‡å·¥å…·>å…«ã€ç»ˆç«¯æ•ˆç‡å·¥å…·</a><ol><li><a href=#81-tmux-ç»ˆæé…ç½®>8.1 tmux ç»ˆæé…ç½®</a></li><li><a href=#82-fzf-æ¨¡ç³ŠæŸ¥æ‰¾>8.2 fzf æ¨¡ç³ŠæŸ¥æ‰¾</a></li><li><a href=#83-autojump-ç›®å½•è·³è½¬>8.3 autojump ç›®å½•è·³è½¬</a></li></ol></li><li><a href=#ä¹äº‘åŸç”Ÿå·¥å…·é›†>ä¹ã€äº‘åŸç”Ÿå·¥å…·é›†</a><ol><li><a href=#91-docker-å…¨å®¶æ¡¶>9.1 Docker å…¨å®¶æ¡¶</a></li><li><a href=#92-kubernetes-å·¥å…·>9.2 Kubernetes å·¥å…·</a></li></ol></li><li><a href=#åä¸€é”®å®‰è£…è„šæœ¬>åã€ä¸€é”®å®‰è£…è„šæœ¬</a><ol><li><a href=#101-centos-è¿ç»´å…¨å®¶æ¡¶>10.1 CentOS è¿ç»´å…¨å®¶æ¡¶</a></li><li><a href=#102-ubuntu-è¿ç»´å…¨å®¶æ¡¶>10.2 Ubuntu è¿ç»´å…¨å®¶æ¡¶</a></li></ol></li><li><a href=#åä¸€è¿ç»´åˆ«ååº“bashrc>åä¸€ã€è¿ç»´åˆ«ååº“ï¼ˆ~/.bashrcï¼‰</a></li><li><a href=#åäºŒåº”æ€¥å“åº”æ‰‹å†Œ>åäºŒã€åº”æ€¥å“åº”æ‰‹å†Œ</a><ol><li><a href=#121-ç³»ç»Ÿè¢«å…¥ä¾µåº”æ€¥>12.1 ç³»ç»Ÿè¢«å…¥ä¾µåº”æ€¥</a></li><li><a href=#122-ddosæ”»å‡»åº”å¯¹>12.2 DDoSæ”»å‡»åº”å¯¹</a></li></ol></li><li><a href=#åä¸‰æ—¥å¸¸å·¡æ£€è„šæœ¬>åä¸‰ã€æ—¥å¸¸å·¡æ£€è„šæœ¬</a></li><li><a href=#-ä½¿ç”¨å»ºè®®>ğŸ¯ ä½¿ç”¨å»ºè®®</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category></header><div class=article-title-wrapper><h2 class=article-title><a href=/posts/linux%E5%B7%A5%E5%85%B7/>Linuxå·¥å…·</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2025-11-09</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 10 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><h1 id=centosubuntuå·¥å…·>CentOS/Ubuntuå·¥å…·</h1><h2 id=ä¸€ç³»ç»Ÿæ ¸å¿ƒå‘½ä»¤>ä¸€ã€ç³»ç»Ÿæ ¸å¿ƒå‘½ä»¤</h2><h3 id=11-ç³»ç»Ÿä¿¡æ¯ä¾¦æŸ¥>1.1 ç³»ç»Ÿä¿¡æ¯ä¾¦æŸ¥</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ç»¼åˆä¿¡æ¯ï¼ˆæ¨èï¼‰</span>
</span></span><span class=line><span class=cl>hostnamectl                      <span class=c1># CentOS 7+/Ubuntu 16.04+</span>
</span></span><span class=line><span class=cl>cat /etc/os-release              <span class=c1># æ‰€æœ‰å‘è¡Œç‰ˆæ ‡å‡†</span>
</span></span><span class=line><span class=cl>lscpu <span class=p>|</span> grep <span class=s2>&#34;Model name&#34;</span>        <span class=c1># CPUå‹å·</span>
</span></span><span class=line><span class=cl>free -h                          <span class=c1># å†…å­˜</span>
</span></span><span class=line><span class=cl>df -hT                           <span class=c1># ç£ç›˜</span>
</span></span><span class=line><span class=cl>uptime                           <span class=c1># è´Ÿè½½</span>
</span></span><span class=line><span class=cl>dmesg <span class=p>|</span> tail -50                 <span class=c1># å†…æ ¸æ—¥å¿—</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¿«é€Ÿè¯Šæ–­</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>sysinfo</span><span class=o>=</span><span class=s1>&#39;echo &#34;--- CPU ---&#34;; lscpu | grep &#34;Model name&#34;; echo &#34;--- Memory ---&#34;; free -h; echo &#34;--- Disk ---&#34;; df -hT | grep -v tmpfs; echo &#34;--- Network ---&#34;; ip a | grep &#34;inet &#34;; echo &#34;--- Load ---&#34;; uptime&#39;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=12-lvmé€»è¾‘å·ç®¡ç†å®Œæ•´æµç¨‹>1.2 LVMé€»è¾‘å·ç®¡ç†ï¼ˆå®Œæ•´æµç¨‹ï¼‰</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 1. åˆ›å»ºPV</span>
</span></span><span class=line><span class=cl>pvcreate /dev/sdb /dev/sdc
</span></span><span class=line><span class=cl>pvs
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. åˆ›å»ºVG</span>
</span></span><span class=line><span class=cl>vgcreate vg_data /dev/sdb /dev/sdc
</span></span><span class=line><span class=cl>vgs
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. åˆ›å»ºLV</span>
</span></span><span class=line><span class=cl>lvcreate -L 50G -n lv_app vg_data
</span></span><span class=line><span class=cl>lvcreate -l 100%FREE -n lv_backup vg_data
</span></span><span class=line><span class=cl>lvs
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 4. æ ¼å¼åŒ–</span>
</span></span><span class=line><span class=cl>mkfs.xfs /dev/vg_data/lv_app      <span class=c1># CentOSæ¨è</span>
</span></span><span class=line><span class=cl>mkfs.ext4 /dev/vg_data/lv_backup  <span class=c1># Ubuntuæ¨è</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 5. æŒ‚è½½</span>
</span></span><span class=line><span class=cl>mkdir /app /backup
</span></span><span class=line><span class=cl>mount /dev/vg_data/lv_app /app
</span></span><span class=line><span class=cl>mount /dev/vg_data/lv_backup /backup
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 6. æ‰©å®¹ï¼ˆåœ¨çº¿ï¼‰</span>
</span></span><span class=line><span class=cl>lvextend -L +20G /dev/vg_data/lv_app
</span></span><span class=line><span class=cl>xfs_growfs /app                   <span class=c1># XFSæ ¼å¼</span>
</span></span><span class=line><span class=cl><span class=c1># æˆ– resize2fs /dev/vg_data/lv_app  # ext4æ ¼å¼</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=äºŒæ–‡ä»¶ä¸ç£ç›˜ç®¡ç†>äºŒã€æ–‡ä»¶ä¸ç£ç›˜ç®¡ç†</h2><h3 id=21-ç£ç›˜ç®¡ç†>2.1 ç£ç›˜ç®¡ç†</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># æŸ¥çœ‹å¤§æ–‡ä»¶</span>
</span></span><span class=line><span class=cl>du -ah --max-depth<span class=o>=</span><span class=m>2</span> /var <span class=p>|</span> sort -rh <span class=p>|</span> head -20
</span></span><span class=line><span class=cl>find / -type f -size +100M -exec ls -lh <span class=o>{}</span> <span class=se>\;</span> 2&gt;/dev/null <span class=p>|</span> head
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ£€æŸ¥inode</span>
</span></span><span class=line><span class=cl>df -i
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ç£ç›˜å¥åº·</span>
</span></span><span class=line><span class=cl>smartctl -a /dev/sda
</span></span><span class=line><span class=cl>yum install -y smartmontools     <span class=c1># CentOS</span>
</span></span><span class=line><span class=cl>apt install -y smartmontools     <span class=c1># Ubuntu</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ç£ç›˜æ¸…ç†</span>
</span></span><span class=line><span class=cl>ncdu /                           <span class=c1># äº¤äº’å¼ç£ç›˜åˆ†æ</span>
</span></span><span class=line><span class=cl>yum install -y ncdu              <span class=c1># CentOS</span>
</span></span><span class=line><span class=cl>apt install -y ncdu              <span class=c1># Ubuntu</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä¸´æ—¶æ–‡ä»¶æ¸…ç†</span>
</span></span><span class=line><span class=cl>find /tmp -type f -atime +7 -delete  <span class=c1># åˆ é™¤7å¤©æœªè®¿é—®æ–‡ä»¶</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=22-æ–‡ä»¶ä¼ è¾“>2.2 æ–‡ä»¶ä¼ è¾“</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># lrzszï¼ˆXshell/SecureCRTå¿…å¤‡ï¼‰</span>
</span></span><span class=line><span class=cl>yum install -y lrzsz            <span class=c1># CentOS</span>
</span></span><span class=line><span class=cl>apt install -y lrzsz            <span class=c1># Ubuntu</span>
</span></span><span class=line><span class=cl>rz -y                           <span class=c1># ä¸Šä¼ </span>
</span></span><span class=line><span class=cl>sz filename                     <span class=c1># ä¸‹è½½</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># rsyncé«˜çº§ç”¨æ³•</span>
</span></span><span class=line><span class=cl>rsync -avz --progress --partial --bwlimit<span class=o>=</span><span class=m>10000</span> /src/ user@remote:/dst/  <span class=c1># é™é€Ÿ10MB/s</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ–­ç‚¹ç»­ä¼ </span>
</span></span><span class=line><span class=cl>rsync --partial --progress large_file.iso user@remote:/tmp/
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=ä¸‰ç½‘ç»œè¯Šæ–­å·¥å…·>ä¸‰ã€ç½‘ç»œè¯Šæ–­å·¥å…·</h2><h3 id=31-åŸºç¡€ç½‘ç»œ>3.1 åŸºç¡€ç½‘ç»œ</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># æŸ¥çœ‹è¿æ¥</span>
</span></span><span class=line><span class=cl>ss -antp <span class=p>|</span> grep ESTAB            <span class=c1># å·²å»ºç«‹è¿æ¥</span>
</span></span><span class=line><span class=cl>ss -s                            <span class=c1># è¿æ¥ç»Ÿè®¡</span>
</span></span><span class=line><span class=cl>lsof -i :8080                    <span class=c1># ç«¯å£å ç”¨è¿›ç¨‹</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># è·¯ç”±è¿½è¸ª</span>
</span></span><span class=line><span class=cl>mtr -r -c <span class=m>10</span> baidu.com          <span class=c1># 10æ¬¡æŠ¥å‘Šæ¨¡å¼</span>
</span></span><span class=line><span class=cl>yum install -y mtr                <span class=c1># CentOS</span>
</span></span><span class=line><span class=cl>apt install -y mtr-tiny           <span class=c1># Ubuntu</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¸¦å®½æµ‹è¯•</span>
</span></span><span class=line><span class=cl>iperf3 -s                        <span class=c1># æœåŠ¡ç«¯</span>
</span></span><span class=line><span class=cl>iperf3 -c server_ip -P <span class=m>8</span>         <span class=c1># å®¢æˆ·ç«¯8çº¿ç¨‹</span>
</span></span><span class=line><span class=cl>yum install -y iperf3             <span class=c1># CentOS (EPEL)</span>
</span></span><span class=line><span class=cl>apt install -y iperf3             <span class=c1># Ubuntu</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=32-æŠ“åŒ…åˆ†æ>3.2 æŠ“åŒ…åˆ†æ</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># tcpdumpç²¾ç¡®è¿‡æ»¤</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 -w capture.pcap port <span class=m>80</span> and host 192.168.1.100
</span></span><span class=line><span class=cl>tcpdump -A -s0 port <span class=m>3306</span> and <span class=s1>&#39;tcp[((tcp[12:1] &amp; 0xf0) &gt;&gt; 2):4] = 0x73656c65&#39;</span>  <span class=c1># è¿‡æ»¤&#34;select&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># tsharkå®æ—¶åˆ†æ</span>
</span></span><span class=line><span class=cl>yum install -y wireshark          <span class=c1># CentOS</span>
</span></span><span class=line><span class=cl>apt install -y tshark             <span class=c1># Ubuntu</span>
</span></span><span class=line><span class=cl>tshark -i eth0 -Y <span class=s2>&#34;http.request&#34;</span> -T fields -e http.host -e http.request.uri
</span></span></code></pre></td></tr></table></div></div><h3 id=33-ç«¯å£æ‰«æ>3.3 ç«¯å£æ‰«æ</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nmap -sP 192.168.1.0/24          <span class=c1># å­˜æ´»ä¸»æœºæ‰«æ</span>
</span></span><span class=line><span class=cl>nmap -sS -p 1-65535 -T4 target   <span class=c1># å…¨ç«¯å£SYNæ‰«æ</span>
</span></span><span class=line><span class=cl>nmap --script<span class=o>=</span>vuln target        <span class=c1># æ¼æ´æ‰«æ</span>
</span></span><span class=line><span class=cl>yum install -y nmap               <span class=c1># CentOS</span>
</span></span><span class=line><span class=cl>apt install -y nmap               <span class=c1># Ubuntu</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Masscanè¶…é«˜é€Ÿæ‰«æ</span>
</span></span><span class=line><span class=cl>masscan 192.168.0.0/16 -p 80,443 --rate<span class=o>=</span><span class=m>10000</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=å››ç›‘æ§ä¸æ€§èƒ½åˆ†æ>å››ã€ç›‘æ§ä¸æ€§èƒ½åˆ†æ</h2><h3 id=41-å®æ—¶ç›‘æ§>4.1 å®æ—¶ç›‘æ§</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># glanceså…¨èƒ½ç›‘æ§</span>
</span></span><span class=line><span class=cl>yum install -y glances          <span class=c1># CentOS (EPEL)</span>
</span></span><span class=line><span class=cl>apt install -y glances          <span class=c1># Ubuntu</span>
</span></span><span class=line><span class=cl>glances -w                       <span class=c1># Webæ¨¡å¼ http://ip:61208</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># nethogsè¿›ç¨‹çº§æµé‡</span>
</span></span><span class=line><span class=cl>yum install -y nethogs          <span class=c1># CentOS (EPEL)</span>
</span></span><span class=line><span class=cl>apt install -y nethogs          <span class=c1># Ubuntu</span>
</span></span><span class=line><span class=cl>nethogs -d <span class=m>5</span> -v <span class=m>3</span>               <span class=c1># 5ç§’åˆ·æ–°ï¼Œæ˜¾ç¤ºMB</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># iotop IOç›‘æ§</span>
</span></span><span class=line><span class=cl>yum install -y iotop            <span class=c1># CentOS (EPEL)</span>
</span></span><span class=line><span class=cl>apt install -y iotop            <span class=c1># Ubuntu</span>
</span></span><span class=line><span class=cl>iotop -oP                       <span class=c1># åªæ˜¾ç¤ºæœ‰IOçš„è¿›ç¨‹</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># iftop æµé‡ç›‘æ§</span>
</span></span><span class=line><span class=cl>yum install -y iftop            <span class=c1># CentOS (EPEL)</span>
</span></span><span class=line><span class=cl>apt install -y iftop            <span class=c1># Ubuntu</span>
</span></span><span class=line><span class=cl>iftop -i eth0 -n -P             <span class=c1># æ˜¾ç¤ºç«¯å£å’ŒIP</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=42-æ€§èƒ½åˆ†æ>4.2 æ€§èƒ½åˆ†æ</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># straceç³»ç»Ÿè°ƒç”¨</span>
</span></span><span class=line><span class=cl>strace -c -p PID                <span class=c1># ç»Ÿè®¡è€—æ—¶</span>
</span></span><span class=line><span class=cl>strace -f -p PID                <span class=c1># è·Ÿè¸ªå­è¿›ç¨‹</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># perfå†…æ ¸çº§åˆ†æ</span>
</span></span><span class=line><span class=cl>yum install -y perf            <span class=c1># CentOS</span>
</span></span><span class=line><span class=cl>apt install -y linux-tools-common <span class=c1># Ubuntu</span>
</span></span><span class=line><span class=cl>perf top -p PID                 <span class=c1># å®æ—¶åˆ†æ</span>
</span></span><span class=line><span class=cl>perf record -p PID -g           <span class=c1># è®°å½•é‡‡æ ·</span>
</span></span><span class=line><span class=cl>perf report                     <span class=c1># ç”ŸæˆæŠ¥å‘Š</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># lsofæŸ¥çœ‹æ–‡ä»¶å¥æŸ„</span>
</span></span><span class=line><span class=cl>lsof -p PID <span class=p>|</span> wc -l             <span class=c1># ç»Ÿè®¡å¥æŸ„æ•°</span>
</span></span><span class=line><span class=cl>lsof -i TCP:3306                <span class=c1># æŸ¥çœ‹æ•°æ®åº“è¿æ¥</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=43-å†å²æ•°æ®>4.3 å†å²æ•°æ®</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># sarç³»ç»Ÿæ´»åŠ¨æŠ¥å‘Š</span>
</span></span><span class=line><span class=cl>yum install -y sysstat          <span class=c1># CentOS</span>
</span></span><span class=line><span class=cl>apt install -y sysstat          <span class=c1># Ubuntu</span>
</span></span><span class=line><span class=cl>systemctl <span class=nb>enable</span> --now sysstat  <span class=c1># å¯ç”¨æ”¶é›†</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sar -u <span class=m>1</span> <span class=m>10</span>                     <span class=c1># CPU</span>
</span></span><span class=line><span class=cl>sar -r <span class=m>1</span> <span class=m>10</span>                     <span class=c1># å†…å­˜</span>
</span></span><span class=line><span class=cl>sar -d <span class=m>1</span> <span class=m>10</span>                     <span class=c1># ç£ç›˜</span>
</span></span><span class=line><span class=cl>sar -n DEV <span class=m>1</span> <span class=m>10</span>                 <span class=c1># ç½‘ç»œ</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=äº”æ–‡æœ¬ç¼–è¾‘å™¨é…ç½®>äº”ã€æ–‡æœ¬ç¼–è¾‘å™¨é…ç½®</h2><h3 id=51-vim-è¿ç»´ç»ˆæé…ç½®>5.1 Vim è¿ç»´ç»ˆæé…ç½®</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># å®‰è£…</span>
</span></span><span class=line><span class=cl>yum install -y vim-enhanced vim-X11  <span class=c1># CentOS</span>
</span></span><span class=line><span class=cl>apt install -y vim vim-gtk3          <span class=c1># Ubuntu</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å®Œæ•´é…ç½®ï¼ˆ~/.vimrcï¼‰</span>
</span></span><span class=line><span class=cl>cat &gt; ~/.vimrc <span class=s>&lt;&lt; &#39;EOF&#39;
</span></span></span><span class=line><span class=cl><span class=s>&#34; ==================== è¿ç»´ä¸“ç”¨ Vim é…ç½® ====================
</span></span></span><span class=line><span class=cl><span class=s>set nocompatible
</span></span></span><span class=line><span class=cl><span class=s>syntax on
</span></span></span><span class=line><span class=cl><span class=s>set number relativenumber
</span></span></span><span class=line><span class=cl><span class=s>set cursorline ruler showcmd
</span></span></span><span class=line><span class=cl><span class=s>set incsearch hlsearch ignorecase smartcase
</span></span></span><span class=line><span class=cl><span class=s>set wrap linebreak
</span></span></span><span class=line><span class=cl><span class=s>set tabstop=4 shiftwidth=4 expandtab autoindent smartindent
</span></span></span><span class=line><span class=cl><span class=s>set mouse=a clipboard=unnamedplus
</span></span></span><span class=line><span class=cl><span class=s>set encoding=utf-8 fileencodings=utf-8,gbk,gb2312,gb18030
</span></span></span><span class=line><span class=cl><span class=s>set pastetoggle=&lt;F2&gt;
</span></span></span><span class=line><span class=cl><span class=s>set listchars=tab:&gt;-,trail:Â·,space:Â·
</span></span></span><span class=line><span class=cl><span class=s>nnoremap &lt;F3&gt; :set list!&lt;cr&gt;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>&#34; å¿«é€Ÿç¼–è¾‘vimrc
</span></span></span><span class=line><span class=cl><span class=s>nnoremap &lt;leader&gt;ev :vsplit $MYVIMRC&lt;cr&gt;
</span></span></span><span class=line><span class=cl><span class=s>nnoremap &lt;leader&gt;sv :source $MYVIMRC&lt;cr&gt;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>&#34; æ’ä»¶ç®¡ç†å™¨
</span></span></span><span class=line><span class=cl><span class=s>curl -fLo ~/.vim/autoload/plug.vim --create-dirs \
</span></span></span><span class=line><span class=cl><span class=s>  https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>call plug#begin(&#39;~/.vim/plugged&#39;)
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>&#34; æ–‡ä»¶æµè§ˆå™¨
</span></span></span><span class=line><span class=cl><span class=s>Plug &#39;preservim/nerdtree&#39;
</span></span></span><span class=line><span class=cl><span class=s>nnoremap &lt;F5&gt; :NERDTreeToggle&lt;cr&gt;
</span></span></span><span class=line><span class=cl><span class=s>let NERDTreeShowHidden=1
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>&#34; çŠ¶æ€æ 
</span></span></span><span class=line><span class=cl><span class=s>Plug &#39;vim-airline/vim-airline&#39;
</span></span></span><span class=line><span class=cl><span class=s>Plug &#39;vim-airline/vim-airline-themes&#39;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>&#34; Gité›†æˆ
</span></span></span><span class=line><span class=cl><span class=s>Plug &#39;tpope/vim-fugitive&#39;
</span></span></span><span class=line><span class=cl><span class=s>nnoremap &lt;leader&gt;gs :Gstatus&lt;cr&gt;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>&#34; æ™ºèƒ½è¡¥å…¨
</span></span></span><span class=line><span class=cl><span class=s>Plug &#39;neoclide/coc.nvim&#39;, {&#39;branch&#39;: &#39;release&#39;}
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>&#34; è¯­æ³•æ£€æŸ¥
</span></span></span><span class=line><span class=cl><span class=s>Plug &#39;dense-analysis/ale&#39;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>&#34; å¿«é€Ÿæ³¨é‡Š
</span></span></span><span class=line><span class=cl><span class=s>Plug &#39;preservim/nerdcommenter&#39;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>&#34; å½©è™¹æ‹¬å·
</span></span></span><span class=line><span class=cl><span class=s>Plug &#39;luochen1990/rainbow&#39;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>&#34; æ–‡ä»¶æœç´¢
</span></span></span><span class=line><span class=cl><span class=s>Plug &#39;ctrlpvim/ctrlp.vim&#39;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>&#34; ç¼©è¿›çº¿
</span></span></span><span class=line><span class=cl><span class=s>Plug &#39;Yggdroot/indentLine&#39;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>&#34; æ—¥å¿—é«˜äº®
</span></span></span><span class=line><span class=cl><span class=s>Plug &#39;MTDL9/vim-log-highlighting&#39;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>&#34; Kubernetes
</span></span></span><span class=line><span class=cl><span class=s>Plug &#39;andrewstuart/vim-kubernetes&#39;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>call plug#end()
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>&#34; YAMLç¼©è¿›
</span></span></span><span class=line><span class=cl><span class=s>autocmd FileType yaml setlocal ts=2 sts=2 sw=2 expandtab
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>&#34; å¤§æ–‡ä»¶ä¼˜åŒ–
</span></span></span><span class=line><span class=cl><span class=s>let g:LargeFile=10
</span></span></span><span class=line><span class=cl><span class=s>autocmd BufReadPre * let f=getfsize(expand(&#39;%&#39;))
</span></span></span><span class=line><span class=cl><span class=s>autocmd BufReadPre * if f &gt; g:LargeFile*1024*1024 | set eventignore+=FileType | set syntax=OFF | set filetype=conf | endif
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å®‰è£…æ’ä»¶</span>
</span></span><span class=line><span class=cl>vim +PlugInstall +qall
</span></span></code></pre></td></tr></table></div></div><h3 id=52-nano-åŸºç¡€é…ç½®>5.2 Nano åŸºç¡€é…ç½®</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat &gt; ~/.nanorc <span class=s>&lt;&lt; EOF
</span></span></span><span class=line><span class=cl><span class=s>include /usr/share/nano/*.nanorc
</span></span></span><span class=line><span class=cl><span class=s>set tabsize 4
</span></span></span><span class=line><span class=cl><span class=s>set tabstospaces
</span></span></span><span class=line><span class=cl><span class=s>set autoindent
</span></span></span><span class=line><span class=cl><span class=s>set linenumbers
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=å…­å®‰å…¨å®¡è®¡å·¥å…·>å…­ã€å®‰å…¨å®¡è®¡å·¥å…·</h2><h3 id=61-ç³»ç»Ÿå®‰å…¨æ‰«æ>6.1 ç³»ç»Ÿå®‰å…¨æ‰«æ</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Lynis å®‰å…¨å®¡è®¡</span>
</span></span><span class=line><span class=cl>yum install -y lynis            <span class=c1># CentOS (EPEL)</span>
</span></span><span class=line><span class=cl>apt install -y lynis            <span class=c1># Ubuntu</span>
</span></span><span class=line><span class=cl>lynis audit system --quick      <span class=c1># å¿«é€Ÿæ‰«æ</span>
</span></span><span class=line><span class=cl>lynis audit system --pentest    <span class=c1># æ¸—é€æµ‹è¯•æ¨¡å¼</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># chkrootkit/rkhunter</span>
</span></span><span class=line><span class=cl>yum install -y rkhunter         <span class=c1># CentOS</span>
</span></span><span class=line><span class=cl>apt install -y rkhunter chkrootkit  <span class=c1># Ubuntu</span>
</span></span><span class=line><span class=cl>rkhunter --check --sk          <span class=c1># æ£€æŸ¥rootkit</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ClamAV æ€æ¯’</span>
</span></span><span class=line><span class=cl>yum install -y clamav clamav-update  <span class=c1># CentOS</span>
</span></span><span class=line><span class=cl>apt install -y clamav           <span class=c1># Ubuntu</span>
</span></span><span class=line><span class=cl>freshclam                       <span class=c1># æ›´æ–°ç—…æ¯’åº“</span>
</span></span><span class=line><span class=cl>clamscan -r /var/www            <span class=c1># æ‰«æç›®å½•</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=62-å…¥ä¾µæ£€æµ‹>6.2 å…¥ä¾µæ£€æµ‹</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Fail2ban é˜²æš´åŠ›ç ´è§£</span>
</span></span><span class=line><span class=cl>yum install -y fail2ban         <span class=c1># CentOS</span>
</span></span><span class=line><span class=cl>apt install -y fail2ban         <span class=c1># Ubuntu</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat &gt; /etc/fail2ban/jail.local <span class=s>&lt;&lt; EOF
</span></span></span><span class=line><span class=cl><span class=s>[sshd]
</span></span></span><span class=line><span class=cl><span class=s>enabled = true
</span></span></span><span class=line><span class=cl><span class=s>port = 22
</span></span></span><span class=line><span class=cl><span class=s>filter = sshd
</span></span></span><span class=line><span class=cl><span class=s>logpath = /var/log/secure      # Ubuntuä¸º/var/log/auth.log
</span></span></span><span class=line><span class=cl><span class=s>maxretry = 3
</span></span></span><span class=line><span class=cl><span class=s>bantime = 3600
</span></span></span><span class=line><span class=cl><span class=s>findtime = 600
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>systemctl <span class=nb>enable</span> --now fail2ban
</span></span><span class=line><span class=cl>fail2ban-client status sshd
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># AIDE æ–‡ä»¶å®Œæ•´æ€§æ£€æŸ¥</span>
</span></span><span class=line><span class=cl>yum install -y aide            <span class=c1># CentOS</span>
</span></span><span class=line><span class=cl>apt install -y aide            <span class=c1># Ubuntu</span>
</span></span><span class=line><span class=cl>aideinit                       <span class=c1># åˆå§‹åŒ–æ•°æ®åº“</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=63-æƒé™æ£€æŸ¥>6.3 æƒé™æ£€æŸ¥</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># SUID/SGIDæ–‡ä»¶ï¼ˆææƒé£é™©ï¼‰</span>
</span></span><span class=line><span class=cl>find / -perm -4000 -type f 2&gt;/dev/null
</span></span><span class=line><span class=cl>find / -perm -2000 -type f 2&gt;/dev/null
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å…¨å±€å¯å†™æ–‡ä»¶</span>
</span></span><span class=line><span class=cl>find / -type f -perm -002 2&gt;/dev/null
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ— å±ä¸»æ–‡ä»¶</span>
</span></span><span class=line><span class=cl>find / -nouser -o -nogroup 2&gt;/dev/null
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=ä¸ƒè‡ªåŠ¨åŒ–è¿ç»´å¹³å°>ä¸ƒã€è‡ªåŠ¨åŒ–è¿ç»´å¹³å°</h2><h3 id=71-ansible-å¿«é€Ÿéƒ¨ç½²>7.1 Ansible å¿«é€Ÿéƒ¨ç½²</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># å®‰è£…</span>
</span></span><span class=line><span class=cl>pip3 install ansible --user
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># é…ç½®</span>
</span></span><span class=line><span class=cl>cat &gt; ~/.ansible.cfg <span class=s>&lt;&lt; EOF
</span></span></span><span class=line><span class=cl><span class=s>[defaults]
</span></span></span><span class=line><span class=cl><span class=s>host_key_checking = False
</span></span></span><span class=line><span class=cl><span class=s>inventory = ./hosts
</span></span></span><span class=line><span class=cl><span class=s>remote_user = root
</span></span></span><span class=line><span class=cl><span class=s>forks = 50
</span></span></span><span class=line><span class=cl><span class=s>timeout = 30
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>[privilege_escalation]
</span></span></span><span class=line><span class=cl><span class=s>become = True
</span></span></span><span class=line><span class=cl><span class=s>become_method = sudo
</span></span></span><span class=line><span class=cl><span class=s>become_user = root
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># hostsæ¸…å•ç¤ºä¾‹</span>
</span></span><span class=line><span class=cl>cat &gt; hosts <span class=s>&lt;&lt; EOF
</span></span></span><span class=line><span class=cl><span class=s>[web]
</span></span></span><span class=line><span class=cl><span class=s>web[01:10].example.com
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>[db]
</span></span></span><span class=line><span class=cl><span class=s>db01.example.com
</span></span></span><span class=line><span class=cl><span class=s>db02.example.com
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>[k8s]
</span></span></span><span class=line><span class=cl><span class=s>k8s-master.example.com
</span></span></span><span class=line><span class=cl><span class=s>k8s-node[01:05].example.com
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¸¸ç”¨æ¨¡å—</span>
</span></span><span class=line><span class=cl>ansible all -m ping
</span></span><span class=line><span class=cl>ansible web -m shell -a <span class=s2>&#34;uptime&#34;</span>
</span></span><span class=line><span class=cl>ansible db -m yum -a <span class=s2>&#34;name=mysql state=present&#34;</span>      <span class=c1># CentOS</span>
</span></span><span class=line><span class=cl>ansible db -m apt -a <span class=s2>&#34;name=mysql-server state=present&#34;</span>  <span class=c1># Ubuntu</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=72-saltstack>7.2 SaltStack</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># å®‰è£…</span>
</span></span><span class=line><span class=cl>yum install -y salt-master salt-minion  <span class=c1># CentOS</span>
</span></span><span class=line><span class=cl>apt install -y salt-master salt-minion  <span class=c1># Ubuntu</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># é…ç½®minionæŒ‡å‘master</span>
</span></span><span class=line><span class=cl>sed -i <span class=s1>&#39;s/#master: salt/master: salt-master.example.com/&#39;</span> /etc/salt/minion
</span></span><span class=line><span class=cl>systemctl <span class=nb>enable</span> --now salt-minion
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ¥å—key</span>
</span></span><span class=line><span class=cl>salt-key -L                      <span class=c1># åˆ—å‡ºå¾…æ¥å—</span>
</span></span><span class=line><span class=cl>salt-key -A                      <span class=c1># æ¥å—å…¨éƒ¨</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ‰§è¡Œå‘½ä»¤</span>
</span></span><span class=line><span class=cl>salt <span class=s1>&#39;*&#39;</span> test.ping
</span></span><span class=line><span class=cl>salt <span class=s1>&#39;*&#39;</span> cmd.run <span class=s1>&#39;uptime&#39;</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=å…«ç»ˆç«¯æ•ˆç‡å·¥å…·>å…«ã€ç»ˆç«¯æ•ˆç‡å·¥å…·</h2><h3 id=81-tmux-ç»ˆæé…ç½®>8.1 tmux ç»ˆæé…ç½®</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># å®‰è£…</span>
</span></span><span class=line><span class=cl>yum install -y tmux             <span class=c1># CentOS</span>
</span></span><span class=line><span class=cl>apt install -y tmux             <span class=c1># Ubuntu</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># é…ç½®ï¼ˆ~/.tmux.confï¼‰</span>
</span></span><span class=line><span class=cl>cat &gt; ~/.tmux.conf <span class=s>&lt;&lt; EOF
</span></span></span><span class=line><span class=cl><span class=s># ä¿®æ”¹å‰ç¼€ä¸ºCtrl+A
</span></span></span><span class=line><span class=cl><span class=s>unbind C-b
</span></span></span><span class=line><span class=cl><span class=s>set -g prefix C-a
</span></span></span><span class=line><span class=cl><span class=s>bind C-a send-prefix
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># é¼ æ ‡æ”¯æŒ
</span></span></span><span class=line><span class=cl><span class=s>set -g mouse on
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># çŠ¶æ€æ 
</span></span></span><span class=line><span class=cl><span class=s>set -g status-right &#34;%Y-%m-%d %H:%M&#34;
</span></span></span><span class=line><span class=cl><span class=s>set -g status-interval 60
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># çª—å£/é¢æ¿
</span></span></span><span class=line><span class=cl><span class=s>bind c new-window -c &#34;#{pane_current_path}&#34;
</span></span></span><span class=line><span class=cl><span class=s>bind % split-window -h -c &#34;#{pane_current_path}&#34;
</span></span></span><span class=line><span class=cl><span class=s>bind &#39;&#34;&#39; split-window -v -c &#34;#{pane_current_path}&#34;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># é‡æ–°åŠ è½½
</span></span></span><span class=line><span class=cl><span class=s>bind r source-file ~/.tmux.conf \; display &#34;Reloaded!&#34;
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># æ’ä»¶ç®¡ç†å™¨</span>
</span></span><span class=line><span class=cl>git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¸¸ç”¨æ“ä½œ</span>
</span></span><span class=line><span class=cl>tmux new -s ops                 <span class=c1># æ–°å»ºä¼šè¯</span>
</span></span><span class=line><span class=cl>tmux attach -t ops              <span class=c1># è¿æ¥</span>
</span></span><span class=line><span class=cl>tmux ls                         <span class=c1># åˆ—å‡º</span>
</span></span><span class=line><span class=cl>Ctrl+A d                        <span class=c1># åˆ†ç¦»</span>
</span></span><span class=line><span class=cl>Ctrl+A c                        <span class=c1># æ–°çª—å£</span>
</span></span><span class=line><span class=cl>Ctrl+A %                        <span class=c1># å‚ç›´åˆ†å±</span>
</span></span><span class=line><span class=cl>Ctrl+A <span class=s2>&#34;                        # æ°´å¹³åˆ†å±
</span></span></span></code></pre></td></tr></table></div></div><h3 id=82-fzf-æ¨¡ç³ŠæŸ¥æ‰¾>8.2 fzf æ¨¡ç³ŠæŸ¥æ‰¾</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># å®‰è£…</span>
</span></span><span class=line><span class=cl>git clone --depth <span class=m>1</span> https://github.com/junegunn/fzf.git ~/.fzf
</span></span><span class=line><span class=cl>~/.fzf/install
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä½¿ç”¨ç¤ºä¾‹</span>
</span></span><span class=line><span class=cl><span class=nb>history</span> <span class=p>|</span> fzf
</span></span><span class=line><span class=cl>find . -type f <span class=p>|</span> fzf
</span></span></code></pre></td></tr></table></div></div><h3 id=83-autojump-ç›®å½•è·³è½¬>8.3 autojump ç›®å½•è·³è½¬</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>yum install -y autojump          <span class=c1># CentOS (EPEL)</span>
</span></span><span class=line><span class=cl>apt install -y autojump          <span class=c1># Ubuntu</span>
</span></span><span class=line><span class=cl><span class=c1># ä½¿ç”¨: j myproject  # è‡ªåŠ¨åŒ¹é…è·³è½¬</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=ä¹äº‘åŸç”Ÿå·¥å…·é›†>ä¹ã€äº‘åŸç”Ÿå·¥å…·é›†</h2><h3 id=91-docker-å…¨å®¶æ¡¶>9.1 Docker å…¨å®¶æ¡¶</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># å®‰è£…</span>
</span></span><span class=line><span class=cl>curl -fsSL https://get.docker.com <span class=p>|</span> bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># é…ç½®é•œåƒåŠ é€Ÿ</span>
</span></span><span class=line><span class=cl>cat &gt; /etc/docker/daemon.json <span class=s>&lt;&lt; EOF
</span></span></span><span class=line><span class=cl><span class=s>{
</span></span></span><span class=line><span class=cl><span class=s>  &#34;registry-mirrors&#34;: [&#34;https://mirror.gcr.io&#34;],
</span></span></span><span class=line><span class=cl><span class=s>  &#34;log-driver&#34;: &#34;json-file&#34;,
</span></span></span><span class=line><span class=cl><span class=s>  &#34;log-opts&#34;: {
</span></span></span><span class=line><span class=cl><span class=s>    &#34;max-size&#34;: &#34;100m&#34;,
</span></span></span><span class=line><span class=cl><span class=s>    &#34;max-file&#34;: &#34;3&#34;
</span></span></span><span class=line><span class=cl><span class=s>  }
</span></span></span><span class=line><span class=cl><span class=s>}
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å¸¸ç”¨å·¥å…·</span>
</span></span><span class=line><span class=cl>docker stats                     <span class=c1># å®¹å™¨èµ„æº</span>
</span></span><span class=line><span class=cl>docker system df                 <span class=c1># ç£ç›˜ä½¿ç”¨</span>
</span></span><span class=line><span class=cl>docker <span class=nb>exec</span> -it container_id bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># dive é•œåƒåˆ†æ</span>
</span></span><span class=line><span class=cl>curl -L https://github.com/wagoodman/dive/releases/download/v0.9.2/dive_0.9.2_linux_amd64.rpm -o dive.rpm <span class=o>&amp;&amp;</span> yum install -y dive
</span></span><span class=line><span class=cl><span class=c1># Ubuntuç”¨ https://github.com/wagoodman/dive/releases/download/v0.9.2/dive_0.9.2_linux_amd64.deb</span>
</span></span><span class=line><span class=cl>dive nginx:latest
</span></span></code></pre></td></tr></table></div></div><h3 id=92-kubernetes-å·¥å…·>9.2 Kubernetes å·¥å…·</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># kubectl</span>
</span></span><span class=line><span class=cl>curl -LO <span class=s2>&#34;https://dl.k8s.io/release/</span><span class=k>$(</span>curl -L -s https://dl.k8s.io/release/stable.txt<span class=k>)</span><span class=s2>/bin/linux/amd64/kubectl&#34;</span>
</span></span><span class=line><span class=cl>chmod +x kubectl <span class=o>&amp;&amp;</span> mv kubectl /usr/local/bin/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># k9s ç»ˆç«¯UI</span>
</span></span><span class=line><span class=cl>curl -sS https://webinstall.dev/k9s <span class=p>|</span> bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># kubectx/kubens</span>
</span></span><span class=line><span class=cl>curl -L https://raw.githubusercontent.com/ahmetb/kubectx/master/kubectx -o /usr/local/bin/kubectx
</span></span><span class=line><span class=cl>curl -L https://raw.githubusercontent.com/ahmetb/kubectx/master/kubens -o /usr/local/bin/kubens
</span></span><span class=line><span class=cl>chmod +x /usr/local/bin/kubectx /usr/local/bin/kubens
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Helm</span>
</span></span><span class=line><span class=cl>curl https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3 <span class=p>|</span> bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># åˆ«å</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>k</span><span class=o>=</span><span class=s1>&#39;kubectl&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>kg</span><span class=o>=</span><span class=s1>&#39;kubectl get&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>kd</span><span class=o>=</span><span class=s1>&#39;kubectl describe&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>ke</span><span class=o>=</span><span class=s1>&#39;kubectl exec -it&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>klog</span><span class=o>=</span><span class=s1>&#39;kubectl logs -f&#39;</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=åä¸€é”®å®‰è£…è„šæœ¬>åã€ä¸€é”®å®‰è£…è„šæœ¬</h2><h3 id=101-centos-è¿ç»´å…¨å®¶æ¡¶>10.1 CentOS è¿ç»´å…¨å®¶æ¡¶</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat &gt; install_ops_tools_centos.sh <span class=s>&lt;&lt; &#39;EOF&#39;
</span></span></span><span class=line><span class=cl><span class=s>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=s>set -e
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&gt;&gt;&gt; å®‰è£…EPELæº&#34;
</span></span></span><span class=line><span class=cl><span class=s>yum install -y epel-release
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&gt;&gt;&gt; å®‰è£…åŸºç¡€å·¥å…·&#34;
</span></span></span><span class=line><span class=cl><span class=s>yum install -y vim htop iotop iftop nethogs glances git telnet net-tools bind-utils traceroute mtr nc tcpdump nmap lsof strace ltrace sysstat dstat bash-completion chrony unzip zip psmisc screen tmux expect pv jq python3-pip ncdu tree smartmontools ipmitool dmidecode
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&gt;&gt;&gt; å®‰è£…ç½‘ç»œå·¥å…·&#34;
</span></span></span><span class=line><span class=cl><span class=s>yum install -y nethogs iftop mtr nmap tcpdump
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&gt;&gt;&gt; å®‰è£…ç›‘æ§å·¥å…·&#34;
</span></span></span><span class=line><span class=cl><span class=s>yum install -y htop iotop glances dstat
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&gt;&gt;&gt; å®‰è£…æ—¥å¿—å·¥å…·&#34;
</span></span></span><span class=line><span class=cl><span class=s>yum install -y lnav multitail
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&gt;&gt;&gt; å®‰è£…Docker&#34;
</span></span></span><span class=line><span class=cl><span class=s>curl -fsSL https://get.docker.com | bash
</span></span></span><span class=line><span class=cl><span class=s>systemctl enable --now docker
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&gt;&gt;&gt; å®‰è£…Pythonå·¥å…·&#34;
</span></span></span><span class=line><span class=cl><span class=s>pip3 install --user mycli pgcli ansible yq thefuck
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&gt;&gt;&gt; å®‰è£…Tmuxæ’ä»¶ç®¡ç†å™¨&#34;
</span></span></span><span class=line><span class=cl><span class=s>git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&gt;&gt;&gt; å®‰è£…Vimæ’ä»¶ç®¡ç†å™¨&#34;
</span></span></span><span class=line><span class=cl><span class=s>curl -fLo ~/.vim/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&gt;&gt;&gt; å®‰è£…fzf&#34;
</span></span></span><span class=line><span class=cl><span class=s>git clone --depth 1 https://github.com/junegunn/fzf.git ~/.fzf
</span></span></span><span class=line><span class=cl><span class=s>~/.fzf/install
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&gt;&gt;&gt; å®‰è£…neofetch&#34;
</span></span></span><span class=line><span class=cl><span class=s>yum install -y neofetch
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;å®Œæˆï¼è¯·æ‰‹åŠ¨è¿è¡Œ vim +PlugInstall å’Œ tmuxæ’ä»¶å®‰è£…(Ctrl+A I)&#34;
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>chmod +x install_ops_tools_centos.sh
</span></span></code></pre></td></tr></table></div></div><h3 id=102-ubuntu-è¿ç»´å…¨å®¶æ¡¶>10.2 Ubuntu è¿ç»´å…¨å®¶æ¡¶</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat &gt; install_ops_tools_ubuntu.sh <span class=s>&lt;&lt; &#39;EOF&#39;
</span></span></span><span class=line><span class=cl><span class=s>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=s>set -e
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&gt;&gt;&gt; æ›´æ–°æº&#34;
</span></span></span><span class=line><span class=cl><span class=s>apt update
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&gt;&gt;&gt; å®‰è£…åŸºç¡€å·¥å…·&#34;
</span></span></span><span class=line><span class=cl><span class=s>apt install -y vim htop iotop iftop nethogs glances git telnet net-tools dnsutils traceroute mtr netcat-openbsd tcpdump nmap lsof strace ltrace sysstat dstat bash-completion chrony unzip zip psmisc screen tmux expect pv jq python3-pip ncdu tree smartmontools ipmitool dmidecode
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&gt;&gt;&gt; å®‰è£…ç½‘ç»œå·¥å…·&#34;
</span></span></span><span class=line><span class=cl><span class=s>apt install -y nethogs iftop mtr nmap tcpdump
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&gt;&gt;&gt; å®‰è£…ç›‘æ§å·¥å…·&#34;
</span></span></span><span class=line><span class=cl><span class=s>apt install -y htop iotop glances dstat
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&gt;&gt;&gt; å®‰è£…æ—¥å¿—å·¥å…·&#34;
</span></span></span><span class=line><span class=cl><span class=s>apt install -y lnav multitail
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&gt;&gt;&gt; å®‰è£…Docker&#34;
</span></span></span><span class=line><span class=cl><span class=s>curl -fsSL https://get.docker.com | bash
</span></span></span><span class=line><span class=cl><span class=s>systemctl enable --now docker
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&gt;&gt;&gt; å®‰è£…Pythonå·¥å…·&#34;
</span></span></span><span class=line><span class=cl><span class=s>pip3 install --user mycli pgcli ansible yq thefuck
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&gt;&gt;&gt; å®‰è£…Tmuxæ’ä»¶ç®¡ç†å™¨&#34;
</span></span></span><span class=line><span class=cl><span class=s>git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&gt;&gt;&gt; å®‰è£…Vimæ’ä»¶ç®¡ç†å™¨&#34;
</span></span></span><span class=line><span class=cl><span class=s>curl -fLo ~/.vim/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&gt;&gt;&gt; å®‰è£…fzf&#34;
</span></span></span><span class=line><span class=cl><span class=s>git clone --depth 1 https://github.com/junegunn/fzf.git ~/.fzf
</span></span></span><span class=line><span class=cl><span class=s>~/.fzf/install
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&gt;&gt;&gt; å®‰è£…neofetch&#34;
</span></span></span><span class=line><span class=cl><span class=s>apt install -y neofetch
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;å®Œæˆï¼è¯·æ‰‹åŠ¨è¿è¡Œ vim +PlugInstall å’Œ tmuxæ’ä»¶å®‰è£…(Ctrl+A I)&#34;
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>chmod +x install_ops_tools_ubuntu.sh
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=åä¸€è¿ç»´åˆ«ååº“bashrc>åä¸€ã€è¿ç»´åˆ«ååº“ï¼ˆ~/.bashrcï¼‰</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat &gt;&gt; ~/.bashrc <span class=s>&lt;&lt; &#39;EOF&#39;
</span></span></span><span class=line><span class=cl><span class=s># ==================== è¿ç»´åˆ«ååº“ ====================
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># ç³»ç»Ÿä¿¡æ¯
</span></span></span><span class=line><span class=cl><span class=s>alias sysinfo=&#39;echo &#34;--- CPU ---&#34;; lscpu | grep &#34;Model name&#34;; echo &#34;--- Memory ---&#34;; free -h; echo &#34;--- Disk ---&#34;; df -hT | grep -v tmpfs; echo &#34;--- Network ---&#34;; ip a | grep &#34;inet &#34;; echo &#34;--- Load ---&#34;; uptime&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias ports=&#39;ss -tuln | grep LISTEN&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias bigfiles=&#39;find / -type f -size +100M -exec ls -lh {} \; 2&gt;/dev/null | head -20&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias iplist=&#39;ip a | grep &#34;inet &#34; | awk \&#39;{print $2}\&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># åŒ…ç®¡ç†
</span></span></span><span class=line><span class=cl><span class=s>alias yup=&#39;yum update -y&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias yin=&#39;yum install -y&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias yrm=&#39;yum remove -y&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias ysearch=&#39;yum search&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias aup=&#39;apt update &amp;&amp; apt upgrade -y&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias ain=&#39;apt install -y&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias arm=&#39;apt remove -y&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias asearch=&#39;apt search&#39;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># Docker
</span></span></span><span class=line><span class=cl><span class=s>alias dps=&#39;docker ps --format &#34;table {{.ID}}\t{{.Names}}\t{{.Status}}\t{{.Ports}}&#34;&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias dsa=&#39;docker stop $(docker ps -aq)&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias drma=&#39;docker rm $(docker ps -aq)&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias dcl=&#39;docker system prune -a&#39;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># K8s
</span></span></span><span class=line><span class=cl><span class=s>alias k=&#39;kubectl&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias kg=&#39;kubectl get&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias kd=&#39;kubectl describe&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias ke=&#39;kubectl exec -it&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias klog=&#39;kubectl logs -f&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias kdel=&#39;kubectl delete&#39;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># æ—¥å¿—
</span></span></span><span class=line><span class=cl><span class=s>alias tailf=&#39;tail -f&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias grepall=&#39;grep -r --include=&#34;*.log&#34; --include=&#34;*.txt&#34;&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias journalerr=&#39;journalctl -p err -f&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias journalboot=&#39;journalctl -b&#39;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># ç½‘ç»œ
</span></span></span><span class=line><span class=cl><span class=s>alias nettest=&#39;ping 114.114.114.114 -c 3 &amp;&amp; ping 8.8.8.8 -c 3 &amp;&amp; ping baidu.com -c 3&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias ports80=&#39;ss -ant | grep :80 | wc -l&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias ports443=&#39;ss -ant | grep :443 | wc -l&#39;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># å®‰å…¨
</span></span></span><span class=line><span class=cl><span class=s>alias ssh20=&#39;ssh -o ServerAliveInterval=60 -o TCPKeepAlive=yes&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias sshproxy=&#39;ssh -D 1080 -C -N&#39;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># é¢œè‰²
</span></span></span><span class=line><span class=cl><span class=s>alias ls=&#39;ls --color=auto&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias ll=&#39;ls -lhF&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias grep=&#39;grep --color=auto&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias ip=&#39;ip -c&#39;               # Ubuntu
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># å†å²è®°å½•å¢å¼º
</span></span></span><span class=line><span class=cl><span class=s>export HISTTIMEFORMAT=&#34;%Y-%m-%d %H:%M:%S &#34;
</span></span></span><span class=line><span class=cl><span class=s>export HISTSIZE=10000
</span></span></span><span class=line><span class=cl><span class=s>export HISTFILESIZE=10000
</span></span></span><span class=line><span class=cl><span class=s>shopt -s histappend
</span></span></span><span class=line><span class=cl><span class=s>export PROMPT_COMMAND=&#34;history -a; history -c; history -r; $PROMPT_COMMAND&#34;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># è·¯å¾„
</span></span></span><span class=line><span class=cl><span class=s>export PATH=$PATH:/usr/local/bin:/usr/local/sbin:$HOME/.local/bin
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># å®‰å…¨åˆ é™¤
</span></span></span><span class=line><span class=cl><span class=s>alias rm=&#39;rm -i&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias cp=&#39;cp -i&#39;
</span></span></span><span class=line><span class=cl><span class=s>alias mv=&#39;mv -i&#39;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># è§£å‹ä¸‡èƒ½å‡½æ•°
</span></span></span><span class=line><span class=cl><span class=s>extract() {
</span></span></span><span class=line><span class=cl><span class=s>    if [ -f $1 ]; then
</span></span></span><span class=line><span class=cl><span class=s>        case $1 in
</span></span></span><span class=line><span class=cl><span class=s>            *.tar.bz2) tar xjf $1 ;;
</span></span></span><span class=line><span class=cl><span class=s>            *.tar.gz)  tar xzf $1 ;;
</span></span></span><span class=line><span class=cl><span class=s>            *.bz2)     bunzip2 $1 ;;
</span></span></span><span class=line><span class=cl><span class=s>            *.rar)     unrar x $1 ;;
</span></span></span><span class=line><span class=cl><span class=s>            *.gz)      gunzip $1 ;;
</span></span></span><span class=line><span class=cl><span class=s>            *.tar)     tar xf $1 ;;
</span></span></span><span class=line><span class=cl><span class=s>            *.tbz2)    tar xjf $1 ;;
</span></span></span><span class=line><span class=cl><span class=s>            *.tgz)     tar xzf $1 ;;
</span></span></span><span class=line><span class=cl><span class=s>            *.zip)     unzip $1 ;;
</span></span></span><span class=line><span class=cl><span class=s>            *.Z)       uncompress $1 ;;
</span></span></span><span class=line><span class=cl><span class=s>            *.7z)      7z x $1 ;;
</span></span></span><span class=line><span class=cl><span class=s>            *)         echo &#34;&#39;$1&#39; cannot be extracted via extract()&#34; ;;
</span></span></span><span class=line><span class=cl><span class=s>        esac
</span></span></span><span class=line><span class=cl><span class=s>    else
</span></span></span><span class=line><span class=cl><span class=s>        echo &#34;&#39;$1&#39; is not a valid file&#34;
</span></span></span><span class=line><span class=cl><span class=s>    fi
</span></span></span><span class=line><span class=cl><span class=s>}
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># å¿«é€ŸSSH keyåˆ†å‘
</span></span></span><span class=line><span class=cl><span class=s>ssh-copy-id() {
</span></span></span><span class=line><span class=cl><span class=s>    if [ -z &#34;$1&#34; ]; then
</span></span></span><span class=line><span class=cl><span class=s>        echo &#34;Usage: ssh-copy-id user@host&#34;
</span></span></span><span class=line><span class=cl><span class=s>        return 1
</span></span></span><span class=line><span class=cl><span class=s>    fi
</span></span></span><span class=line><span class=cl><span class=s>    cat ~/.ssh/id_rsa.pub | ssh $1 &#34;mkdir -p ~/.ssh &amp;&amp; chmod 700 ~/.ssh &amp;&amp; cat &gt;&gt; ~/.ssh/authorized_keys &amp;&amp; chmod 600 ~/.ssh/authorized_keys&#34;
</span></span></span><span class=line><span class=cl><span class=s>}
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># å¤‡ä»½é…ç½®
</span></span></span><span class=line><span class=cl><span class=s>backup_cfg() {
</span></span></span><span class=line><span class=cl><span class=s>    local dest=&#34;/tmp/config_backup_$(date +%Y%m%d_%H%M%S).tar.gz&#34;
</span></span></span><span class=line><span class=cl><span class=s>    tar -czf $dest /etc/nginx /etc/httpd /etc/mysql /etc/redis /etc/sysconfig 2&gt;/dev/null
</span></span></span><span class=line><span class=cl><span class=s>    echo &#34;é…ç½®å·²å¤‡ä»½åˆ°: $dest&#34;
</span></span></span><span class=line><span class=cl><span class=s>}
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># åŠ è½½é…ç½®
</span></span></span><span class=line><span class=cl><span class=s>source ~/.bashrc
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=åäºŒåº”æ€¥å“åº”æ‰‹å†Œ>åäºŒã€åº”æ€¥å“åº”æ‰‹å†Œ</h2><h3 id=121-ç³»ç»Ÿè¢«å…¥ä¾µåº”æ€¥>12.1 ç³»ç»Ÿè¢«å…¥ä¾µåº”æ€¥</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1># incident_response.sh</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&gt;&gt;&gt; 1. éš”ç¦»ç½‘ç»œï¼ˆå¦‚å¿…è¦ï¼‰&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># iptables -A OUTPUT -j DROP</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&gt;&gt;&gt; 2. ä¿å­˜ç°åœº&#34;</span>
</span></span><span class=line><span class=cl>mkdir -p /tmp/incident_<span class=k>$(</span>date +%Y%m%d<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> /tmp/incident_<span class=k>$(</span>date +%Y%m%d<span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä¿å­˜è¿›ç¨‹ä¿¡æ¯</span>
</span></span><span class=line><span class=cl>ps aux &gt; ps.aux.txt
</span></span><span class=line><span class=cl>lsof &gt; lsof.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä¿å­˜ç½‘ç»œè¿æ¥</span>
</span></span><span class=line><span class=cl>ss -antp &gt; ss.antp.txt
</span></span><span class=line><span class=cl>netstat -tulpn &gt; netstat.tulpn.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä¿å­˜ç”¨æˆ·ä¿¡æ¯</span>
</span></span><span class=line><span class=cl>cat /etc/passwd &gt; passwd.txt
</span></span><span class=line><span class=cl>cat /etc/shadow &gt; shadow.txt
</span></span><span class=line><span class=cl>last &gt; last.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ä¿å­˜æ—¥å¿—</span>
</span></span><span class=line><span class=cl>cp /var/log/secure . 2&gt;/dev/null
</span></span><span class=line><span class=cl>cp /var/log/auth.log . 2&gt;/dev/null
</span></span><span class=line><span class=cl>cp /var/log/nginx/access.log . 2&gt;/dev/null
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&gt;&gt;&gt; 3. æŸ¥æ‰¾å¯ç–‘æ–‡ä»¶&#34;</span>
</span></span><span class=line><span class=cl>find /tmp /var/tmp -type f -executable -exec ls -lh <span class=o>{}</span> <span class=se>\;</span> &gt; suspicious_files.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&gt;&gt;&gt; 4. æŸ¥æ‰¾å¯ç–‘è¿›ç¨‹&#34;</span>
</span></span><span class=line><span class=cl>ps aux <span class=p>|</span> awk <span class=s1>&#39;$3 &gt; 50 {print $0}&#39;</span> &gt; high_cpu.txt
</span></span><span class=line><span class=cl>ps aux <span class=p>|</span> awk <span class=s1>&#39;$4 &gt; 10 {print $0}&#39;</span> &gt; high_mem.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&gt;&gt;&gt; 5. æŸ¥æ‰¾å¯ç–‘è¿æ¥&#34;</span>
</span></span><span class=line><span class=cl>ss -antp <span class=p>|</span> grep -v <span class=s1>&#39;127.0.0.1&#39;</span> &gt; suspicious_conn.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&gt;&gt;&gt; æ•°æ®å·²ä¿å­˜åˆ°: /tmp/incident_</span><span class=k>$(</span>date +%Y%m%d<span class=k>)</span><span class=s2>&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=122-ddosæ”»å‡»åº”å¯¹>12.2 DDoSæ”»å‡»åº”å¯¹</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># æŸ¥çœ‹SYNæ´ªæ°´</span>
</span></span><span class=line><span class=cl>netstat -n <span class=p>|</span> awk <span class=s1>&#39;/^tcp/ {++state[$6]} END {for(key in state) print key,state[key]}&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># é™åˆ¶SYN</span>
</span></span><span class=line><span class=cl>iptables -A INPUT -p tcp --syn -m limit --limit 1/s -j ACCEPT
</span></span><span class=line><span class=cl>iptables -A INPUT -p tcp --syn -j DROP
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å°ç¦IPï¼ˆä½¿ç”¨firewalldï¼‰</span>
</span></span><span class=line><span class=cl>firewall-cmd --permanent --add-rich-rule<span class=o>=</span><span class=s1>&#39;rule source address=&#34;192.168.1.100&#34; reject&#39;</span>
</span></span><span class=line><span class=cl>firewall-cmd --reload
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># å°ç¦IPï¼ˆä½¿ç”¨ufwï¼‰</span>
</span></span><span class=line><span class=cl>ufw deny from 192.168.1.100
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># CloudFlareæ¨¡å¼ï¼ˆè·å–çœŸå®IPï¼‰</span>
</span></span><span class=line><span class=cl><span class=c1># åœ¨nginxä¸­é…ç½®: set_real_ip_from 103.21.244.0/22;</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=åä¸‰æ—¥å¸¸å·¡æ£€è„šæœ¬>åä¸‰ã€æ—¥å¸¸å·¡æ£€è„šæœ¬</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat &gt; daily_check.sh <span class=s>&lt;&lt; &#39;EOF&#39;
</span></span></span><span class=line><span class=cl><span class=s>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=s>REPORT=&#34;/tmp/daily_report_$(hostname)_$(date +%Y%m%d).txt&#34;
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;===== ä¸»æœº: $(hostname) | æ—¶é—´: $(date) =====&#34; &gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&#34; &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;--- CPUè´Ÿè½½ ---&#34; &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>uptime &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&#34; &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;--- å†…å­˜ä½¿ç”¨ ---&#34; &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>free -h &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&#34; &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;--- ç£ç›˜ä½¿ç”¨ ---&#34; &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>df -hT &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&#34; &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;--- ç£ç›˜IO ---&#34; &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>iostat -x 1 5 &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&#34; &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;--- ç½‘ç»œè¿æ¥ ---&#34; &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>ss -ant | grep ESTAB | wc -l &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&#34; &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;--- ç›‘å¬ç«¯å£ ---&#34; &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>ss -tuln | grep LISTEN &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&#34; &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;--- ç™»å½•å¤±è´¥ ---&#34; &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>grep &#34;Failed password&#34; /var/log/secure 2&gt;/dev/null | tail -20 &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>grep &#34;Failed password&#34; /var/log/auth.log 2&gt;/dev/null | tail -20 &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&#34; &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;--- åƒµå°¸è¿›ç¨‹ ---&#34; &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>ps aux | awk &#39;$8~/Z/ {print $0}&#39; &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&#34; &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;--- æœåŠ¡çŠ¶æ€ ---&#34; &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>systemctl list-units --state=failed --no-pager &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;&#34; &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;--- æœ€è¿‘å˜æ›´ ---&#34; &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>find /etc /usr/local/bin -type f -mtime -1 2&gt;/dev/null | head -20 &gt;&gt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s>mail -s &#34;Daily Check Report: $(hostname)&#34; ops@company.com &lt; $REPORT
</span></span></span><span class=line><span class=cl><span class=s>echo &#34;æŠ¥å‘Šå·²å‘é€åˆ°é‚®ç®±&#34;
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>chmod +x daily_check.sh
</span></span><span class=line><span class=cl><span class=c1># åŠ å…¥crontab: 0 8 * * * /path/to/daily_check.sh</span>
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=-ä½¿ç”¨å»ºè®®>ğŸ¯ ä½¿ç”¨å»ºè®®</h2><ol><li><strong>æ–°æœåŠ¡å™¨åˆå§‹åŒ–</strong>ï¼šè¿è¡Œå¯¹åº”ç³»ç»Ÿçš„ä¸€é”®å®‰è£…è„šæœ¬</li><li><strong>ä¸ªäººç¯å¢ƒé…ç½®</strong>ï¼šå¤åˆ¶æ‰€æœ‰é…ç½®æ–‡ä»¶ï¼ˆ<code>.vimrc</code>, <code>.bashrc</code>, <code>.tmux.conf</code>ï¼‰</li><li><strong>æ—¥å¸¸å·¡æ£€</strong>ï¼šéƒ¨ç½²daily_check.shåˆ°æ‰€æœ‰æœåŠ¡å™¨</li><li><strong>åº”æ€¥å“åº”</strong>ï¼šå‡†å¤‡å¥½incident_response.shï¼Œéšæ—¶å¯ç”¨</li><li><strong>æŒç»­å­¦ä¹ </strong>ï¼šæ¯å‘¨å°è¯•ä¸€ä¸ªæ–°å·¥å…·ï¼Œé€æ­¥æ›¿æ¢ä½æ•ˆæ“ä½œ</li></ol><p><strong>å®Œæ•´é…ç½®å·²å°±ç»ªï¼Œç›´æ¥å¤åˆ¶ä½¿ç”¨å³å¯ï¼ç¥è¿ç»´å·¥ä½œé¡ºåˆ©ï¼</strong></p></section><footer class=article-footer><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>æœ¬æ–‡é‡‡ç”¨ CC BY-NC-SA 4.0 è®¸å¯åè®®</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article><a href=/posts/vim/><div class=article-details><h2 class=article-title>Vim</h2></div></a></article><article><a href=/posts/win-r/><div class=article-details><h2 class=article-title>win+R</h2></div></a></article><article><a href=/posts/windows/><div class=article-details><h2 class=article-title>windows</h2></div></a></article><article><a href=/posts/k8s/><div class=article-details><h2 class=article-title>K8s</h2></div></a></article><article><a href=/posts/mysql/><div class=article-details><h2 class=article-title>MySQL</h2></div></a></article></div></div></aside><script src=https://giscus.app/client.js data-repo data-repo-id data-category data-category-id data-mapping=title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=en data-loading crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark_dimmed")}})()</script><footer class=site-footer><section class=copyright>&copy;
2025 Â© 2025 win. ä¿ç•™æ‰€æœ‰æƒåˆ©.</section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.31.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>