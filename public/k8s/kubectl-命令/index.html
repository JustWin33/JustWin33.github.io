<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Kubectl 命令 kubectl 是 Kubernetes 的命令行工具，用于管理集群和部署应用。本文档提供每个命令的详细解释、参数含义及使用场景。\n基本语法 1 kubectl [command] [TYPE] [NAME] [flags] command：操作动作（如 get、create、delete） TYPE：资源类型（如 pods、services） NAME：资源名称 flags：可选参数 一、集群信息查看（了解集群整体状况） 1 2 # 查看集群基本信息 kubectl cluster-info 作用：显示 Kubernetes 集群的核心组件访问地址（API Server、DNS、Dashboard等） 场景：初次连接集群或排查集群连接问题时使用 输出示例：Kubernetes master is running at https://xxx:6443 1 2 3 # 查看节点状态 kubectl get nodes kubectl get nodes -o wide 作用：列出集群中所有节点（Node/Worker）的基本信息（状态、版本、运行时间） 场景：检查节点是否正常运行 参数说明：-o wide 会额外显示节点的 INTERNAL-IP、OS-IMAGE 等详细信息 1 2 # 查看集群组件状态 kubectl get componentstatuses 作用：检查核心控制平面组件（etcd、scheduler、controller-manager）的健康状态 场景：集群级别故障排查时使用 别名：可简写为 kubectl get cs 1 2 # 查看 API 资源类型 kubectl api-resources 作用：列出当前集群支持的所有资源类型（如 pods、services、deployments等） 场景：记不清资源类型名称或想确认某个资源是否支持时使用 1 2 # 查看 Kubernetes 版本 kubectl version 作用：显示客户端（kubectl）和服务器端（API Server）的版本信息 场景：确认版本兼容性，排查版本相关的问题 二、资源查看命令（日常最常用） 1 2 # 查看所有 Pod kubectl get pods 作用：列出当前命名空间下的所有 Pod（容器组） 场景：查看应用运行状态、定位问题 Pod 1 2 3 kubectl get pods --all-namespaces # 或简写 kubectl get pods -A 作用：查看集群中所有命名空间的 Pod（系统 Pod + 用户 Pod） 场景：排查跨命名空间的问题，查看系统组件状态 1 2 # 查看特定命名空间的资源 kubectl get pods -n kube-system 作用：查看指定命名空间（这里是 kube-system 系统空间）的 Pod 参数说明：-n 是 --namespace 的简写 1 2 # 查看多种资源 kubectl get pods,svc,deploy 作用：一次性查看 Pod、Service、Deployment 三种资源 语法：资源类型用逗号分隔，可一次性查看多种 1 2 # 查看资源详情 kubectl describe pod <pod-name> 作用：显示指定 Pod 的详细配置和事件信息（比 get 命令更详细） 内容包含：Pod IP、节点、标签、事件日志（Events）、容器状态等 场景：Pod 启动失败、一直 Pending 时排查原因 1 2 # 查看资源 YAML 配置 kubectl get pod <pod-name> -o yaml 作用：以 YAML 格式导出资源的完整配置（包括系统添加的默认字段） 参数说明：-o yaml 指定输出格式为 YAML（也可 -o json） 场景：学习资源配置结构、备份配置、调试时使用 1 2 # 实时监视资源变化 kubectl get pods -w 作用：持续监控 Pod 状态变化，有新变化会自动刷新显示 参数说明：-w 是 --watch 的简写 场景：观察滚动更新过程、监控 Pod 重启情况 1 2 # 按标签筛选 kubectl get pods -l app=nginx 作用：只显示带有 app=nginx 标签的 Pod 参数说明：-l 是 --selector 的简写，支持标签选择器 场景：在复杂系统中快速筛选出相关资源 1 2 # 查看资源排序显示 kubectl get pods --sort-by=.status.startTime 作用：按 Pod 启动时间排序显示 参数说明：--sort-by 支持 JSONPath 表达式 场景：找出最新启动或最老的 Pod 三、资源创建与删除（管理资源生命周期） 1 2 # 从 YAML 文件创建/更新资源 kubectl apply -f deployment.yaml 作用：根据 YAML 文件声明式创建或更新资源（推荐方式） 特点：文件存在则更新，不存在则创建（幂等性） 场景：应用部署、配置更新 1 kubectl create -f service.yaml 作用：从 YAML 文件创建资源（命令式） 特点：资源已存在会报错，不适合更新 场景：首次创建资源 1 2 # 创建命名空间 kubectl create namespace <namespace-name> 作用：创建逻辑隔离的命名空间 场景：按项目/环境隔离资源（如 dev、test、prod） 1 2 # 从镜像直接创建 Deployment kubectl create deployment nginx --image=nginx:latest 作用：快速创建一个运行 nginx 镜像的 Deployment 场景：快速测试、临时部署 1 2 # 删除资源 kubectl delete -f deployment.yaml 作用：根据 YAML 文件删除其中定义的资源 场景：清理通过文件创建的资源 1 kubectl delete pod <pod-name> 作用：删除指定名称的 Pod 注意：如果是 Deployment 管理的 Pod，会立即被重建 1 2 # 按标签删除 kubectl delete pods -l app=nginx 作用：删除所有带有 app=nginx 标签的 Pod 场景：批量清理测试资源 1 2 # 强制删除（立即） kubectl delete pod <pod-name> --grace-period=0 --force 参数说明： --grace-period=0：立即删除，不等待优雅终止（默认30秒） --force：强制删除，用于某些卡住无法删除的 Pod 警告：可能导致数据丢失，慎用！ 1 2 # 清空命名空间所有资源 kubectl delete all --all -n <namespace-name> 作用：删除命名空间内所有类型资源（all 包括 pod、svc、deploy等） 参数说明：第一个 --all 指所有资源类型，第二个 --all 指所有实例 危险操作：会清空整个命名空间！ 四、Pod 操作（深入容器内部） 1 2 # 查看 Pod 日志 kubectl logs <pod-name> 作用：查看 Pod 中主容器的标准输出日志 场景：应用报错排查 1 kubectl logs -f <pod-name> 参数说明：-f 是 --follow 的简写，实时跟踪新日志 场景：观察应用实时运行状态 1 kubectl logs --tail=20 <pod-name> 参数说明：--tail 只显示最后 N 行日志 场景：日志太多时只看最近的错误 1 kubectl logs <pod-name> -c <container-name> 参数说明：-c 指定容器名称（多容器 Pod 必须指定） 场景：Pod 内有多个容器时，查看特定容器日志 1 2 # 进入 Pod 容器（交互式） kubectl exec -it <pod-name> -- /bin/bash 作用：进入 Pod 容器的命令行终端 参数说明： -i：保持标准输入打开 -t：分配一个伪终端 --：分隔符，后面是容器内要执行的命令 场景：调试应用、手动检查配置文件 1 kubectl exec -it <pod-name> -c <container-name> -- sh 作用：多容器 Pod 中进入指定容器（使用 sh shell） 注意：某些轻量镜像可能没有 bash，只有 sh 1 2 # 在 Pod 中执行一次性命令 kubectl exec <pod-name> -- ls / 作用：在 Pod 中执行命令并返回结果，不进入交互模式 场景：快速查看目录、执行简单命令 1 2 # 复制文件到/从 Pod kubectl cp <pod-name>:/path/to/file /local/path 作用：从 Pod 容器复制文件到本地 语法：pod-name:容器路径 → 本地路径 场景：导出日志、备份容器内文件 1 kubectl cp /local/file <pod-name>:/path/to/file 作用：从本地上传文件到 Pod 容器 场景：向容器内传配置文件、测试脚本 1 2 # 端口转发到本地 kubectl port-forward <pod-name> 8080:80 作用：将本地 8080 端口转发到 Pod 的 80 端口 场景：在本地调试集群内的服务，绕过 Service 直接访问 Pod 1 kubectl port-forward svc/<service-name> 3000:80 作用：将本地 3000 端口转发到 Service 的 80 端口 场景：本地访问集群内的 Service 1 2 # 查看 Pod 资源使用（需安装 metrics-server） kubectl top pods 作用：显示 Pod 的 CPU 和内存使用量 前提：集群必须安装 metrics-server 组件 场景：监控资源消耗，定位资源瓶颈 1 kubectl top pods --containers 参数说明：--containers 显示容器级别的资源使用 场景：Pod 内多容器时，分析哪个容器占用资源最多 五、Deployment 操作（管理应用版本） 1 2 # 查看 Deployment kubectl get deployments 作用：列出当前命名空间的 Deployment（部署控制器） 场景：查看应用部署状态、副本数 1 2 # 查看滚动更新状态 kubectl rollout status deployment/<deployment-name> 作用：实时监控 Deployment 滚动更新的进度 场景：发布新版本时观察是否成功 1 2 # 更新镜像版本 kubectl set image deployment/nginx nginx=nginx:1.20 作用：不修改 YAML 文件，直接更新 Deployment 中容器的镜像版本 语法：deployment/名称 容器名=新镜像 场景：快速回滚或升级镜像 1 2 # 扩缩容（调整副本数） kubectl scale deployment/nginx --replicas=5 作用：将 nginx deployment 的副本数调整为 5 个 场景：应对流量高峰、弹性伸缩 1 2 # 回滚到上一个版本 kubectl rollout undo deployment/<deployment-name> 作用：一键回滚到上一个稳定版本 场景：新版本发布失败时快速恢复 1 2 # 回滚到指定版本 kubectl rollout undo deployment/<deployment-name> --to-revision=2 参数说明：--to-revision 指定回滚到的历史版本号 场景：需要回滚到特定历史版本 1 2 # 查看历史版本 kubectl rollout history deployment/<deployment-name> 作用：显示 Deployment 的所有历史版本记录 场景：查看可回滚的版本列表，确认版本号 1 2 # 暂停/恢复滚动更新 kubectl rollout pause deployment/<deployment-name> 作用：暂停滚动更新（只更新部分 Pod 后停止） 场景：金丝雀发布，先更新一小部分观察效果 1 kubectl rollout resume deployment/<deployment-name> 作用：恢复暂停的滚动更新 场景：金丝雀验证通过后继续更新剩余 Pod 1 2 # 编辑 Deployment kubectl edit deployment <deployment-name> 作用：打开默认编辑器（通常是 vim）直接修改 Deployment 配置 特点：修改后立即生效，无需重新 apply 场景：紧急修改配置，快速调试 六、Service 操作（管理网络访问） 1 2 3 4 # 查看 Service kubectl get services # 或简写 kubectl get svc 作用：列出当前命名空间的 Service（服务） 场景：查看服务暴露的端口、类型、ClusterIP 1 2 # 查看 Service 详情 kubectl describe svc <service-name> 作用：显示 Service 的详细信息，包括后端端点（Endpoints） 场景：Service 无法访问时，检查是否关联了正确的 Pod 1 2 # 暴露 Deployment 为 Service kubectl expose deployment/nginx --type=NodePort --port=80 作用：为 nginx deployment 创建 Service，类型为 NodePort 参数说明： --type：Service 类型（ClusterIP/NodePort/LoadBalancer） --port：Service 暴露的端口 场景：快速让外部访问集群内的应用 1 2 # 创建 Service 并指定目标端口 kubectl expose deployment/nginx --type=LoadBalancer --port=80 --target-port=8080 参数说明：--target-port 是 Pod 内容器监听的端口 场景：容器内应用监听在 8080，但外部希望用 80 端口访问 1 2 # 查看 Service 后端端点 kubectl get endpoints <service-name> 作用：显示 Service 关联的后端 Pod IP 和端口 场景：验证 Service 是否正确路由到 Pod 七、配置与上下文管理（多集群切换） 1 2 # 查看 kubeconfig 完整配置 kubectl config view 作用：显示 kubectl 的配置文件（~/.kube/config）内容 场景：确认当前使用的集群、用户、上下文信息 1 2 # 查看当前上下文 kubectl config current-context 作用：显示当前正在使用的上下文名称（cluster + user + namespace 的组合） 场景：确认当前操作的集群，避免误操作 1 2 # 列出所有可用上下文 kubectl config get-contexts 作用：显示配置文件中定义的所有上下文列表 场景：在多集群环境中切换前查看可用选项 1 2 # 切换上下文（切换集群/用户） kubectl config use-context <context-name> 作用：切换到指定的上下文（快速切换集群） 场景：管理多个 K8s 集群时切换操作目标 1 2 # 添加集群配置 kubectl config set-cluster <cluster-name> --server=<server-url> 作用：向配置文件中添加新集群的访问地址 参数说明：--server 指定 API Server 地址 场景：手动配置新集群连接信息 1 2 # 添加用户凭证 kubectl config set-credentials <user-name> --token=<token> 作用：为指定用户设置访问凭证（Token 方式） 场景：配置不同用户的访问权限 1 2 # 设置上下文 kubectl config set-context <context-name> --cluster=<cluster-name> --user=<user-name> 作用：创建上下文，关联集群、用户和命名空间 场景：配置多集群、多用户、多环境的组合 1 2 # 删除上下文 kubectl config delete-context <context-name> 作用：从配置文件中删除指定的上下文 场景：清理无效的集群配置 1 2 # 设置默认命名空间 kubectl config set-context --current --namespace=<namespace-name> 参数说明：--current 修改当前上下文，--namespace 设置默认命名空间 效果：后续命令无需每次都指定 -n 参数 场景：长期在特定命名空间工作时提高效率 八、调试与故障排查（问题定位） 1 2 # 查看事件（重要！） kubectl get events 作用：查看集群中最近发生的事件（如 Pod 调度、启动、错误等） 场景：Pod 启动失败、调度失败时查看详细原因 1 kubectl get events --sort-by=.lastTimestamp 参数说明：按最后发生时间排序，最新事件在最后 场景：事件太多时，按时间顺序查看 1 2 # 查看 API Server 请求（调试） kubectl get pods -v=6 参数说明：-v 设置日志级别（0-9），数字越大越详细 场景：调试 kubectl 本身的问题，查看底层 API 调用 1 2 3 # 查看资源使用情况 kubectl top nodes kubectl top pods 作用：显示节点和 Pod 的实时资源使用 场景：集群资源不足、Pod 被 OOMKilled 时排查 1 2 # 权限检查（重要！） kubectl auth can-i create pods 作用：检查当前用户是否有创建 Pod 的权限 场景：权限不足报错时，确认自己的权限范围 1 kubectl auth can-i &#34;*&#34; &#34;*&#34; --all-namespaces 作用：检查当前用户在所有命名空间的所有权限 参数说明：&#34;*&#34; 代表所有 verb 和所有 resource 场景：全面了解自己的权限 1 2 # 启动临时调试 Pod kubectl run debug-pod --rm -i --tty --image=busybox -- sh 参数说明： --rm：退出后自动删除 Pod -i --tty：交互式终端 --image：使用轻量级镜像 -- 后面是启动命令 场景：集群内网络测试、临时工具使用 1 2 # 查看网络策略 kubectl get networkpolicies 作用：查看当前命名空间的网络策略 场景：网络不通时检查是否有网络策略限制 九、高级命令（高效技巧） 1 2 # 合并多个 kubeconfig 文件 KUBECONFIG=file1:file2:file3 kubectl config view --merge --flatten > ~/.kube/config 作用：将多个 kubeconfig 文件合并为一个 环境变量：KUBECONFIG 用冒号分隔多个文件路径 参数说明：--merge 合并，--flatten 扁平化输出 场景：管理多个集群的配置整合 1 2 # 生成 YAML 模板（不实际创建） kubectl run nginx --image=nginx --dry-run=client -o yaml > pod.yaml 作用：生成资源配置的 YAML 模板，但不真正创建资源 参数说明： --dry-run=client：客户端试运行（不发送到 API Server） -o yaml：输出 YAML 格式 场景：快速生成模板，再手动修改 1 2 # 标签操作 kubectl label pods <pod-name> env=prod 作用：给 Pod 添加标签 env=prod 场景：资源分类、标记环境、配合选择器使用 1 kubectl label pods <pod-name> env- 语法：标签名后加 - 表示删除该标签 场景：清理不再需要的标签 1 2 # 注解操作 kubectl annotate pods <pod-name> description=&#34;My pod&#34; 作用：添加注解（Annotation），用于存储非标识性元数据 场景：记录资源说明、配置信息（对人可读） 1 2 # 查看资源配额 kubectl get resourcequota -n <namespace> 作用：查看命名空间的资源配额限制（CPU、内存、Pod 数量等） 场景：资源不足时，检查是否触发了配额限制 1 2 # 查看持久卷 kubectl get pv 作用：查看集群级别的持久卷（PersistentVolume） 场景：存储管理、排查存储问题 1 kubectl get pvc -n <namespace> 作用：查看命名空间的持久卷声明（PersistentVolumeClaim） 场景：应用申请存储后查看绑定状态 1 2 3 # 查看 ConfigMap 和 Secret kubectl get configmaps kubectl get secrets 作用：查看配置信息和敏感信息 场景：检查应用配置、验证 Secret 是否存在 1 2 # 查看 Secret 内容（解码） kubectl get secret <secret-name> -o jsonpath=&#34;{.data.password}&#34; | base64 -d 作用：Secret 的值是 base64 编码的，需要解码查看明文 参数说明：jsonpath 提取特定字段 场景：查看数据库密码、Token 等敏感信息 十、常用选项速记（命令行参数） 选项 全称 含义与用途 -n --namespace 指定命名空间，隔离资源范围 -A --all-namespaces 查看所有命名空间，跨空间操作 -o wide --output wide 显示额外信息（如节点 IP、Pod IP） -o yaml/json --output 输出完整配置，用于导出或调试 -l --selector 按标签筛选资源，精准定位 --show-labels &ndash; 显示资源的标签列 --sort-by &ndash; 按字段排序，整理输出结果 -w --watch 实时监控，观察变化 --dry-run=client &ndash; 试运行，验证配置但不执行 --grace-period=0 &ndash; 立即删除，不等待优雅终止 实用技巧详解 1. 命令补全（节省打字时间） 1 2 3 # Bash 环境 echo 'source <(kubectl completion bash)' >> ~/.bashrc source ~/.bashrc 作用：输入 kubectl get p 后按 Tab 自动补全为 pods 生效：重新加载 bash 配置或重启终端 1 2 # Zsh 环境 echo 'source <(kubectl completion zsh)' >> ~/.zshrc 作用：Zsh 用户同样享受自动补全 2. 常用别名（极致偷懒） 1 2 3 4 5 6 7 alias k='kubectl' alias kg='kubectl get' alias kgp='kubectl get pods' alias kgs='kubectl get svc' alias kgd='kubectl get deploy' alias ke='kubectl exec -it' alias kl='kubectl logs' 作用：将长命令缩短为 2-3 个字母 配置：添加到 ~/.bashrc 或 ~/.zshrc 3. 快速删除 Evicted Pods（清理僵尸） 1 kubectl get pods | grep Evicted | awk '{print $1}' | xargs kubectl delete pod 执行过程： kubectl get pods：获取所有 Pod grep Evicted：筛选状态为 Evicted 的 awk '{print $1}'：提取 Pod 名称（第一列） xargs kubectl delete pod：批量删除这些 Pod 场景：节点资源不足时，大量 Pod 被驱逐，清理残留记录 4. 清空命名空间（极度危险！） 1 kubectl delete all --all -n <namespace> 执行逻辑：删除指定命名空间内 all 资源类型的 all 实例 会删除：Pod、Service、Deployment、StatefulSet 等 不会删除：命名空间本身、ConfigMap、Secret（需单独删） 替代方案：直接删除命名空间更彻底 1 kubectl delete namespace <namespace-name> 文档说明：本指南基于 Kubernetes 2024 年版本整理，建议根据实际集群版本使用 kubectl --help 查看最新参数。\n"><title>kubectl命令</title><link rel=canonical href=http://localhost:1313/k8s/kubectl-%E5%91%BD%E4%BB%A4/><link rel=stylesheet href=/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css><meta property='og:title' content="kubectl命令"><meta property='og:description' content="Kubectl 命令 kubectl 是 Kubernetes 的命令行工具，用于管理集群和部署应用。本文档提供每个命令的详细解释、参数含义及使用场景。\n基本语法 1 kubectl [command] [TYPE] [NAME] [flags] command：操作动作（如 get、create、delete） TYPE：资源类型（如 pods、services） NAME：资源名称 flags：可选参数 一、集群信息查看（了解集群整体状况） 1 2 # 查看集群基本信息 kubectl cluster-info 作用：显示 Kubernetes 集群的核心组件访问地址（API Server、DNS、Dashboard等） 场景：初次连接集群或排查集群连接问题时使用 输出示例：Kubernetes master is running at https://xxx:6443 1 2 3 # 查看节点状态 kubectl get nodes kubectl get nodes -o wide 作用：列出集群中所有节点（Node/Worker）的基本信息（状态、版本、运行时间） 场景：检查节点是否正常运行 参数说明：-o wide 会额外显示节点的 INTERNAL-IP、OS-IMAGE 等详细信息 1 2 # 查看集群组件状态 kubectl get componentstatuses 作用：检查核心控制平面组件（etcd、scheduler、controller-manager）的健康状态 场景：集群级别故障排查时使用 别名：可简写为 kubectl get cs 1 2 # 查看 API 资源类型 kubectl api-resources 作用：列出当前集群支持的所有资源类型（如 pods、services、deployments等） 场景：记不清资源类型名称或想确认某个资源是否支持时使用 1 2 # 查看 Kubernetes 版本 kubectl version 作用：显示客户端（kubectl）和服务器端（API Server）的版本信息 场景：确认版本兼容性，排查版本相关的问题 二、资源查看命令（日常最常用） 1 2 # 查看所有 Pod kubectl get pods 作用：列出当前命名空间下的所有 Pod（容器组） 场景：查看应用运行状态、定位问题 Pod 1 2 3 kubectl get pods --all-namespaces # 或简写 kubectl get pods -A 作用：查看集群中所有命名空间的 Pod（系统 Pod + 用户 Pod） 场景：排查跨命名空间的问题，查看系统组件状态 1 2 # 查看特定命名空间的资源 kubectl get pods -n kube-system 作用：查看指定命名空间（这里是 kube-system 系统空间）的 Pod 参数说明：-n 是 --namespace 的简写 1 2 # 查看多种资源 kubectl get pods,svc,deploy 作用：一次性查看 Pod、Service、Deployment 三种资源 语法：资源类型用逗号分隔，可一次性查看多种 1 2 # 查看资源详情 kubectl describe pod <pod-name> 作用：显示指定 Pod 的详细配置和事件信息（比 get 命令更详细） 内容包含：Pod IP、节点、标签、事件日志（Events）、容器状态等 场景：Pod 启动失败、一直 Pending 时排查原因 1 2 # 查看资源 YAML 配置 kubectl get pod <pod-name> -o yaml 作用：以 YAML 格式导出资源的完整配置（包括系统添加的默认字段） 参数说明：-o yaml 指定输出格式为 YAML（也可 -o json） 场景：学习资源配置结构、备份配置、调试时使用 1 2 # 实时监视资源变化 kubectl get pods -w 作用：持续监控 Pod 状态变化，有新变化会自动刷新显示 参数说明：-w 是 --watch 的简写 场景：观察滚动更新过程、监控 Pod 重启情况 1 2 # 按标签筛选 kubectl get pods -l app=nginx 作用：只显示带有 app=nginx 标签的 Pod 参数说明：-l 是 --selector 的简写，支持标签选择器 场景：在复杂系统中快速筛选出相关资源 1 2 # 查看资源排序显示 kubectl get pods --sort-by=.status.startTime 作用：按 Pod 启动时间排序显示 参数说明：--sort-by 支持 JSONPath 表达式 场景：找出最新启动或最老的 Pod 三、资源创建与删除（管理资源生命周期） 1 2 # 从 YAML 文件创建/更新资源 kubectl apply -f deployment.yaml 作用：根据 YAML 文件声明式创建或更新资源（推荐方式） 特点：文件存在则更新，不存在则创建（幂等性） 场景：应用部署、配置更新 1 kubectl create -f service.yaml 作用：从 YAML 文件创建资源（命令式） 特点：资源已存在会报错，不适合更新 场景：首次创建资源 1 2 # 创建命名空间 kubectl create namespace <namespace-name> 作用：创建逻辑隔离的命名空间 场景：按项目/环境隔离资源（如 dev、test、prod） 1 2 # 从镜像直接创建 Deployment kubectl create deployment nginx --image=nginx:latest 作用：快速创建一个运行 nginx 镜像的 Deployment 场景：快速测试、临时部署 1 2 # 删除资源 kubectl delete -f deployment.yaml 作用：根据 YAML 文件删除其中定义的资源 场景：清理通过文件创建的资源 1 kubectl delete pod <pod-name> 作用：删除指定名称的 Pod 注意：如果是 Deployment 管理的 Pod，会立即被重建 1 2 # 按标签删除 kubectl delete pods -l app=nginx 作用：删除所有带有 app=nginx 标签的 Pod 场景：批量清理测试资源 1 2 # 强制删除（立即） kubectl delete pod <pod-name> --grace-period=0 --force 参数说明： --grace-period=0：立即删除，不等待优雅终止（默认30秒） --force：强制删除，用于某些卡住无法删除的 Pod 警告：可能导致数据丢失，慎用！ 1 2 # 清空命名空间所有资源 kubectl delete all --all -n <namespace-name> 作用：删除命名空间内所有类型资源（all 包括 pod、svc、deploy等） 参数说明：第一个 --all 指所有资源类型，第二个 --all 指所有实例 危险操作：会清空整个命名空间！ 四、Pod 操作（深入容器内部） 1 2 # 查看 Pod 日志 kubectl logs <pod-name> 作用：查看 Pod 中主容器的标准输出日志 场景：应用报错排查 1 kubectl logs -f <pod-name> 参数说明：-f 是 --follow 的简写，实时跟踪新日志 场景：观察应用实时运行状态 1 kubectl logs --tail=20 <pod-name> 参数说明：--tail 只显示最后 N 行日志 场景：日志太多时只看最近的错误 1 kubectl logs <pod-name> -c <container-name> 参数说明：-c 指定容器名称（多容器 Pod 必须指定） 场景：Pod 内有多个容器时，查看特定容器日志 1 2 # 进入 Pod 容器（交互式） kubectl exec -it <pod-name> -- /bin/bash 作用：进入 Pod 容器的命令行终端 参数说明： -i：保持标准输入打开 -t：分配一个伪终端 --：分隔符，后面是容器内要执行的命令 场景：调试应用、手动检查配置文件 1 kubectl exec -it <pod-name> -c <container-name> -- sh 作用：多容器 Pod 中进入指定容器（使用 sh shell） 注意：某些轻量镜像可能没有 bash，只有 sh 1 2 # 在 Pod 中执行一次性命令 kubectl exec <pod-name> -- ls / 作用：在 Pod 中执行命令并返回结果，不进入交互模式 场景：快速查看目录、执行简单命令 1 2 # 复制文件到/从 Pod kubectl cp <pod-name>:/path/to/file /local/path 作用：从 Pod 容器复制文件到本地 语法：pod-name:容器路径 → 本地路径 场景：导出日志、备份容器内文件 1 kubectl cp /local/file <pod-name>:/path/to/file 作用：从本地上传文件到 Pod 容器 场景：向容器内传配置文件、测试脚本 1 2 # 端口转发到本地 kubectl port-forward <pod-name> 8080:80 作用：将本地 8080 端口转发到 Pod 的 80 端口 场景：在本地调试集群内的服务，绕过 Service 直接访问 Pod 1 kubectl port-forward svc/<service-name> 3000:80 作用：将本地 3000 端口转发到 Service 的 80 端口 场景：本地访问集群内的 Service 1 2 # 查看 Pod 资源使用（需安装 metrics-server） kubectl top pods 作用：显示 Pod 的 CPU 和内存使用量 前提：集群必须安装 metrics-server 组件 场景：监控资源消耗，定位资源瓶颈 1 kubectl top pods --containers 参数说明：--containers 显示容器级别的资源使用 场景：Pod 内多容器时，分析哪个容器占用资源最多 五、Deployment 操作（管理应用版本） 1 2 # 查看 Deployment kubectl get deployments 作用：列出当前命名空间的 Deployment（部署控制器） 场景：查看应用部署状态、副本数 1 2 # 查看滚动更新状态 kubectl rollout status deployment/<deployment-name> 作用：实时监控 Deployment 滚动更新的进度 场景：发布新版本时观察是否成功 1 2 # 更新镜像版本 kubectl set image deployment/nginx nginx=nginx:1.20 作用：不修改 YAML 文件，直接更新 Deployment 中容器的镜像版本 语法：deployment/名称 容器名=新镜像 场景：快速回滚或升级镜像 1 2 # 扩缩容（调整副本数） kubectl scale deployment/nginx --replicas=5 作用：将 nginx deployment 的副本数调整为 5 个 场景：应对流量高峰、弹性伸缩 1 2 # 回滚到上一个版本 kubectl rollout undo deployment/<deployment-name> 作用：一键回滚到上一个稳定版本 场景：新版本发布失败时快速恢复 1 2 # 回滚到指定版本 kubectl rollout undo deployment/<deployment-name> --to-revision=2 参数说明：--to-revision 指定回滚到的历史版本号 场景：需要回滚到特定历史版本 1 2 # 查看历史版本 kubectl rollout history deployment/<deployment-name> 作用：显示 Deployment 的所有历史版本记录 场景：查看可回滚的版本列表，确认版本号 1 2 # 暂停/恢复滚动更新 kubectl rollout pause deployment/<deployment-name> 作用：暂停滚动更新（只更新部分 Pod 后停止） 场景：金丝雀发布，先更新一小部分观察效果 1 kubectl rollout resume deployment/<deployment-name> 作用：恢复暂停的滚动更新 场景：金丝雀验证通过后继续更新剩余 Pod 1 2 # 编辑 Deployment kubectl edit deployment <deployment-name> 作用：打开默认编辑器（通常是 vim）直接修改 Deployment 配置 特点：修改后立即生效，无需重新 apply 场景：紧急修改配置，快速调试 六、Service 操作（管理网络访问） 1 2 3 4 # 查看 Service kubectl get services # 或简写 kubectl get svc 作用：列出当前命名空间的 Service（服务） 场景：查看服务暴露的端口、类型、ClusterIP 1 2 # 查看 Service 详情 kubectl describe svc <service-name> 作用：显示 Service 的详细信息，包括后端端点（Endpoints） 场景：Service 无法访问时，检查是否关联了正确的 Pod 1 2 # 暴露 Deployment 为 Service kubectl expose deployment/nginx --type=NodePort --port=80 作用：为 nginx deployment 创建 Service，类型为 NodePort 参数说明： --type：Service 类型（ClusterIP/NodePort/LoadBalancer） --port：Service 暴露的端口 场景：快速让外部访问集群内的应用 1 2 # 创建 Service 并指定目标端口 kubectl expose deployment/nginx --type=LoadBalancer --port=80 --target-port=8080 参数说明：--target-port 是 Pod 内容器监听的端口 场景：容器内应用监听在 8080，但外部希望用 80 端口访问 1 2 # 查看 Service 后端端点 kubectl get endpoints <service-name> 作用：显示 Service 关联的后端 Pod IP 和端口 场景：验证 Service 是否正确路由到 Pod 七、配置与上下文管理（多集群切换） 1 2 # 查看 kubeconfig 完整配置 kubectl config view 作用：显示 kubectl 的配置文件（~/.kube/config）内容 场景：确认当前使用的集群、用户、上下文信息 1 2 # 查看当前上下文 kubectl config current-context 作用：显示当前正在使用的上下文名称（cluster + user + namespace 的组合） 场景：确认当前操作的集群，避免误操作 1 2 # 列出所有可用上下文 kubectl config get-contexts 作用：显示配置文件中定义的所有上下文列表 场景：在多集群环境中切换前查看可用选项 1 2 # 切换上下文（切换集群/用户） kubectl config use-context <context-name> 作用：切换到指定的上下文（快速切换集群） 场景：管理多个 K8s 集群时切换操作目标 1 2 # 添加集群配置 kubectl config set-cluster <cluster-name> --server=<server-url> 作用：向配置文件中添加新集群的访问地址 参数说明：--server 指定 API Server 地址 场景：手动配置新集群连接信息 1 2 # 添加用户凭证 kubectl config set-credentials <user-name> --token=<token> 作用：为指定用户设置访问凭证（Token 方式） 场景：配置不同用户的访问权限 1 2 # 设置上下文 kubectl config set-context <context-name> --cluster=<cluster-name> --user=<user-name> 作用：创建上下文，关联集群、用户和命名空间 场景：配置多集群、多用户、多环境的组合 1 2 # 删除上下文 kubectl config delete-context <context-name> 作用：从配置文件中删除指定的上下文 场景：清理无效的集群配置 1 2 # 设置默认命名空间 kubectl config set-context --current --namespace=<namespace-name> 参数说明：--current 修改当前上下文，--namespace 设置默认命名空间 效果：后续命令无需每次都指定 -n 参数 场景：长期在特定命名空间工作时提高效率 八、调试与故障排查（问题定位） 1 2 # 查看事件（重要！） kubectl get events 作用：查看集群中最近发生的事件（如 Pod 调度、启动、错误等） 场景：Pod 启动失败、调度失败时查看详细原因 1 kubectl get events --sort-by=.lastTimestamp 参数说明：按最后发生时间排序，最新事件在最后 场景：事件太多时，按时间顺序查看 1 2 # 查看 API Server 请求（调试） kubectl get pods -v=6 参数说明：-v 设置日志级别（0-9），数字越大越详细 场景：调试 kubectl 本身的问题，查看底层 API 调用 1 2 3 # 查看资源使用情况 kubectl top nodes kubectl top pods 作用：显示节点和 Pod 的实时资源使用 场景：集群资源不足、Pod 被 OOMKilled 时排查 1 2 # 权限检查（重要！） kubectl auth can-i create pods 作用：检查当前用户是否有创建 Pod 的权限 场景：权限不足报错时，确认自己的权限范围 1 kubectl auth can-i &#34;*&#34; &#34;*&#34; --all-namespaces 作用：检查当前用户在所有命名空间的所有权限 参数说明：&#34;*&#34; 代表所有 verb 和所有 resource 场景：全面了解自己的权限 1 2 # 启动临时调试 Pod kubectl run debug-pod --rm -i --tty --image=busybox -- sh 参数说明： --rm：退出后自动删除 Pod -i --tty：交互式终端 --image：使用轻量级镜像 -- 后面是启动命令 场景：集群内网络测试、临时工具使用 1 2 # 查看网络策略 kubectl get networkpolicies 作用：查看当前命名空间的网络策略 场景：网络不通时检查是否有网络策略限制 九、高级命令（高效技巧） 1 2 # 合并多个 kubeconfig 文件 KUBECONFIG=file1:file2:file3 kubectl config view --merge --flatten > ~/.kube/config 作用：将多个 kubeconfig 文件合并为一个 环境变量：KUBECONFIG 用冒号分隔多个文件路径 参数说明：--merge 合并，--flatten 扁平化输出 场景：管理多个集群的配置整合 1 2 # 生成 YAML 模板（不实际创建） kubectl run nginx --image=nginx --dry-run=client -o yaml > pod.yaml 作用：生成资源配置的 YAML 模板，但不真正创建资源 参数说明： --dry-run=client：客户端试运行（不发送到 API Server） -o yaml：输出 YAML 格式 场景：快速生成模板，再手动修改 1 2 # 标签操作 kubectl label pods <pod-name> env=prod 作用：给 Pod 添加标签 env=prod 场景：资源分类、标记环境、配合选择器使用 1 kubectl label pods <pod-name> env- 语法：标签名后加 - 表示删除该标签 场景：清理不再需要的标签 1 2 # 注解操作 kubectl annotate pods <pod-name> description=&#34;My pod&#34; 作用：添加注解（Annotation），用于存储非标识性元数据 场景：记录资源说明、配置信息（对人可读） 1 2 # 查看资源配额 kubectl get resourcequota -n <namespace> 作用：查看命名空间的资源配额限制（CPU、内存、Pod 数量等） 场景：资源不足时，检查是否触发了配额限制 1 2 # 查看持久卷 kubectl get pv 作用：查看集群级别的持久卷（PersistentVolume） 场景：存储管理、排查存储问题 1 kubectl get pvc -n <namespace> 作用：查看命名空间的持久卷声明（PersistentVolumeClaim） 场景：应用申请存储后查看绑定状态 1 2 3 # 查看 ConfigMap 和 Secret kubectl get configmaps kubectl get secrets 作用：查看配置信息和敏感信息 场景：检查应用配置、验证 Secret 是否存在 1 2 # 查看 Secret 内容（解码） kubectl get secret <secret-name> -o jsonpath=&#34;{.data.password}&#34; | base64 -d 作用：Secret 的值是 base64 编码的，需要解码查看明文 参数说明：jsonpath 提取特定字段 场景：查看数据库密码、Token 等敏感信息 十、常用选项速记（命令行参数） 选项 全称 含义与用途 -n --namespace 指定命名空间，隔离资源范围 -A --all-namespaces 查看所有命名空间，跨空间操作 -o wide --output wide 显示额外信息（如节点 IP、Pod IP） -o yaml/json --output 输出完整配置，用于导出或调试 -l --selector 按标签筛选资源，精准定位 --show-labels &ndash; 显示资源的标签列 --sort-by &ndash; 按字段排序，整理输出结果 -w --watch 实时监控，观察变化 --dry-run=client &ndash; 试运行，验证配置但不执行 --grace-period=0 &ndash; 立即删除，不等待优雅终止 实用技巧详解 1. 命令补全（节省打字时间） 1 2 3 # Bash 环境 echo 'source <(kubectl completion bash)' >> ~/.bashrc source ~/.bashrc 作用：输入 kubectl get p 后按 Tab 自动补全为 pods 生效：重新加载 bash 配置或重启终端 1 2 # Zsh 环境 echo 'source <(kubectl completion zsh)' >> ~/.zshrc 作用：Zsh 用户同样享受自动补全 2. 常用别名（极致偷懒） 1 2 3 4 5 6 7 alias k='kubectl' alias kg='kubectl get' alias kgp='kubectl get pods' alias kgs='kubectl get svc' alias kgd='kubectl get deploy' alias ke='kubectl exec -it' alias kl='kubectl logs' 作用：将长命令缩短为 2-3 个字母 配置：添加到 ~/.bashrc 或 ~/.zshrc 3. 快速删除 Evicted Pods（清理僵尸） 1 kubectl get pods | grep Evicted | awk '{print $1}' | xargs kubectl delete pod 执行过程： kubectl get pods：获取所有 Pod grep Evicted：筛选状态为 Evicted 的 awk '{print $1}'：提取 Pod 名称（第一列） xargs kubectl delete pod：批量删除这些 Pod 场景：节点资源不足时，大量 Pod 被驱逐，清理残留记录 4. 清空命名空间（极度危险！） 1 kubectl delete all --all -n <namespace> 执行逻辑：删除指定命名空间内 all 资源类型的 all 实例 会删除：Pod、Service、Deployment、StatefulSet 等 不会删除：命名空间本身、ConfigMap、Secret（需单独删） 替代方案：直接删除命名空间更彻底 1 kubectl delete namespace <namespace-name> 文档说明：本指南基于 Kubernetes 2024 年版本整理，建议根据实际集群版本使用 kubectl --help 查看最新参数。\n"><meta property='og:url' content='http://localhost:1313/k8s/kubectl-%E5%91%BD%E4%BB%A4/'><meta property='og:site_name' content='JustWin'><meta property='og:type' content='article'><meta property='article:section' content='K8s'><meta property='article:published_time' content='2025-11-11T00:00:00+00:00'><meta property='article:modified_time' content='2025-11-11T00:00:00+00:00'><meta property='og:image' content='http://localhost:1313/'><meta name=twitter:title content="kubectl命令"><meta name=twitter:description content="Kubectl 命令 kubectl 是 Kubernetes 的命令行工具，用于管理集群和部署应用。本文档提供每个命令的详细解释、参数含义及使用场景。\n基本语法 1 kubectl [command] [TYPE] [NAME] [flags] command：操作动作（如 get、create、delete） TYPE：资源类型（如 pods、services） NAME：资源名称 flags：可选参数 一、集群信息查看（了解集群整体状况） 1 2 # 查看集群基本信息 kubectl cluster-info 作用：显示 Kubernetes 集群的核心组件访问地址（API Server、DNS、Dashboard等） 场景：初次连接集群或排查集群连接问题时使用 输出示例：Kubernetes master is running at https://xxx:6443 1 2 3 # 查看节点状态 kubectl get nodes kubectl get nodes -o wide 作用：列出集群中所有节点（Node/Worker）的基本信息（状态、版本、运行时间） 场景：检查节点是否正常运行 参数说明：-o wide 会额外显示节点的 INTERNAL-IP、OS-IMAGE 等详细信息 1 2 # 查看集群组件状态 kubectl get componentstatuses 作用：检查核心控制平面组件（etcd、scheduler、controller-manager）的健康状态 场景：集群级别故障排查时使用 别名：可简写为 kubectl get cs 1 2 # 查看 API 资源类型 kubectl api-resources 作用：列出当前集群支持的所有资源类型（如 pods、services、deployments等） 场景：记不清资源类型名称或想确认某个资源是否支持时使用 1 2 # 查看 Kubernetes 版本 kubectl version 作用：显示客户端（kubectl）和服务器端（API Server）的版本信息 场景：确认版本兼容性，排查版本相关的问题 二、资源查看命令（日常最常用） 1 2 # 查看所有 Pod kubectl get pods 作用：列出当前命名空间下的所有 Pod（容器组） 场景：查看应用运行状态、定位问题 Pod 1 2 3 kubectl get pods --all-namespaces # 或简写 kubectl get pods -A 作用：查看集群中所有命名空间的 Pod（系统 Pod + 用户 Pod） 场景：排查跨命名空间的问题，查看系统组件状态 1 2 # 查看特定命名空间的资源 kubectl get pods -n kube-system 作用：查看指定命名空间（这里是 kube-system 系统空间）的 Pod 参数说明：-n 是 --namespace 的简写 1 2 # 查看多种资源 kubectl get pods,svc,deploy 作用：一次性查看 Pod、Service、Deployment 三种资源 语法：资源类型用逗号分隔，可一次性查看多种 1 2 # 查看资源详情 kubectl describe pod <pod-name> 作用：显示指定 Pod 的详细配置和事件信息（比 get 命令更详细） 内容包含：Pod IP、节点、标签、事件日志（Events）、容器状态等 场景：Pod 启动失败、一直 Pending 时排查原因 1 2 # 查看资源 YAML 配置 kubectl get pod <pod-name> -o yaml 作用：以 YAML 格式导出资源的完整配置（包括系统添加的默认字段） 参数说明：-o yaml 指定输出格式为 YAML（也可 -o json） 场景：学习资源配置结构、备份配置、调试时使用 1 2 # 实时监视资源变化 kubectl get pods -w 作用：持续监控 Pod 状态变化，有新变化会自动刷新显示 参数说明：-w 是 --watch 的简写 场景：观察滚动更新过程、监控 Pod 重启情况 1 2 # 按标签筛选 kubectl get pods -l app=nginx 作用：只显示带有 app=nginx 标签的 Pod 参数说明：-l 是 --selector 的简写，支持标签选择器 场景：在复杂系统中快速筛选出相关资源 1 2 # 查看资源排序显示 kubectl get pods --sort-by=.status.startTime 作用：按 Pod 启动时间排序显示 参数说明：--sort-by 支持 JSONPath 表达式 场景：找出最新启动或最老的 Pod 三、资源创建与删除（管理资源生命周期） 1 2 # 从 YAML 文件创建/更新资源 kubectl apply -f deployment.yaml 作用：根据 YAML 文件声明式创建或更新资源（推荐方式） 特点：文件存在则更新，不存在则创建（幂等性） 场景：应用部署、配置更新 1 kubectl create -f service.yaml 作用：从 YAML 文件创建资源（命令式） 特点：资源已存在会报错，不适合更新 场景：首次创建资源 1 2 # 创建命名空间 kubectl create namespace <namespace-name> 作用：创建逻辑隔离的命名空间 场景：按项目/环境隔离资源（如 dev、test、prod） 1 2 # 从镜像直接创建 Deployment kubectl create deployment nginx --image=nginx:latest 作用：快速创建一个运行 nginx 镜像的 Deployment 场景：快速测试、临时部署 1 2 # 删除资源 kubectl delete -f deployment.yaml 作用：根据 YAML 文件删除其中定义的资源 场景：清理通过文件创建的资源 1 kubectl delete pod <pod-name> 作用：删除指定名称的 Pod 注意：如果是 Deployment 管理的 Pod，会立即被重建 1 2 # 按标签删除 kubectl delete pods -l app=nginx 作用：删除所有带有 app=nginx 标签的 Pod 场景：批量清理测试资源 1 2 # 强制删除（立即） kubectl delete pod <pod-name> --grace-period=0 --force 参数说明： --grace-period=0：立即删除，不等待优雅终止（默认30秒） --force：强制删除，用于某些卡住无法删除的 Pod 警告：可能导致数据丢失，慎用！ 1 2 # 清空命名空间所有资源 kubectl delete all --all -n <namespace-name> 作用：删除命名空间内所有类型资源（all 包括 pod、svc、deploy等） 参数说明：第一个 --all 指所有资源类型，第二个 --all 指所有实例 危险操作：会清空整个命名空间！ 四、Pod 操作（深入容器内部） 1 2 # 查看 Pod 日志 kubectl logs <pod-name> 作用：查看 Pod 中主容器的标准输出日志 场景：应用报错排查 1 kubectl logs -f <pod-name> 参数说明：-f 是 --follow 的简写，实时跟踪新日志 场景：观察应用实时运行状态 1 kubectl logs --tail=20 <pod-name> 参数说明：--tail 只显示最后 N 行日志 场景：日志太多时只看最近的错误 1 kubectl logs <pod-name> -c <container-name> 参数说明：-c 指定容器名称（多容器 Pod 必须指定） 场景：Pod 内有多个容器时，查看特定容器日志 1 2 # 进入 Pod 容器（交互式） kubectl exec -it <pod-name> -- /bin/bash 作用：进入 Pod 容器的命令行终端 参数说明： -i：保持标准输入打开 -t：分配一个伪终端 --：分隔符，后面是容器内要执行的命令 场景：调试应用、手动检查配置文件 1 kubectl exec -it <pod-name> -c <container-name> -- sh 作用：多容器 Pod 中进入指定容器（使用 sh shell） 注意：某些轻量镜像可能没有 bash，只有 sh 1 2 # 在 Pod 中执行一次性命令 kubectl exec <pod-name> -- ls / 作用：在 Pod 中执行命令并返回结果，不进入交互模式 场景：快速查看目录、执行简单命令 1 2 # 复制文件到/从 Pod kubectl cp <pod-name>:/path/to/file /local/path 作用：从 Pod 容器复制文件到本地 语法：pod-name:容器路径 → 本地路径 场景：导出日志、备份容器内文件 1 kubectl cp /local/file <pod-name>:/path/to/file 作用：从本地上传文件到 Pod 容器 场景：向容器内传配置文件、测试脚本 1 2 # 端口转发到本地 kubectl port-forward <pod-name> 8080:80 作用：将本地 8080 端口转发到 Pod 的 80 端口 场景：在本地调试集群内的服务，绕过 Service 直接访问 Pod 1 kubectl port-forward svc/<service-name> 3000:80 作用：将本地 3000 端口转发到 Service 的 80 端口 场景：本地访问集群内的 Service 1 2 # 查看 Pod 资源使用（需安装 metrics-server） kubectl top pods 作用：显示 Pod 的 CPU 和内存使用量 前提：集群必须安装 metrics-server 组件 场景：监控资源消耗，定位资源瓶颈 1 kubectl top pods --containers 参数说明：--containers 显示容器级别的资源使用 场景：Pod 内多容器时，分析哪个容器占用资源最多 五、Deployment 操作（管理应用版本） 1 2 # 查看 Deployment kubectl get deployments 作用：列出当前命名空间的 Deployment（部署控制器） 场景：查看应用部署状态、副本数 1 2 # 查看滚动更新状态 kubectl rollout status deployment/<deployment-name> 作用：实时监控 Deployment 滚动更新的进度 场景：发布新版本时观察是否成功 1 2 # 更新镜像版本 kubectl set image deployment/nginx nginx=nginx:1.20 作用：不修改 YAML 文件，直接更新 Deployment 中容器的镜像版本 语法：deployment/名称 容器名=新镜像 场景：快速回滚或升级镜像 1 2 # 扩缩容（调整副本数） kubectl scale deployment/nginx --replicas=5 作用：将 nginx deployment 的副本数调整为 5 个 场景：应对流量高峰、弹性伸缩 1 2 # 回滚到上一个版本 kubectl rollout undo deployment/<deployment-name> 作用：一键回滚到上一个稳定版本 场景：新版本发布失败时快速恢复 1 2 # 回滚到指定版本 kubectl rollout undo deployment/<deployment-name> --to-revision=2 参数说明：--to-revision 指定回滚到的历史版本号 场景：需要回滚到特定历史版本 1 2 # 查看历史版本 kubectl rollout history deployment/<deployment-name> 作用：显示 Deployment 的所有历史版本记录 场景：查看可回滚的版本列表，确认版本号 1 2 # 暂停/恢复滚动更新 kubectl rollout pause deployment/<deployment-name> 作用：暂停滚动更新（只更新部分 Pod 后停止） 场景：金丝雀发布，先更新一小部分观察效果 1 kubectl rollout resume deployment/<deployment-name> 作用：恢复暂停的滚动更新 场景：金丝雀验证通过后继续更新剩余 Pod 1 2 # 编辑 Deployment kubectl edit deployment <deployment-name> 作用：打开默认编辑器（通常是 vim）直接修改 Deployment 配置 特点：修改后立即生效，无需重新 apply 场景：紧急修改配置，快速调试 六、Service 操作（管理网络访问） 1 2 3 4 # 查看 Service kubectl get services # 或简写 kubectl get svc 作用：列出当前命名空间的 Service（服务） 场景：查看服务暴露的端口、类型、ClusterIP 1 2 # 查看 Service 详情 kubectl describe svc <service-name> 作用：显示 Service 的详细信息，包括后端端点（Endpoints） 场景：Service 无法访问时，检查是否关联了正确的 Pod 1 2 # 暴露 Deployment 为 Service kubectl expose deployment/nginx --type=NodePort --port=80 作用：为 nginx deployment 创建 Service，类型为 NodePort 参数说明： --type：Service 类型（ClusterIP/NodePort/LoadBalancer） --port：Service 暴露的端口 场景：快速让外部访问集群内的应用 1 2 # 创建 Service 并指定目标端口 kubectl expose deployment/nginx --type=LoadBalancer --port=80 --target-port=8080 参数说明：--target-port 是 Pod 内容器监听的端口 场景：容器内应用监听在 8080，但外部希望用 80 端口访问 1 2 # 查看 Service 后端端点 kubectl get endpoints <service-name> 作用：显示 Service 关联的后端 Pod IP 和端口 场景：验证 Service 是否正确路由到 Pod 七、配置与上下文管理（多集群切换） 1 2 # 查看 kubeconfig 完整配置 kubectl config view 作用：显示 kubectl 的配置文件（~/.kube/config）内容 场景：确认当前使用的集群、用户、上下文信息 1 2 # 查看当前上下文 kubectl config current-context 作用：显示当前正在使用的上下文名称（cluster + user + namespace 的组合） 场景：确认当前操作的集群，避免误操作 1 2 # 列出所有可用上下文 kubectl config get-contexts 作用：显示配置文件中定义的所有上下文列表 场景：在多集群环境中切换前查看可用选项 1 2 # 切换上下文（切换集群/用户） kubectl config use-context <context-name> 作用：切换到指定的上下文（快速切换集群） 场景：管理多个 K8s 集群时切换操作目标 1 2 # 添加集群配置 kubectl config set-cluster <cluster-name> --server=<server-url> 作用：向配置文件中添加新集群的访问地址 参数说明：--server 指定 API Server 地址 场景：手动配置新集群连接信息 1 2 # 添加用户凭证 kubectl config set-credentials <user-name> --token=<token> 作用：为指定用户设置访问凭证（Token 方式） 场景：配置不同用户的访问权限 1 2 # 设置上下文 kubectl config set-context <context-name> --cluster=<cluster-name> --user=<user-name> 作用：创建上下文，关联集群、用户和命名空间 场景：配置多集群、多用户、多环境的组合 1 2 # 删除上下文 kubectl config delete-context <context-name> 作用：从配置文件中删除指定的上下文 场景：清理无效的集群配置 1 2 # 设置默认命名空间 kubectl config set-context --current --namespace=<namespace-name> 参数说明：--current 修改当前上下文，--namespace 设置默认命名空间 效果：后续命令无需每次都指定 -n 参数 场景：长期在特定命名空间工作时提高效率 八、调试与故障排查（问题定位） 1 2 # 查看事件（重要！） kubectl get events 作用：查看集群中最近发生的事件（如 Pod 调度、启动、错误等） 场景：Pod 启动失败、调度失败时查看详细原因 1 kubectl get events --sort-by=.lastTimestamp 参数说明：按最后发生时间排序，最新事件在最后 场景：事件太多时，按时间顺序查看 1 2 # 查看 API Server 请求（调试） kubectl get pods -v=6 参数说明：-v 设置日志级别（0-9），数字越大越详细 场景：调试 kubectl 本身的问题，查看底层 API 调用 1 2 3 # 查看资源使用情况 kubectl top nodes kubectl top pods 作用：显示节点和 Pod 的实时资源使用 场景：集群资源不足、Pod 被 OOMKilled 时排查 1 2 # 权限检查（重要！） kubectl auth can-i create pods 作用：检查当前用户是否有创建 Pod 的权限 场景：权限不足报错时，确认自己的权限范围 1 kubectl auth can-i &#34;*&#34; &#34;*&#34; --all-namespaces 作用：检查当前用户在所有命名空间的所有权限 参数说明：&#34;*&#34; 代表所有 verb 和所有 resource 场景：全面了解自己的权限 1 2 # 启动临时调试 Pod kubectl run debug-pod --rm -i --tty --image=busybox -- sh 参数说明： --rm：退出后自动删除 Pod -i --tty：交互式终端 --image：使用轻量级镜像 -- 后面是启动命令 场景：集群内网络测试、临时工具使用 1 2 # 查看网络策略 kubectl get networkpolicies 作用：查看当前命名空间的网络策略 场景：网络不通时检查是否有网络策略限制 九、高级命令（高效技巧） 1 2 # 合并多个 kubeconfig 文件 KUBECONFIG=file1:file2:file3 kubectl config view --merge --flatten > ~/.kube/config 作用：将多个 kubeconfig 文件合并为一个 环境变量：KUBECONFIG 用冒号分隔多个文件路径 参数说明：--merge 合并，--flatten 扁平化输出 场景：管理多个集群的配置整合 1 2 # 生成 YAML 模板（不实际创建） kubectl run nginx --image=nginx --dry-run=client -o yaml > pod.yaml 作用：生成资源配置的 YAML 模板，但不真正创建资源 参数说明： --dry-run=client：客户端试运行（不发送到 API Server） -o yaml：输出 YAML 格式 场景：快速生成模板，再手动修改 1 2 # 标签操作 kubectl label pods <pod-name> env=prod 作用：给 Pod 添加标签 env=prod 场景：资源分类、标记环境、配合选择器使用 1 kubectl label pods <pod-name> env- 语法：标签名后加 - 表示删除该标签 场景：清理不再需要的标签 1 2 # 注解操作 kubectl annotate pods <pod-name> description=&#34;My pod&#34; 作用：添加注解（Annotation），用于存储非标识性元数据 场景：记录资源说明、配置信息（对人可读） 1 2 # 查看资源配额 kubectl get resourcequota -n <namespace> 作用：查看命名空间的资源配额限制（CPU、内存、Pod 数量等） 场景：资源不足时，检查是否触发了配额限制 1 2 # 查看持久卷 kubectl get pv 作用：查看集群级别的持久卷（PersistentVolume） 场景：存储管理、排查存储问题 1 kubectl get pvc -n <namespace> 作用：查看命名空间的持久卷声明（PersistentVolumeClaim） 场景：应用申请存储后查看绑定状态 1 2 3 # 查看 ConfigMap 和 Secret kubectl get configmaps kubectl get secrets 作用：查看配置信息和敏感信息 场景：检查应用配置、验证 Secret 是否存在 1 2 # 查看 Secret 内容（解码） kubectl get secret <secret-name> -o jsonpath=&#34;{.data.password}&#34; | base64 -d 作用：Secret 的值是 base64 编码的，需要解码查看明文 参数说明：jsonpath 提取特定字段 场景：查看数据库密码、Token 等敏感信息 十、常用选项速记（命令行参数） 选项 全称 含义与用途 -n --namespace 指定命名空间，隔离资源范围 -A --all-namespaces 查看所有命名空间，跨空间操作 -o wide --output wide 显示额外信息（如节点 IP、Pod IP） -o yaml/json --output 输出完整配置，用于导出或调试 -l --selector 按标签筛选资源，精准定位 --show-labels &ndash; 显示资源的标签列 --sort-by &ndash; 按字段排序，整理输出结果 -w --watch 实时监控，观察变化 --dry-run=client &ndash; 试运行，验证配置但不执行 --grace-period=0 &ndash; 立即删除，不等待优雅终止 实用技巧详解 1. 命令补全（节省打字时间） 1 2 3 # Bash 环境 echo 'source <(kubectl completion bash)' >> ~/.bashrc source ~/.bashrc 作用：输入 kubectl get p 后按 Tab 自动补全为 pods 生效：重新加载 bash 配置或重启终端 1 2 # Zsh 环境 echo 'source <(kubectl completion zsh)' >> ~/.zshrc 作用：Zsh 用户同样享受自动补全 2. 常用别名（极致偷懒） 1 2 3 4 5 6 7 alias k='kubectl' alias kg='kubectl get' alias kgp='kubectl get pods' alias kgs='kubectl get svc' alias kgd='kubectl get deploy' alias ke='kubectl exec -it' alias kl='kubectl logs' 作用：将长命令缩短为 2-3 个字母 配置：添加到 ~/.bashrc 或 ~/.zshrc 3. 快速删除 Evicted Pods（清理僵尸） 1 kubectl get pods | grep Evicted | awk '{print $1}' | xargs kubectl delete pod 执行过程： kubectl get pods：获取所有 Pod grep Evicted：筛选状态为 Evicted 的 awk '{print $1}'：提取 Pod 名称（第一列） xargs kubectl delete pod：批量删除这些 Pod 场景：节点资源不足时，大量 Pod 被驱逐，清理残留记录 4. 清空命名空间（极度危险！） 1 kubectl delete all --all -n <namespace> 执行逻辑：删除指定命名空间内 all 资源类型的 all 实例 会删除：Pod、Service、Deployment、StatefulSet 等 不会删除：命名空间本身、ConfigMap、Secret（需单独删） 替代方案：直接删除命名空间更彻底 1 kubectl delete namespace <namespace-name> 文档说明：本指南基于 Kubernetes 2024 年版本整理，建议根据实际集群版本使用 kubectl --help 查看最新参数。\n"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='http://localhost:1313/'><link rel=stylesheet href=/css/custom.css><link rel="shortcut icon" href=/favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"light")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/images/avatar_hu_89ca753ea8ea85c7.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>✍️</span></figure><div class=site-meta><h1 class=site-name><a href=/>JustWin</a></h1><h2 class=site-description>分享技术与生活</h2></div></header><ol class=menu-social><li><a href=https://github.com/passion-win target=_blank title=GitHub rel=me><svg width="800" height="800" viewBox="0 0 20 20" xmlns:xlink="http://www.w3.org/1999/xlink"><title>github [#142]</title><desc>Created with Sketch.</desc><defs/><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Dribbble-Light-Preview" transform="translate(-140.000000, -7559.000000)" fill="#000"><g id="icons" transform="translate(56.000000, 160.000000)"><path d="M94 7399C99.523 7399 104 7403.59 104 7409.253 104 7413.782 101.138 7417.624 97.167 7418.981 96.66 7419.082 96.48 7418.762 96.48 7418.489 96.48 7418.151 96.492 7417.047 96.492 7415.675 96.492 7414.719 96.172 7414.095 95.813 7413.777 98.04 7413.523 100.38 7412.656 100.38 7408.718 100.38 7407.598 99.992 7406.684 99.35 7405.966 99.454 7405.707 99.797 7404.664 99.252 7403.252 99.252 7403.252 98.414 7402.977 96.505 7404.303 95.706 7404.076 94.85 7403.962 94 7403.958 93.15 7403.962 92.295 7404.076 91.497 7404.303 89.586 7402.977 88.746 7403.252 88.746 7403.252 88.203 7404.664 88.546 7405.707 88.649 7405.966 88.01 7406.684 87.619 7407.598 87.619 7408.718 87.619 7412.646 89.954 7413.526 92.175 7413.785 91.889 7414.041 91.63 7414.493 91.54 7415.156 90.97 7415.418 89.522 7415.871 88.63 7414.304 88.63 7414.304 88.101 7413.319 87.097 7413.247 87.097 7413.247 86.122 7413.234 87.029 7413.87 87.029 7413.87 87.684 7414.185 88.139 7415.37 88.139 7415.37 88.726 7417.2 91.508 7416.58 91.513 7417.437 91.522 7418.245 91.522 7418.489 91.522 7418.76 91.338 7419.077 90.839 7418.982 86.865 7417.627 84 7413.783 84 7409.253 84 7403.59 88.478 7399 94 7399" id="github-[#142]"/></g></g></g></svg></a></li><li><a href=https://t.me/+TFjBeZzowwU1YTY1 target=_blank title=telegram rel=me><svg viewBox="0 0 640 640"><path d="M320 72C183 72 72 183 72 320S183 568 320 568 568 457 568 320 457 72 320 72zM435 240.7C431.3 279.9 415.1 375.1 406.9 419c-3.5 18.6-10.3 24.8-16.9 25.4C375.6 445.7 364.7 434.9 350.7 425.7c-21.8-14.3-34.2-23.2-55.3-37.2C270.9 372.4 286.8 363.5 300.7 349 304.4 345.2 367.8 287.5 369 282.3 369.2 281.6 369.3 279.2 367.8 277.9 366.3 276.6 364.2 277.1 362.7 277.4 360.5 277.9 325.6 300.9 258.1 346.5 248.2 353.3 239.2 356.6 231.2 356.4 222.3 356.2 205.3 351.4 192.6 347.3 177.1 342.3 164.7 339.6 165.8 331 166.4 326.5 172.5 322 184.2 317.3 256.5 285.8 304.7 265 328.8 255c68.9-28.6 83.2-33.6 92.5-33.8C423.4 221.2 427.9 221.7 430.9 224.1 432.9 225.8 434.1 228.2 434.4 230.8 434.9 234 435 237.3 434.8 240.6z"/></svg></a></li><li><a href=https://twitter.com/@win1688888888 target=_blank title=twitter rel=me><svg width="800" height="800" viewBox="0 -2 20 20" xmlns:xlink="http://www.w3.org/1999/xlink"><title>twitter [#154]</title><desc>Created with Sketch.</desc><defs/><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Dribbble-Light-Preview" transform="translate(-60.000000, -7521.000000)" fill="#000"><g id="icons" transform="translate(56.000000, 160.000000)"><path d="M10.29 7377C17.837 7377 21.965 7370.84365 21.965 7365.50546 21.965 7365.33021 21.965 7365.15595 21.953 7364.98267 22.756 7364.41163 23.449 7363.70276 24 7362.8915 23.252 7363.21837 22.457 7363.433 21.644 7363.52751 22.5 7363.02244 23.141 7362.2289 23.448 7361.2926 22.642 7361.76321 21.761 7362.095 20.842 7362.27321 19.288 7360.64674 16.689 7360.56798 15.036 7362.09796 13.971 7363.08447 13.518 7364.55538 13.849 7365.95835 10.55 7365.79492 7.476 7364.261 5.392 7361.73762 4.303 7363.58363 4.86 7365.94457 6.663 7367.12996 6.01 7367.11125 5.371 7366.93797 4.8 7366.62489V7366.67608C4.801 7368.5989 6.178 7370.2549 8.092 7370.63591 7.488 7370.79836 6.854 7370.82199 6.24 7370.70483 6.777 7372.35099 8.318 7373.47829 10.073 7373.51078 8.62 7374.63513 6.825 7375.24554 4.977 7375.24358 4.651 7375.24259 4.325 7375.22388 4 7375.18549 5.877 7376.37088 8.06 7377 10.29 7376.99705" id="twitter-[#154]"/></g></g></g></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><span>首页</span></a></li><li><a href=/archives/><span>归档</span></a></li><li><a href=/about/><span>关于</span></a></li><li><a href=/links/><span>网站分享</span></a></li><li><a href=/blockchain/><span>待定</span></a></li><li><a href=/docker/><span>docker</span></a></li><li><a href=/k8s/><span>k8s</span></a></li><li><a href><span></span></a></li><li class=menu-bottom-section><ol class=menu><li id=i18n-switch><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language title=language onchange="window.location.href=this.selectedOptions[0].value"><option value=http://localhost:1313/ selected>中文</option><option value=http://localhost:1313/en/>English</option></select></li><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>暗色模式</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#基本语法>基本语法</a></li><li><a href=#一集群信息查看了解集群整体状况>一、集群信息查看（了解集群整体状况）</a></li><li><a href=#二资源查看命令日常最常用>二、资源查看命令（日常最常用）</a></li><li><a href=#三资源创建与删除管理资源生命周期>三、资源创建与删除（管理资源生命周期）</a></li><li><a href=#四pod-操作深入容器内部>四、Pod 操作（深入容器内部）</a></li><li><a href=#五deployment-操作管理应用版本>五、Deployment 操作（管理应用版本）</a></li><li><a href=#六service-操作管理网络访问>六、Service 操作（管理网络访问）</a></li><li><a href=#七配置与上下文管理多集群切换>七、配置与上下文管理（多集群切换）</a></li><li><a href=#八调试与故障排查问题定位>八、调试与故障排查（问题定位）</a></li><li><a href=#九高级命令高效技巧>九、高级命令（高效技巧）</a></li><li><a href=#十常用选项速记命令行参数>十、常用选项速记（命令行参数）</a></li><li><a href=#实用技巧详解>实用技巧详解</a><ol><li><a href=#1-命令补全节省打字时间>1. <strong>命令补全（节省打字时间）</strong></a></li><li><a href=#2-常用别名极致偷懒>2. <strong>常用别名（极致偷懒）</strong></a></li><li><a href=#3-快速删除-evicted-pods清理僵尸>3. <strong>快速删除 Evicted Pods（清理僵尸）</strong></a></li><li><a href=#4-清空命名空间极度危险>4. <strong>清空命名空间（极度危险！）</strong></a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category></header><div class=article-title-wrapper><h2 class=article-title><a href=/k8s/kubectl-%E5%91%BD%E4%BB%A4/>kubectl命令</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2025-11-11</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>阅读时长: 12 分钟</time></div></footer></div></header><section class=article-content><h1 id=kubectl-命令>Kubectl 命令</h1><p><code>kubectl</code> 是 Kubernetes 的命令行工具，用于管理集群和部署应用。本文档提供每个命令的详细解释、参数含义及使用场景。</p><hr><h2 id=基本语法>基本语法</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl <span class=o>[</span>command<span class=o>]</span> <span class=o>[</span>TYPE<span class=o>]</span> <span class=o>[</span>NAME<span class=o>]</span> <span class=o>[</span>flags<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>command</strong>：操作动作（如 <code>get</code>、<code>create</code>、<code>delete</code>）</li><li><strong>TYPE</strong>：资源类型（如 <code>pods</code>、<code>services</code>）</li><li><strong>NAME</strong>：资源名称</li><li><strong>flags</strong>：可选参数</li></ul><hr><h2 id=一集群信息查看了解集群整体状况>一、集群信息查看（了解集群整体状况）</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看集群基本信息</span>
</span></span><span class=line><span class=cl>kubectl cluster-info
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：显示 Kubernetes 集群的核心组件访问地址（API Server、DNS、Dashboard等）</li><li><strong>场景</strong>：初次连接集群或排查集群连接问题时使用</li><li><strong>输出示例</strong>：Kubernetes master is running at https://xxx:6443</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看节点状态</span>
</span></span><span class=line><span class=cl>kubectl get nodes
</span></span><span class=line><span class=cl>kubectl get nodes -o wide
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：列出集群中所有节点（Node/Worker）的基本信息（状态、版本、运行时间）</li><li><strong>场景</strong>：检查节点是否正常运行</li><li><strong>参数说明</strong>：<code>-o wide</code> 会额外显示节点的 INTERNAL-IP、OS-IMAGE 等详细信息</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看集群组件状态</span>
</span></span><span class=line><span class=cl>kubectl get componentstatuses
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：检查核心控制平面组件（etcd、scheduler、controller-manager）的健康状态</li><li><strong>场景</strong>：集群级别故障排查时使用</li><li><strong>别名</strong>：可简写为 <code>kubectl get cs</code></li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看 API 资源类型</span>
</span></span><span class=line><span class=cl>kubectl api-resources
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：列出当前集群支持的所有资源类型（如 pods、services、deployments等）</li><li><strong>场景</strong>：记不清资源类型名称或想确认某个资源是否支持时使用</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看 Kubernetes 版本</span>
</span></span><span class=line><span class=cl>kubectl version
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：显示客户端（kubectl）和服务器端（API Server）的版本信息</li><li><strong>场景</strong>：确认版本兼容性，排查版本相关的问题</li></ul><hr><h2 id=二资源查看命令日常最常用>二、资源查看命令（日常最常用）</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看所有 Pod</span>
</span></span><span class=line><span class=cl>kubectl get pods
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：列出当前命名空间下的所有 Pod（容器组）</li><li><strong>场景</strong>：查看应用运行状态、定位问题 Pod</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods --all-namespaces
</span></span><span class=line><span class=cl><span class=c1># 或简写</span>
</span></span><span class=line><span class=cl>kubectl get pods -A
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：查看集群中所有命名空间的 Pod（系统 Pod + 用户 Pod）</li><li><strong>场景</strong>：排查跨命名空间的问题，查看系统组件状态</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看特定命名空间的资源</span>
</span></span><span class=line><span class=cl>kubectl get pods -n kube-system
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：查看指定命名空间（这里是 kube-system 系统空间）的 Pod</li><li><strong>参数说明</strong>：<code>-n</code> 是 <code>--namespace</code> 的简写</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看多种资源</span>
</span></span><span class=line><span class=cl>kubectl get pods,svc,deploy
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：一次性查看 Pod、Service、Deployment 三种资源</li><li><strong>语法</strong>：资源类型用逗号分隔，可一次性查看多种</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看资源详情</span>
</span></span><span class=line><span class=cl>kubectl describe pod &lt;pod-name&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：显示指定 Pod 的详细配置和事件信息（比 get 命令更详细）</li><li><strong>内容包含</strong>：Pod IP、节点、标签、事件日志（Events）、容器状态等</li><li><strong>场景</strong>：Pod 启动失败、一直 Pending 时排查原因</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看资源 YAML 配置</span>
</span></span><span class=line><span class=cl>kubectl get pod &lt;pod-name&gt; -o yaml
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：以 YAML 格式导出资源的完整配置（包括系统添加的默认字段）</li><li><strong>参数说明</strong>：<code>-o yaml</code> 指定输出格式为 YAML（也可 <code>-o json</code>）</li><li><strong>场景</strong>：学习资源配置结构、备份配置、调试时使用</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 实时监视资源变化</span>
</span></span><span class=line><span class=cl>kubectl get pods -w
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：持续监控 Pod 状态变化，有新变化会自动刷新显示</li><li><strong>参数说明</strong>：<code>-w</code> 是 <code>--watch</code> 的简写</li><li><strong>场景</strong>：观察滚动更新过程、监控 Pod 重启情况</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 按标签筛选</span>
</span></span><span class=line><span class=cl>kubectl get pods -l <span class=nv>app</span><span class=o>=</span>nginx
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：只显示带有 <code>app=nginx</code> 标签的 Pod</li><li><strong>参数说明</strong>：<code>-l</code> 是 <code>--selector</code> 的简写，支持标签选择器</li><li><strong>场景</strong>：在复杂系统中快速筛选出相关资源</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看资源排序显示</span>
</span></span><span class=line><span class=cl>kubectl get pods --sort-by<span class=o>=</span>.status.startTime
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：按 Pod 启动时间排序显示</li><li><strong>参数说明</strong>：<code>--sort-by</code> 支持 JSONPath 表达式</li><li><strong>场景</strong>：找出最新启动或最老的 Pod</li></ul><hr><h2 id=三资源创建与删除管理资源生命周期>三、资源创建与删除（管理资源生命周期）</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 从 YAML 文件创建/更新资源</span>
</span></span><span class=line><span class=cl>kubectl apply -f deployment.yaml
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：根据 YAML 文件声明式创建或更新资源（推荐方式）</li><li><strong>特点</strong>：文件存在则更新，不存在则创建（幂等性）</li><li><strong>场景</strong>：应用部署、配置更新</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl create -f service.yaml
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：从 YAML 文件创建资源（命令式）</li><li><strong>特点</strong>：资源已存在会报错，不适合更新</li><li><strong>场景</strong>：首次创建资源</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 创建命名空间</span>
</span></span><span class=line><span class=cl>kubectl create namespace &lt;namespace-name&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：创建逻辑隔离的命名空间</li><li><strong>场景</strong>：按项目/环境隔离资源（如 dev、test、prod）</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 从镜像直接创建 Deployment</span>
</span></span><span class=line><span class=cl>kubectl create deployment nginx --image<span class=o>=</span>nginx:latest
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：快速创建一个运行 nginx 镜像的 Deployment</li><li><strong>场景</strong>：快速测试、临时部署</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 删除资源</span>
</span></span><span class=line><span class=cl>kubectl delete -f deployment.yaml
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：根据 YAML 文件删除其中定义的资源</li><li><strong>场景</strong>：清理通过文件创建的资源</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl delete pod &lt;pod-name&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：删除指定名称的 Pod</li><li><strong>注意</strong>：如果是 Deployment 管理的 Pod，会立即被重建</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 按标签删除</span>
</span></span><span class=line><span class=cl>kubectl delete pods -l <span class=nv>app</span><span class=o>=</span>nginx
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：删除所有带有 <code>app=nginx</code> 标签的 Pod</li><li><strong>场景</strong>：批量清理测试资源</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 强制删除（立即）</span>
</span></span><span class=line><span class=cl>kubectl delete pod &lt;pod-name&gt; --grace-period<span class=o>=</span><span class=m>0</span> --force
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>参数说明</strong>：<ul><li><code>--grace-period=0</code>：立即删除，不等待优雅终止（默认30秒）</li><li><code>--force</code>：强制删除，用于某些卡住无法删除的 Pod</li></ul></li><li><strong>警告</strong>：可能导致数据丢失，慎用！</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 清空命名空间所有资源</span>
</span></span><span class=line><span class=cl>kubectl delete all --all -n &lt;namespace-name&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：删除命名空间内所有类型资源（all 包括 pod、svc、deploy等）</li><li><strong>参数说明</strong>：第一个 <code>--all</code> 指所有资源类型，第二个 <code>--all</code> 指所有实例</li><li><strong>危险操作</strong>：会清空整个命名空间！</li></ul><hr><h2 id=四pod-操作深入容器内部>四、Pod 操作（深入容器内部）</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看 Pod 日志</span>
</span></span><span class=line><span class=cl>kubectl logs &lt;pod-name&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：查看 Pod 中主容器的标准输出日志</li><li><strong>场景</strong>：应用报错排查</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl logs -f &lt;pod-name&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>参数说明</strong>：<code>-f</code> 是 <code>--follow</code> 的简写，实时跟踪新日志</li><li><strong>场景</strong>：观察应用实时运行状态</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl logs --tail<span class=o>=</span><span class=m>20</span> &lt;pod-name&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>参数说明</strong>：<code>--tail</code> 只显示最后 N 行日志</li><li><strong>场景</strong>：日志太多时只看最近的错误</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl logs &lt;pod-name&gt; -c &lt;container-name&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>参数说明</strong>：<code>-c</code> 指定容器名称（多容器 Pod 必须指定）</li><li><strong>场景</strong>：Pod 内有多个容器时，查看特定容器日志</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 进入 Pod 容器（交互式）</span>
</span></span><span class=line><span class=cl>kubectl <span class=nb>exec</span> -it &lt;pod-name&gt; -- /bin/bash
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：进入 Pod 容器的命令行终端</li><li><strong>参数说明</strong>：<ul><li><code>-i</code>：保持标准输入打开</li><li><code>-t</code>：分配一个伪终端</li><li><code>--</code>：分隔符，后面是容器内要执行的命令</li></ul></li><li><strong>场景</strong>：调试应用、手动检查配置文件</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl <span class=nb>exec</span> -it &lt;pod-name&gt; -c &lt;container-name&gt; -- sh
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：多容器 Pod 中进入指定容器（使用 sh shell）</li><li><strong>注意</strong>：某些轻量镜像可能没有 bash，只有 sh</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 在 Pod 中执行一次性命令</span>
</span></span><span class=line><span class=cl>kubectl <span class=nb>exec</span> &lt;pod-name&gt; -- ls /
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：在 Pod 中执行命令并返回结果，不进入交互模式</li><li><strong>场景</strong>：快速查看目录、执行简单命令</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 复制文件到/从 Pod</span>
</span></span><span class=line><span class=cl>kubectl cp &lt;pod-name&gt;:/path/to/file /local/path
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：从 Pod 容器复制文件到本地</li><li><strong>语法</strong>：<code>pod-name:容器路径</code> → <code>本地路径</code></li><li><strong>场景</strong>：导出日志、备份容器内文件</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl cp /local/file &lt;pod-name&gt;:/path/to/file
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：从本地上传文件到 Pod 容器</li><li><strong>场景</strong>：向容器内传配置文件、测试脚本</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 端口转发到本地</span>
</span></span><span class=line><span class=cl>kubectl port-forward &lt;pod-name&gt; 8080:80
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：将本地 8080 端口转发到 Pod 的 80 端口</li><li><strong>场景</strong>：在本地调试集群内的服务，绕过 Service 直接访问 Pod</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl port-forward svc/&lt;service-name&gt; 3000:80
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：将本地 3000 端口转发到 Service 的 80 端口</li><li><strong>场景</strong>：本地访问集群内的 Service</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看 Pod 资源使用（需安装 metrics-server）</span>
</span></span><span class=line><span class=cl>kubectl top pods
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：显示 Pod 的 CPU 和内存使用量</li><li><strong>前提</strong>：集群必须安装 metrics-server 组件</li><li><strong>场景</strong>：监控资源消耗，定位资源瓶颈</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl top pods --containers
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>参数说明</strong>：<code>--containers</code> 显示容器级别的资源使用</li><li><strong>场景</strong>：Pod 内多容器时，分析哪个容器占用资源最多</li></ul><hr><h2 id=五deployment-操作管理应用版本>五、Deployment 操作（管理应用版本）</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看 Deployment</span>
</span></span><span class=line><span class=cl>kubectl get deployments
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：列出当前命名空间的 Deployment（部署控制器）</li><li><strong>场景</strong>：查看应用部署状态、副本数</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看滚动更新状态</span>
</span></span><span class=line><span class=cl>kubectl rollout status deployment/&lt;deployment-name&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：实时监控 Deployment 滚动更新的进度</li><li><strong>场景</strong>：发布新版本时观察是否成功</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 更新镜像版本</span>
</span></span><span class=line><span class=cl>kubectl <span class=nb>set</span> image deployment/nginx <span class=nv>nginx</span><span class=o>=</span>nginx:1.20
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：不修改 YAML 文件，直接更新 Deployment 中容器的镜像版本</li><li><strong>语法</strong>：<code>deployment/名称 容器名=新镜像</code></li><li><strong>场景</strong>：快速回滚或升级镜像</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 扩缩容（调整副本数）</span>
</span></span><span class=line><span class=cl>kubectl scale deployment/nginx --replicas<span class=o>=</span><span class=m>5</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：将 nginx deployment 的副本数调整为 5 个</li><li><strong>场景</strong>：应对流量高峰、弹性伸缩</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 回滚到上一个版本</span>
</span></span><span class=line><span class=cl>kubectl rollout undo deployment/&lt;deployment-name&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：一键回滚到上一个稳定版本</li><li><strong>场景</strong>：新版本发布失败时快速恢复</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 回滚到指定版本</span>
</span></span><span class=line><span class=cl>kubectl rollout undo deployment/&lt;deployment-name&gt; --to-revision<span class=o>=</span><span class=m>2</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>参数说明</strong>：<code>--to-revision</code> 指定回滚到的历史版本号</li><li><strong>场景</strong>：需要回滚到特定历史版本</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看历史版本</span>
</span></span><span class=line><span class=cl>kubectl rollout <span class=nb>history</span> deployment/&lt;deployment-name&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：显示 Deployment 的所有历史版本记录</li><li><strong>场景</strong>：查看可回滚的版本列表，确认版本号</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 暂停/恢复滚动更新</span>
</span></span><span class=line><span class=cl>kubectl rollout pause deployment/&lt;deployment-name&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：暂停滚动更新（只更新部分 Pod 后停止）</li><li><strong>场景</strong>：金丝雀发布，先更新一小部分观察效果</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl rollout resume deployment/&lt;deployment-name&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：恢复暂停的滚动更新</li><li><strong>场景</strong>：金丝雀验证通过后继续更新剩余 Pod</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 编辑 Deployment</span>
</span></span><span class=line><span class=cl>kubectl edit deployment &lt;deployment-name&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：打开默认编辑器（通常是 vim）直接修改 Deployment 配置</li><li><strong>特点</strong>：修改后立即生效，无需重新 apply</li><li><strong>场景</strong>：紧急修改配置，快速调试</li></ul><hr><h2 id=六service-操作管理网络访问>六、Service 操作（管理网络访问）</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看 Service</span>
</span></span><span class=line><span class=cl>kubectl get services
</span></span><span class=line><span class=cl><span class=c1># 或简写</span>
</span></span><span class=line><span class=cl>kubectl get svc
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：列出当前命名空间的 Service（服务）</li><li><strong>场景</strong>：查看服务暴露的端口、类型、ClusterIP</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看 Service 详情</span>
</span></span><span class=line><span class=cl>kubectl describe svc &lt;service-name&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：显示 Service 的详细信息，包括后端端点（Endpoints）</li><li><strong>场景</strong>：Service 无法访问时，检查是否关联了正确的 Pod</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 暴露 Deployment 为 Service</span>
</span></span><span class=line><span class=cl>kubectl expose deployment/nginx --type<span class=o>=</span>NodePort --port<span class=o>=</span><span class=m>80</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：为 nginx deployment 创建 Service，类型为 NodePort</li><li><strong>参数说明</strong>：<ul><li><code>--type</code>：Service 类型（ClusterIP/NodePort/LoadBalancer）</li><li><code>--port</code>：Service 暴露的端口</li></ul></li><li><strong>场景</strong>：快速让外部访问集群内的应用</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 创建 Service 并指定目标端口</span>
</span></span><span class=line><span class=cl>kubectl expose deployment/nginx --type<span class=o>=</span>LoadBalancer --port<span class=o>=</span><span class=m>80</span> --target-port<span class=o>=</span><span class=m>8080</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>参数说明</strong>：<code>--target-port</code> 是 Pod 内容器监听的端口</li><li><strong>场景</strong>：容器内应用监听在 8080，但外部希望用 80 端口访问</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看 Service 后端端点</span>
</span></span><span class=line><span class=cl>kubectl get endpoints &lt;service-name&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：显示 Service 关联的后端 Pod IP 和端口</li><li><strong>场景</strong>：验证 Service 是否正确路由到 Pod</li></ul><hr><h2 id=七配置与上下文管理多集群切换>七、配置与上下文管理（多集群切换）</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看 kubeconfig 完整配置</span>
</span></span><span class=line><span class=cl>kubectl config view
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：显示 kubectl 的配置文件（~/.kube/config）内容</li><li><strong>场景</strong>：确认当前使用的集群、用户、上下文信息</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看当前上下文</span>
</span></span><span class=line><span class=cl>kubectl config current-context
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：显示当前正在使用的上下文名称（cluster + user + namespace 的组合）</li><li><strong>场景</strong>：确认当前操作的集群，避免误操作</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 列出所有可用上下文</span>
</span></span><span class=line><span class=cl>kubectl config get-contexts
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：显示配置文件中定义的所有上下文列表</li><li><strong>场景</strong>：在多集群环境中切换前查看可用选项</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 切换上下文（切换集群/用户）</span>
</span></span><span class=line><span class=cl>kubectl config use-context &lt;context-name&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：切换到指定的上下文（快速切换集群）</li><li><strong>场景</strong>：管理多个 K8s 集群时切换操作目标</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 添加集群配置</span>
</span></span><span class=line><span class=cl>kubectl config set-cluster &lt;cluster-name&gt; --server<span class=o>=</span>&lt;server-url&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：向配置文件中添加新集群的访问地址</li><li><strong>参数说明</strong>：<code>--server</code> 指定 API Server 地址</li><li><strong>场景</strong>：手动配置新集群连接信息</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 添加用户凭证</span>
</span></span><span class=line><span class=cl>kubectl config set-credentials &lt;user-name&gt; --token<span class=o>=</span>&lt;token&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：为指定用户设置访问凭证（Token 方式）</li><li><strong>场景</strong>：配置不同用户的访问权限</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 设置上下文</span>
</span></span><span class=line><span class=cl>kubectl config set-context &lt;context-name&gt; --cluster<span class=o>=</span>&lt;cluster-name&gt; --user<span class=o>=</span>&lt;user-name&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：创建上下文，关联集群、用户和命名空间</li><li><strong>场景</strong>：配置多集群、多用户、多环境的组合</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 删除上下文</span>
</span></span><span class=line><span class=cl>kubectl config delete-context &lt;context-name&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：从配置文件中删除指定的上下文</li><li><strong>场景</strong>：清理无效的集群配置</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 设置默认命名空间</span>
</span></span><span class=line><span class=cl>kubectl config set-context --current --namespace<span class=o>=</span>&lt;namespace-name&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>参数说明</strong>：<code>--current</code> 修改当前上下文，<code>--namespace</code> 设置默认命名空间</li><li><strong>效果</strong>：后续命令无需每次都指定 <code>-n</code> 参数</li><li><strong>场景</strong>：长期在特定命名空间工作时提高效率</li></ul><hr><h2 id=八调试与故障排查问题定位>八、调试与故障排查（问题定位）</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看事件（重要！）</span>
</span></span><span class=line><span class=cl>kubectl get events
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：查看集群中最近发生的事件（如 Pod 调度、启动、错误等）</li><li><strong>场景</strong>：Pod 启动失败、调度失败时查看详细原因</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get events --sort-by<span class=o>=</span>.lastTimestamp
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>参数说明</strong>：按最后发生时间排序，最新事件在最后</li><li><strong>场景</strong>：事件太多时，按时间顺序查看</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看 API Server 请求（调试）</span>
</span></span><span class=line><span class=cl>kubectl get pods -v<span class=o>=</span><span class=m>6</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>参数说明</strong>：<code>-v</code> 设置日志级别（0-9），数字越大越详细</li><li><strong>场景</strong>：调试 kubectl 本身的问题，查看底层 API 调用</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看资源使用情况</span>
</span></span><span class=line><span class=cl>kubectl top nodes
</span></span><span class=line><span class=cl>kubectl top pods
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：显示节点和 Pod 的实时资源使用</li><li><strong>场景</strong>：集群资源不足、Pod 被 OOMKilled 时排查</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 权限检查（重要！）</span>
</span></span><span class=line><span class=cl>kubectl auth can-i create pods
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：检查当前用户是否有创建 Pod 的权限</li><li><strong>场景</strong>：权限不足报错时，确认自己的权限范围</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl auth can-i <span class=s2>&#34;*&#34;</span> <span class=s2>&#34;*&#34;</span> --all-namespaces
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：检查当前用户在所有命名空间的所有权限</li><li><strong>参数说明</strong>：<code>"*"</code> 代表所有 verb 和所有 resource</li><li><strong>场景</strong>：全面了解自己的权限</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 启动临时调试 Pod</span>
</span></span><span class=line><span class=cl>kubectl run debug-pod --rm -i --tty --image<span class=o>=</span>busybox -- sh
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>参数说明</strong>：<ul><li><code>--rm</code>：退出后自动删除 Pod</li><li><code>-i --tty</code>：交互式终端</li><li><code>--image</code>：使用轻量级镜像</li><li><code>--</code> 后面是启动命令</li></ul></li><li><strong>场景</strong>：集群内网络测试、临时工具使用</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看网络策略</span>
</span></span><span class=line><span class=cl>kubectl get networkpolicies
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：查看当前命名空间的网络策略</li><li><strong>场景</strong>：网络不通时检查是否有网络策略限制</li></ul><hr><h2 id=九高级命令高效技巧>九、高级命令（高效技巧）</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 合并多个 kubeconfig 文件</span>
</span></span><span class=line><span class=cl><span class=nv>KUBECONFIG</span><span class=o>=</span>file1:file2:file3 kubectl config view --merge --flatten &gt; ~/.kube/config
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：将多个 kubeconfig 文件合并为一个</li><li><strong>环境变量</strong>：<code>KUBECONFIG</code> 用冒号分隔多个文件路径</li><li><strong>参数说明</strong>：<code>--merge</code> 合并，<code>--flatten</code> 扁平化输出</li><li><strong>场景</strong>：管理多个集群的配置整合</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 生成 YAML 模板（不实际创建）</span>
</span></span><span class=line><span class=cl>kubectl run nginx --image<span class=o>=</span>nginx --dry-run<span class=o>=</span>client -o yaml &gt; pod.yaml
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：生成资源配置的 YAML 模板，但不真正创建资源</li><li><strong>参数说明</strong>：<ul><li><code>--dry-run=client</code>：客户端试运行（不发送到 API Server）</li><li><code>-o yaml</code>：输出 YAML 格式</li></ul></li><li><strong>场景</strong>：快速生成模板，再手动修改</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 标签操作</span>
</span></span><span class=line><span class=cl>kubectl label pods &lt;pod-name&gt; <span class=nv>env</span><span class=o>=</span>prod
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：给 Pod 添加标签 <code>env=prod</code></li><li><strong>场景</strong>：资源分类、标记环境、配合选择器使用</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl label pods &lt;pod-name&gt; env-
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>语法</strong>：标签名后加 <code>-</code> 表示删除该标签</li><li><strong>场景</strong>：清理不再需要的标签</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 注解操作</span>
</span></span><span class=line><span class=cl>kubectl annotate pods &lt;pod-name&gt; <span class=nv>description</span><span class=o>=</span><span class=s2>&#34;My pod&#34;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：添加注解（Annotation），用于存储非标识性元数据</li><li><strong>场景</strong>：记录资源说明、配置信息（对人可读）</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看资源配额</span>
</span></span><span class=line><span class=cl>kubectl get resourcequota -n &lt;namespace&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：查看命名空间的资源配额限制（CPU、内存、Pod 数量等）</li><li><strong>场景</strong>：资源不足时，检查是否触发了配额限制</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看持久卷</span>
</span></span><span class=line><span class=cl>kubectl get pv
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：查看集群级别的持久卷（PersistentVolume）</li><li><strong>场景</strong>：存储管理、排查存储问题</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pvc -n &lt;namespace&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：查看命名空间的持久卷声明（PersistentVolumeClaim）</li><li><strong>场景</strong>：应用申请存储后查看绑定状态</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看 ConfigMap 和 Secret</span>
</span></span><span class=line><span class=cl>kubectl get configmaps
</span></span><span class=line><span class=cl>kubectl get secrets
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：查看配置信息和敏感信息</li><li><strong>场景</strong>：检查应用配置、验证 Secret 是否存在</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看 Secret 内容（解码）</span>
</span></span><span class=line><span class=cl>kubectl get secret &lt;secret-name&gt; -o <span class=nv>jsonpath</span><span class=o>=</span><span class=s2>&#34;{.data.password}&#34;</span> <span class=p>|</span> base64 -d
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：Secret 的值是 base64 编码的，需要解码查看明文</li><li><strong>参数说明</strong>：<code>jsonpath</code> 提取特定字段</li><li><strong>场景</strong>：查看数据库密码、Token 等敏感信息</li></ul><hr><h2 id=十常用选项速记命令行参数>十、常用选项速记（命令行参数）</h2><div class=table-wrapper><table><thead><tr><th>选项</th><th>全称</th><th>含义与用途</th></tr></thead><tbody><tr><td><code>-n</code></td><td><code>--namespace</code></td><td>指定命名空间，隔离资源范围</td></tr><tr><td><code>-A</code></td><td><code>--all-namespaces</code></td><td>查看所有命名空间，跨空间操作</td></tr><tr><td><code>-o wide</code></td><td><code>--output wide</code></td><td>显示额外信息（如节点 IP、Pod IP）</td></tr><tr><td><code>-o yaml/json</code></td><td><code>--output</code></td><td>输出完整配置，用于导出或调试</td></tr><tr><td><code>-l</code></td><td><code>--selector</code></td><td>按标签筛选资源，精准定位</td></tr><tr><td><code>--show-labels</code></td><td>&ndash;</td><td>显示资源的标签列</td></tr><tr><td><code>--sort-by</code></td><td>&ndash;</td><td>按字段排序，整理输出结果</td></tr><tr><td><code>-w</code></td><td><code>--watch</code></td><td>实时监控，观察变化</td></tr><tr><td><code>--dry-run=client</code></td><td>&ndash;</td><td>试运行，验证配置但不执行</td></tr><tr><td><code>--grace-period=0</code></td><td>&ndash;</td><td>立即删除，不等待优雅终止</td></tr></tbody></table></div><hr><h2 id=实用技巧详解>实用技巧详解</h2><h3 id=1-命令补全节省打字时间>1. <strong>命令补全（节省打字时间）</strong></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Bash 环境</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s1>&#39;source &lt;(kubectl completion bash)&#39;</span> &gt;&gt; ~/.bashrc
</span></span><span class=line><span class=cl><span class=nb>source</span> ~/.bashrc
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：输入 <code>kubectl get p</code> 后按 Tab 自动补全为 <code>pods</code></li><li><strong>生效</strong>：重新加载 bash 配置或重启终端</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Zsh 环境</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s1>&#39;source &lt;(kubectl completion zsh)&#39;</span> &gt;&gt; ~/.zshrc
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：Zsh 用户同样享受自动补全</li></ul><h3 id=2-常用别名极致偷懒>2. <strong>常用别名（极致偷懒）</strong></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>k</span><span class=o>=</span><span class=s1>&#39;kubectl&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>kg</span><span class=o>=</span><span class=s1>&#39;kubectl get&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>kgp</span><span class=o>=</span><span class=s1>&#39;kubectl get pods&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>kgs</span><span class=o>=</span><span class=s1>&#39;kubectl get svc&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>kgd</span><span class=o>=</span><span class=s1>&#39;kubectl get deploy&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>ke</span><span class=o>=</span><span class=s1>&#39;kubectl exec -it&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>kl</span><span class=o>=</span><span class=s1>&#39;kubectl logs&#39;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>作用</strong>：将长命令缩短为 2-3 个字母</li><li><strong>配置</strong>：添加到 <code>~/.bashrc</code> 或 <code>~/.zshrc</code></li></ul><h3 id=3-快速删除-evicted-pods清理僵尸>3. <strong>快速删除 Evicted Pods（清理僵尸）</strong></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods <span class=p>|</span> grep Evicted <span class=p>|</span> awk <span class=s1>&#39;{print $1}&#39;</span> <span class=p>|</span> xargs kubectl delete pod
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>执行过程</strong>：<ol><li><code>kubectl get pods</code>：获取所有 Pod</li><li><code>grep Evicted</code>：筛选状态为 Evicted 的</li><li><code>awk '{print $1}'</code>：提取 Pod 名称（第一列）</li><li><code>xargs kubectl delete pod</code>：批量删除这些 Pod</li></ol></li><li><strong>场景</strong>：节点资源不足时，大量 Pod 被驱逐，清理残留记录</li></ul><h3 id=4-清空命名空间极度危险>4. <strong>清空命名空间（极度危险！）</strong></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl delete all --all -n &lt;namespace&gt;
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>执行逻辑</strong>：删除指定命名空间内 <code>all</code> 资源类型的 <code>all</code> 实例</li><li><strong>会删除</strong>：Pod、Service、Deployment、StatefulSet 等</li><li><strong>不会删除</strong>：命名空间本身、ConfigMap、Secret（需单独删）</li><li><strong>替代方案</strong>：直接删除命名空间更彻底<div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl delete namespace &lt;namespace-name&gt;
</span></span></code></pre></td></tr></table></div></div></li></ul><hr><p><strong>文档说明</strong>：本指南基于 Kubernetes 2024 年版本整理，建议根据实际集群版本使用 <code>kubectl --help</code> 查看最新参数。</p></section><footer class=article-footer><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>本文采用 CC BY-NC-SA 4.0 许可协议</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/posts/kali/><div class=article-details><h2 class=article-title>Kali</h2></div></a></article><article><a href=/k8s/kubernetes%E7%94%9F%E4%BA%A7%E7%BA%A7%E5%AE%8C%E6%95%B4%E5%AE%9E%E6%88%98%E6%8C%87%E5%8D%97/><div class=article-details><h2 class=article-title>Kubernetes 生产级完整实战指南</h2></div></a></article><article><a href=/k8s/pod%E6%8E%92%E6%9F%A5%E6%89%8B%E5%86%8C/><div class=article-details><h2 class=article-title>Kubernetes Pod</h2></div></a></article><article><a href=/posts/linux%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/><div class=article-details><h2 class=article-title>linux日志分析</h2></div></a></article><article><a href=/posts/gitgithub/><div class=article-details><h2 class=article-title>Git&amp;Github</h2></div></a></article></div></div></aside><script src=https://giscus.app/client.js data-repo data-repo-id data-category data-category-id data-mapping=title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=en data-loading crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark_dimmed")}})()</script><footer class=site-footer><section class=copyright>&copy;
2025 © 2025 win. 保留所有权利.</section><section class=powerby>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 构建<br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.31.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>