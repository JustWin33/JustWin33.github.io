<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Pod排查手册 一、快速诊断问题原因 1.1 检查 Pod 是否真实存在 命令1：kubectl get pods 命令说明：\n1 kubectl get pods [pod-name] [-n namespace] [flags] kubectl get：获取资源列表的基本命令 pods：指定资源类型为 Pod 默认范围：当前命名空间（由 kubeconfig 上下文决定） 无参数时：列出当前命名空间下所有 Pod 的名称、状态等基本信息 作用： 快速查看当前命名空间下是否存在目标 Pod，以及其当前状态（Running/Pending/CrashLoopBackOff 等）\n"><title>Kubernetes Pod</title><link rel=canonical href=http://localhost:1313/k8s/pod%E6%8E%92%E6%9F%A5%E6%89%8B%E5%86%8C/><link rel=stylesheet href=/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css><meta property='og:title' content="Kubernetes Pod"><meta property='og:description' content="Pod排查手册 一、快速诊断问题原因 1.1 检查 Pod 是否真实存在 命令1：kubectl get pods 命令说明：\n1 kubectl get pods [pod-name] [-n namespace] [flags] kubectl get：获取资源列表的基本命令 pods：指定资源类型为 Pod 默认范围：当前命名空间（由 kubeconfig 上下文决定） 无参数时：列出当前命名空间下所有 Pod 的名称、状态等基本信息 作用： 快速查看当前命名空间下是否存在目标 Pod，以及其当前状态（Running/Pending/CrashLoopBackOff 等）\n"><meta property='og:url' content='http://localhost:1313/k8s/pod%E6%8E%92%E6%9F%A5%E6%89%8B%E5%86%8C/'><meta property='og:site_name' content='JustWin'><meta property='og:type' content='article'><meta property='article:section' content='K8s'><meta property='article:published_time' content='2025-11-12T00:00:00+00:00'><meta property='article:modified_time' content='2025-11-12T00:00:00+00:00'><meta property='og:image' content='http://localhost:1313/'><meta name=twitter:title content="Kubernetes Pod"><meta name=twitter:description content="Pod排查手册 一、快速诊断问题原因 1.1 检查 Pod 是否真实存在 命令1：kubectl get pods 命令说明：\n1 kubectl get pods [pod-name] [-n namespace] [flags] kubectl get：获取资源列表的基本命令 pods：指定资源类型为 Pod 默认范围：当前命名空间（由 kubeconfig 上下文决定） 无参数时：列出当前命名空间下所有 Pod 的名称、状态等基本信息 作用： 快速查看当前命名空间下是否存在目标 Pod，以及其当前状态（Running/Pending/CrashLoopBackOff 等）\n"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='http://localhost:1313/'><link rel=stylesheet href=/css/custom.css><link rel="shortcut icon" href=/favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"light")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/images/avatar_hu_89ca753ea8ea85c7.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>✍️</span></figure><div class=site-meta><h1 class=site-name><a href=/>JustWin</a></h1><h2 class=site-description>分享技术与生活</h2></div></header><ol class=menu-social><li><a href=https://github.com/passion-win target=_blank title=GitHub rel=me><svg width="800" height="800" viewBox="0 0 20 20" xmlns:xlink="http://www.w3.org/1999/xlink"><title>github [#142]</title><desc>Created with Sketch.</desc><defs/><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Dribbble-Light-Preview" transform="translate(-140.000000, -7559.000000)" fill="#000"><g id="icons" transform="translate(56.000000, 160.000000)"><path d="M94 7399C99.523 7399 104 7403.59 104 7409.253 104 7413.782 101.138 7417.624 97.167 7418.981 96.66 7419.082 96.48 7418.762 96.48 7418.489 96.48 7418.151 96.492 7417.047 96.492 7415.675 96.492 7414.719 96.172 7414.095 95.813 7413.777 98.04 7413.523 100.38 7412.656 100.38 7408.718 100.38 7407.598 99.992 7406.684 99.35 7405.966 99.454 7405.707 99.797 7404.664 99.252 7403.252 99.252 7403.252 98.414 7402.977 96.505 7404.303 95.706 7404.076 94.85 7403.962 94 7403.958 93.15 7403.962 92.295 7404.076 91.497 7404.303 89.586 7402.977 88.746 7403.252 88.746 7403.252 88.203 7404.664 88.546 7405.707 88.649 7405.966 88.01 7406.684 87.619 7407.598 87.619 7408.718 87.619 7412.646 89.954 7413.526 92.175 7413.785 91.889 7414.041 91.63 7414.493 91.54 7415.156 90.97 7415.418 89.522 7415.871 88.63 7414.304 88.63 7414.304 88.101 7413.319 87.097 7413.247 87.097 7413.247 86.122 7413.234 87.029 7413.87 87.029 7413.87 87.684 7414.185 88.139 7415.37 88.139 7415.37 88.726 7417.2 91.508 7416.58 91.513 7417.437 91.522 7418.245 91.522 7418.489 91.522 7418.76 91.338 7419.077 90.839 7418.982 86.865 7417.627 84 7413.783 84 7409.253 84 7403.59 88.478 7399 94 7399" id="github-[#142]"/></g></g></g></svg></a></li><li><a href=https://t.me/+TFjBeZzowwU1YTY1 target=_blank title=telegram rel=me><svg viewBox="0 0 640 640"><path d="M320 72C183 72 72 183 72 320S183 568 320 568 568 457 568 320 457 72 320 72zM435 240.7C431.3 279.9 415.1 375.1 406.9 419c-3.5 18.6-10.3 24.8-16.9 25.4C375.6 445.7 364.7 434.9 350.7 425.7c-21.8-14.3-34.2-23.2-55.3-37.2C270.9 372.4 286.8 363.5 300.7 349 304.4 345.2 367.8 287.5 369 282.3 369.2 281.6 369.3 279.2 367.8 277.9 366.3 276.6 364.2 277.1 362.7 277.4 360.5 277.9 325.6 300.9 258.1 346.5 248.2 353.3 239.2 356.6 231.2 356.4 222.3 356.2 205.3 351.4 192.6 347.3 177.1 342.3 164.7 339.6 165.8 331 166.4 326.5 172.5 322 184.2 317.3 256.5 285.8 304.7 265 328.8 255c68.9-28.6 83.2-33.6 92.5-33.8C423.4 221.2 427.9 221.7 430.9 224.1 432.9 225.8 434.1 228.2 434.4 230.8 434.9 234 435 237.3 434.8 240.6z"/></svg></a></li><li><a href=https://twitter.com/@win1688888888 target=_blank title=twitter rel=me><svg width="800" height="800" viewBox="0 -2 20 20" xmlns:xlink="http://www.w3.org/1999/xlink"><title>twitter [#154]</title><desc>Created with Sketch.</desc><defs/><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Dribbble-Light-Preview" transform="translate(-60.000000, -7521.000000)" fill="#000"><g id="icons" transform="translate(56.000000, 160.000000)"><path d="M10.29 7377C17.837 7377 21.965 7370.84365 21.965 7365.50546 21.965 7365.33021 21.965 7365.15595 21.953 7364.98267 22.756 7364.41163 23.449 7363.70276 24 7362.8915 23.252 7363.21837 22.457 7363.433 21.644 7363.52751 22.5 7363.02244 23.141 7362.2289 23.448 7361.2926 22.642 7361.76321 21.761 7362.095 20.842 7362.27321 19.288 7360.64674 16.689 7360.56798 15.036 7362.09796 13.971 7363.08447 13.518 7364.55538 13.849 7365.95835 10.55 7365.79492 7.476 7364.261 5.392 7361.73762 4.303 7363.58363 4.86 7365.94457 6.663 7367.12996 6.01 7367.11125 5.371 7366.93797 4.8 7366.62489V7366.67608C4.801 7368.5989 6.178 7370.2549 8.092 7370.63591 7.488 7370.79836 6.854 7370.82199 6.24 7370.70483 6.777 7372.35099 8.318 7373.47829 10.073 7373.51078 8.62 7374.63513 6.825 7375.24554 4.977 7375.24358 4.651 7375.24259 4.325 7375.22388 4 7375.18549 5.877 7376.37088 8.06 7377 10.29 7376.99705" id="twitter-[#154]"/></g></g></g></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><span>首页</span></a></li><li><a href=/links/><span>网站</span></a></li><li><a href=/linux/><span>Linux</span></a></li><li><a href=/docker/><span>docker</span></a></li><li><a href=/k8s/><span>k8s</span></a></li><li><a href=/mysql/><span>mysql</span></a></li><li><a href=/project/><span>项目</span></a></li><li><a href=/about/><span>关于</span></a></li><li class=menu-bottom-section><ol class=menu><li id=i18n-switch><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language title=language onchange="window.location.href=this.selectedOptions[0].value"><option value=http://localhost:1313/ selected>中文</option><option value=http://localhost:1313/en/>English</option></select></li><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>暗色模式</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#一快速诊断问题原因>一、快速诊断问题原因</a><ol><li><a href=#11-检查-pod-是否真实存在>1.1 检查 Pod 是否真实存在</a><ol><li><a href=#命令1kubectl-get-pods>命令1：<code>kubectl get pods</code></a></li><li><a href=#命令2kubectl-get-pods--a>命令2：<code>kubectl get pods -A</code></a></li><li><a href=#命令3kubectl-get-pods--a--grep-nginx>命令3：<code>kubectl get pods -A | grep nginx</code></a></li></ol></li><li><a href=#12-确认当前上下文与命名空间>1.2 确认当前上下文与命名空间</a><ol><li><a href=#命令4kubectl-config-view---minify---output-jsonpathnamespace>命令4：<code>kubectl config view --minify --output 'jsonpath={..namespace}'</code></a></li><li><a href=#命令5kubectl-config-get-contexts>命令5：<code>kubectl config get-contexts</code></a></li></ol></li><li><a href=#13-验证集群连接状态>1.3 验证集群连接状态</a><ol><li><a href=#命令6kubectl-cluster-info>命令6：<code>kubectl cluster-info</code></a></li><li><a href=#命令7kubectl-get-nodes>命令7：<code>kubectl get nodes</code></a></li></ol></li></ol></li><li><a href=#二针对性解决方案>二、针对性解决方案</a><ol><li><a href=#场景-1pod-尚未创建最常见>场景 1：Pod 尚未创建（最常见）</a><ol><li><a href=#命令8kubectl-run-nginx-pod---imagenginx125---port80>命令8：<code>kubectl run nginx-pod --image=nginx:1.25 --port=80</code></a></li><li><a href=#命令9yaml-方式创建-pod>命令9：YAML 方式创建 Pod</a></li><li><a href=#命令10kubectl-get-pods-nginx-pod--w>命令10：<code>kubectl get pods nginx-pod -w</code></a></li></ol></li><li><a href=#场景-2pod-存在于其他命名空间>场景 2：Pod 存在于其他命名空间</a><ol><li><a href=#命令11kubectl-get-pods--a---field-selector-metadatanamenginx-pod>命令11：<code>kubectl get pods -A --field-selector metadata.name=nginx-pod</code></a></li><li><a href=#命令12kubectl-logs-nginx-pod--n-project-a>命令12：<code>kubectl logs nginx-pod -n project-a</code></a></li></ol></li><li><a href=#场景-3pod-已被删除>场景 3：Pod 已被删除</a><ol><li><a href=#命令13kubectl-get-events---field-selector-involvedobjectnamenginx-pod>命令13：<code>kubectl get events --field-selector involvedObject.name=nginx-pod</code></a></li></ol></li><li><a href=#场景-4名称拼写错误>场景 4：名称拼写错误</a><ol><li><a href=#命令14kubectl-get-pods--a--grep--i-nginx>命令14：<code>kubectl get pods -A | grep -i nginx</code></a></li></ol></li></ol></li><li><a href=#三查看日志的正确命令>三、查看日志的正确命令</a><ol><li><a href=#命令15kubectl-logs-nginx-pod>命令15：<code>kubectl logs nginx-pod</code></a></li><li><a href=#命令16kubectl-logs--f-nginx-pod>命令16：<code>kubectl logs -f nginx-pod</code></a></li><li><a href=#命令17kubectl-logs---tail100-nginx-pod>命令17：<code>kubectl logs --tail=100 nginx-pod</code></a></li><li><a href=#命令18kubectl-logs-nginx-pod--c-sidecar>命令18：<code>kubectl logs nginx-pod -c sidecar</code></a></li><li><a href=#命令19kubectl-logs---previous-nginx-pod>命令19：<code>kubectl logs --previous nginx-pod</code></a></li></ol></li><li><a href=#四生产环境建议>四、生产环境建议</a><ol><li><a href=#41-避免手动创建-pod>4.1 避免手动创建 Pod</a><ol><li><a href=#命令20kubectl-create-deployment-nginx-deploy---imagenginx125---replicas2>命令20：<code>kubectl create deployment nginx-deploy --image=nginx:1.25 --replicas=2</code></a></li><li><a href=#命令21kubectl-get-pods--l-appnginx-deploy>命令21：<code>kubectl get pods -l app=nginx-deploy</code></a></li><li><a href=#命令22kubectl-logs--l-appnginx-deploy>命令22：<code>kubectl logs -l app=nginx-deploy</code></a></li></ol></li><li><a href=#42-常用别名与快捷方式>4.2 常用别名与快捷方式</a><ol><li><a href=#命令23配置-shell-别名>命令23：配置 Shell 别名</a></li></ol></li><li><a href=#43-调试技巧>4.3 调试技巧</a><ol><li><a href=#命令24kubectl-describe-pod-nginx-pod>命令24：<code>kubectl describe pod nginx-pod</code></a></li></ol></li></ol></li><li><a href=#五快速检查清单>五、快速检查清单</a><ol><li><a href=#完整排查流程含命令详解>完整排查流程（含命令详解）</a></li><li><a href=#生产环境标准排查命令集>生产环境标准排查命令集</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category></header><div class=article-title-wrapper><h2 class=article-title><a href=/k8s/pod%E6%8E%92%E6%9F%A5%E6%89%8B%E5%86%8C/>Kubernetes Pod</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2025-11-12</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>阅读时长: 12 分钟</time></div></footer></div></header><section class=article-content><h1 id=pod排查手册>Pod排查手册</h1><h2 id=一快速诊断问题原因>一、快速诊断问题原因</h2><h3 id=11-检查-pod-是否真实存在>1.1 检查 Pod 是否真实存在</h3><h4 id=命令1kubectl-get-pods>命令1：<code>kubectl get pods</code></h4><p><strong>命令说明</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods <span class=o>[</span>pod-name<span class=o>]</span> <span class=o>[</span>-n namespace<span class=o>]</span> <span class=o>[</span>flags<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><code>kubectl get</code>：获取资源列表的基本命令</li><li><code>pods</code>：指定资源类型为 Pod</li><li>默认范围：<strong>当前命名空间</strong>（由 kubeconfig 上下文决定）</li><li><strong>无参数时</strong>：列出当前命名空间下所有 Pod 的名称、状态等基本信息</li></ul><p><strong>作用</strong>：
快速查看当前命名空间下是否存在目标 Pod，以及其当前状态（Running/Pending/CrashLoopBackOff 等）</p><p><strong>输出解读</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>NAME        READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>nginx-pod   1/1     Running   0          5m
</span></span></code></pre></td></tr></table></div></div><ul><li><strong>READY</strong>：1/1 表示 1 个容器中有 1 个就绪</li><li><strong>STATUS</strong>：Running 表示正常运行</li><li><strong>RESTARTS</strong>：重启次数，0 表示未重启</li><li><strong>AGE</strong>：运行时长</li></ul><p><strong>如果输出为空</strong>：
说明当前命名空间下<strong>没有任何 Pod</strong>，或 Pod 名称拼写错误</p><hr><h4 id=命令2kubectl-get-pods--a>命令2：<code>kubectl get pods -A</code></h4><p><strong>命令说明</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods --all-namespaces
</span></span><span class=line><span class=cl><span class=c1># 或简写为</span>
</span></span><span class=line><span class=cl>kubectl get pods -A
</span></span></code></pre></td></tr></table></div></div><ul><li><code>-A</code>/<code>--all-namespaces</code>：<strong>全局查询</strong>，跨所有命名空间</li></ul><p><strong>作用</strong>：
当不确定 Pod 所在命名空间时，全局扫描所有命名空间下的 Pod 列表</p><p><strong>典型输出</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>NAMESPACE     NAME                               READY   STATUS
</span></span><span class=line><span class=cl>default       nginx-pod                          1/1     Running
</span></span><span class=line><span class=cl>kube-system   coredns-6d8c4cb59d-abcde           1/1     Running
</span></span><span class=line><span class=cl>kube-system   etcd-master                        1/1     Running
</span></span><span class=line><span class=cl>kube-system   kube-apiserver-master              1/1     Running
</span></span></code></pre></td></tr></table></div></div><p><strong>权限要求</strong>：</p><ul><li>需要 <strong>ClusterRole</strong> 的 <code>list</code> 权限对所有命名空间生效</li><li>生产环境默认用户通常只有特定 namespace 权限，执行 <code>-A</code> 可能报 <strong>Forbidden</strong></li></ul><p><strong>安全注意事项</strong>：</p><ul><li>全局查询会<strong>暴露集群所有 Pod 信息</strong>，包括 kube-system 等系统组件</li><li>审计日志会记录此操作，遵守最小权限原则，非必要不使用</li></ul><hr><h4 id=命令3kubectl-get-pods--a--grep-nginx>命令3：<code>kubectl get pods -A | grep nginx</code></h4><p><strong>命令说明</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods --all-namespaces <span class=p>|</span> grep <span class=o>[</span>pattern<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><code>|</code>：Linux 管道符，将前一个命令的输出作为后一个命令的输入</li><li><code>grep nginx</code>：文本过滤，仅显示包含 &ldquo;nginx&rdquo; 的行</li></ul><p><strong>作用</strong>：
在全局 Pod 列表中<strong>快速定位</strong>包含特定关键词（如 nginx）的 Pod，应对不记得完整名称的场景</p><p><strong>输出示例</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>default       nginx-pod                          1/1     Running
</span></span><span class=line><span class=cl>project-a     nginx-deployment-67d4bdd6f5-cx2nz  1/1     Running
</span></span></code></pre></td></tr></table></div></div><p><strong>预期结果分析</strong>：</p><ul><li><strong>列表为空</strong> → <strong>Pod 从未创建</strong>，需进入"场景1"处理</li><li><strong>有相似名称</strong> → 可能是<strong>拼写错误</strong>（如 nginx-pod-7788ff99c6-abcde），进入"场景4"</li><li><strong>在其他 namespace</strong> → 进入"场景2"，需指定 <code>-n</code> 参数</li></ul><hr><h3 id=12-确认当前上下文与命名空间>1.2 确认当前上下文与命名空间</h3><h4 id=命令4kubectl-config-view---minify---output-jsonpathnamespace>命令4：<code>kubectl config view --minify --output 'jsonpath={..namespace}'</code></h4><p><strong>命令说明</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl config view              <span class=c1># 查看完整 kubeconfig 配置</span>
</span></span><span class=line><span class=cl>         --minify                <span class=c1># 仅显示当前上下文信息</span>
</span></span><span class=line><span class=cl>         --output <span class=s1>&#39;jsonpath=...&#39;</span> <span class=c1># 使用 JSONPath 提取 namespace 字段</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>作用</strong>：
精准获取<strong>当前默认命名空间</strong>，避免因上下文切换错误导致的"找不到 Pod"问题</p><p><strong>输出示例</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># 如果设置了命名空间
</span></span><span class=line><span class=cl>project-a
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 如果未设置（默认返回空）
</span></span><span class=line><span class=cl>[空]
</span></span></code></pre></td></tr></table></div></div><p><strong>空输出时</strong>：默认命名空间为 <code>default</code></p><p><strong>权限要求</strong>：</p><ul><li>仅读取本地 <code>~/.kube/config</code> 文件，<strong>无需集群权限</strong></li><li>但配置文件需有<strong>可读权限</strong>（通常 600 或 644）</li></ul><p><strong>安全注意事项</strong>：</p><ul><li>kubeconfig 文件包含<strong>集群访问凭证</strong>，权限必须严格限制（建议 600）</li><li>不要在共享目录存放含有 token 的 kubeconfig</li></ul><hr><h4 id=命令5kubectl-config-get-contexts>命令5：<code>kubectl config get-contexts</code></h4><p><strong>命令说明</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl config get-contexts          <span class=c1># 列出所有上下文</span>
</span></span><span class=line><span class=cl>kubectl config current-context       <span class=c1># 显示当前活跃上下文</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>作用</strong>：</p><ul><li><strong>验证是否连接到正确的集群</strong></li><li>上下文包含：集群地址、用户、命名空间三元组</li><li>活跃上下文标记为 <code>*</code></li></ul><p><strong>输出示例</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>CURRENT   NAME             CLUSTER          AUTHINFO         NAMESPACE
</span></span><span class=line><span class=cl>*         prod-cluster     prod.k8s.local   prod-admin       default
</span></span><span class=line><span class=cl>          test-cluster     test.k8s.local   test-user        test-env
</span></span></code></pre></td></tr></table></div></div><p><strong>常见错误场景</strong>：</p><ul><li>上下文指向 <strong>test 集群</strong>，但用户在 <strong>prod 集群</strong>查找 Pod</li><li>切换上下文命令：<code>kubectl config use-context prod-cluster</code></li></ul><hr><h3 id=13-验证集群连接状态>1.3 验证集群连接状态</h3><h4 id=命令6kubectl-cluster-info>命令6：<code>kubectl cluster-info</code></h4><p><strong>命令说明</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl cluster-info          <span class=c1># 显示集群核心组件地址</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>作用</strong>：
<strong>快速诊断</strong> kubeconfig 配置是否正确、API Server 是否可达</p><p><strong>正常输出</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Kubernetes control plane is running at https://192.168.1.100:6443
</span></span><span class=line><span class=cl>CoreDNS is running at https://192.168.1.100:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy
</span></span></code></pre></td></tr></table></div></div><p><strong>错误输出</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>The connection to the server localhost:8080 was refused - did you specify the right host or port?
</span></span></code></pre></td></tr></table></div></div><p>→ <strong>kubeconfig 未配置</strong>或<strong>API Server 未启动</strong></p><p><strong>权限要求</strong>：</p><ul><li>仅需<strong>匿名访问</strong>或<strong>最小只读权限</strong></li><li>如果提示 Unauthorized，说明证书或 token 错误</li></ul><hr><h4 id=命令7kubectl-get-nodes>命令7：<code>kubectl get nodes</code></h4><p><strong>命令说明</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get nodes <span class=o>[</span>-o wide<span class=o>]</span> <span class=o>[</span>node-name<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>作用</strong>：</p><ul><li>验证<strong>集群基础设施状态</strong></li><li>确保至少有一个 Ready 节点可供调度</li></ul><p><strong>典型输出</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>NAME         STATUS   ROLES           AGE   VERSION
</span></span><span class=line><span class=cl>k8s-master   Ready    control-plane   30d   v1.28.0
</span></span><span class=line><span class=cl>k8s-worker1  Ready    &lt;none&gt;          30d   v1.28.0
</span></span><span class=line><span class=cl>k8s-worker2  Ready    &lt;none&gt;          30d   v1.28.0
</span></span></code></pre></td></tr></table></div></div><p><strong>关键排查点</strong>：</p><ul><li><strong>STATUS = NotReady</strong>：节点故障，所有 Pod 无法运行</li><li><strong>ROLES = master</strong>：是否为仅有 master 节点的单节点集群？</li><li><strong>NoSchedule 污点</strong>： master 节点默认有污点，普通 Pod 无法调度</li></ul><hr><h2 id=二针对性解决方案>二、针对性解决方案</h2><h3 id=场景-1pod-尚未创建最常见>场景 1：Pod 尚未创建（最常见）</h3><h4 id=命令8kubectl-run-nginx-pod---imagenginx125---port80>命令8：<code>kubectl run nginx-pod --image=nginx:1.25 --port=80</code></h4><p><strong>命令说明</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl run <span class=o>[</span>pod-name<span class=o>]</span> --image<span class=o>=[</span>image<span class=o>]</span> <span class=o>[</span>--port<span class=o>=</span>port<span class=o>]</span> <span class=o>[</span>--restart<span class=o>=</span>Never<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><code>kubectl run</code>：<strong>快速创建 Pod/Deployment</strong> 的命令</li><li><code>--image</code>：指定容器镜像（Docker Hub 或私有仓库）</li><li><code>--port</code>：声明容器暴露的端口（仅作为文档，不实际创建 Service）</li><li><code>--restart=Never</code>：创建独立 Pod（默认会创建 Deployment）</li></ul><p><strong>作用</strong>：
在测试环境中<strong>快速拉起</strong>一个 Nginx 容器，验证集群基本功能</p><p><strong>输出</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>pod/nginx-pod created
</span></span></code></pre></td></tr></table></div></div><p><strong>权限要求</strong>：</p><ul><li>需要 <strong>Role</strong> 权限：<code>pods/create</code></li><li>生产环境通常<strong>禁止</strong>普通用户直接创建 Pod（通过 RBAC 限制）</li></ul><p><strong>安全注意事项</strong>：</p><ul><li><strong>镜像拉取策略</strong>：默认 <code>IfNotPresent</code>，可能拉取到被污染的镜像</li><li><strong>镜像签名</strong>：生产环境应启用镜像签名验证（如 Cosign）</li><li><strong>资源限制</strong>：未设置 limits，可能耗尽节点资源</li></ul><hr><h4 id=命令9yaml-方式创建-pod>命令9：YAML 方式创建 Pod</h4><p><strong>YAML 配置说明</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1         </span><span class=w> </span><span class=c># API 版本，v1 表示核心资源</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Pod              </span><span class=w> </span><span class=c># 资源类型为 Pod</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>               </span><span class=c># 元数据</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nginx-pod      </span><span class=w> </span><span class=c># Pod 名称，集群内唯一</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>               </span><span class=c># 标签，用于 Service 选择</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>nginx</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>                   </span><span class=c># Pod 规约</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>containers</span><span class=p>:</span><span class=w>           </span><span class=c># 容器列表</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nginx        </span><span class=w> </span><span class=c># 容器名称</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class=l>nginx:1.25  </span><span class=w> </span><span class=c># 精确版本号，避免 latest 歧义</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>80</span><span class=w> </span><span class=c># 容器内部端口</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>resources</span><span class=p>:</span><span class=w>          </span><span class=c># 资源限制（生产必需）</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>requests</span><span class=p>:</span><span class=w>         </span><span class=c># 请求资源（调度依据）</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;100m&#34;</span><span class=w>     </span><span class=c># 100 毫核，1 核 = 1000m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;128Mi&#34;</span><span class=w> </span><span class=c># 128 MiB</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>limits</span><span class=p>:</span><span class=w>           </span><span class=c># 限制资源（防止耗尽）</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;200m&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;256Mi&#34;</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>作用</strong>：</p><ul><li><strong>声明式部署</strong>：YAML 是生产环境标准方式</li><li><strong>版本控制</strong>：可放入 Git，实现 Infrastructure as Code</li><li><strong>可复用性</strong>：便于修改和批量创建</li></ul><p><strong>创建命令</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl apply -f nginx-pod.yaml    <span class=c1># 推荐：支持后续更新</span>
</span></span><span class=line><span class=cl><span class=c1># 或</span>
</span></span><span class=line><span class=cl>kubectl create -f nginx-pod.yaml   <span class=c1># 仅创建，重复执行会报错</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>权限要求</strong>：</p><ul><li><code>pods/create</code> + <code>pods/update</code>（对于 apply）</li><li>建议通过 CI/CD 流水线执行，<strong>禁止</strong>直接在生产集群手动 apply</li></ul><hr><h4 id=命令10kubectl-get-pods-nginx-pod--w>命令10：<code>kubectl get pods nginx-pod -w</code></h4><p><strong>命令说明</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods <span class=o>[</span>pod-name<span class=o>]</span> -w
</span></span><span class=line><span class=cl><span class=c1># -w = --watch，实时监视资源变化</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>作用</strong>：
<strong>持续跟踪</strong> Pod 状态，观察从 Pending → Running 的完整过程，快速定位卡在哪个阶段</p><p><strong>典型输出流</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>NAME        READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>nginx-pod   0/1     Pending   0          0s
</span></span><span class=line><span class=cl>nginx-pod   0/1     ContainerCreating   0          2s
</span></span><span class=line><span class=cl>nginx-pod   1/1     Running             0          8s
</span></span></code></pre></td></tr></table></div></div><p><strong>状态分析</strong>：</p><ul><li><strong>Pending</strong>：调度中，可能资源不足、镜像拉取中</li><li><strong>ContainerCreating</strong>：正在创建容器，可能拉取镜像慢</li><li><strong>Running</strong>：成功运行</li></ul><p><strong>排错提示</strong>：
若长时间卡在 Pending，立即执行 <code>kubectl describe pod nginx-pod</code> 查看 Events</p><hr><h3 id=场景-2pod-存在于其他命名空间>场景 2：Pod 存在于其他命名空间</h3><h4 id=命令11kubectl-get-pods--a---field-selector-metadatanamenginx-pod>命令11：<code>kubectl get pods -A --field-selector metadata.name=nginx-pod</code></h4><p><strong>命令说明</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods --all-namespaces --field-selector <span class=o>[</span>field<span class=o>]=[</span>value<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><ul><li><code>--field-selector</code>：<strong>按字段精确过滤</strong>，比 grep 更高效（服务端过滤）</li></ul><p><strong>作用</strong>：
<strong>精准查询</strong>指定名称的 Pod 存在于哪个命名空间，避免 grep 误匹配</p><p><strong>输出</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>NAMESPACE   NAME        READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>project-a   nginx-pod   1/1     Running   0          5m
</span></span></code></pre></td></tr></table></div></div><p><strong>权限要求</strong>：</p><ul><li>需要 <strong>ClusterRole</strong> 的 <code>list</code> 权限</li><li>普通用户可能报 Forbidden</li></ul><hr><h4 id=命令12kubectl-logs-nginx-pod--n-project-a>命令12：<code>kubectl logs nginx-pod -n project-a</code></h4><p><strong>命令说明</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl logs <span class=o>[</span>pod-name<span class=o>]</span> -n <span class=o>[</span>namespace<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=c1># -n = --namespace，指定命名空间</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>作用</strong>：
<strong>跨命名空间</strong>查看 Pod 日志，解决因 namespace 错误导致的日志查询失败</p><p><strong>权限要求</strong>：</p><ul><li>需要 <strong>Role</strong> 权限：<code>pods/log</code>（在目标 namespace）</li><li>即使 <code>pods/get</code> 权限不足，只要显式指定 <code>-n</code> 且有 <code>pods/log</code> 权限即可</li></ul><p><strong>注意事项</strong>：</p><ul><li>若忘记 <code>-n</code>，默认查询当前上下文 namespace，导致 NotFound</li><li><strong>最佳实践</strong>：总是显式指定 <code>-n</code>，避免依赖上下文</li></ul><hr><h3 id=场景-3pod-已被删除>场景 3：Pod 已被删除</h3><h4 id=命令13kubectl-get-events---field-selector-involvedobjectnamenginx-pod>命令13：<code>kubectl get events --field-selector involvedObject.name=nginx-pod</code></h4><p><strong>命令说明</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get events                          <span class=c1># 获取集群事件</span>
</span></span><span class=line><span class=cl>         --field-selector involvedObject.name<span class=o>=[</span>pod-name<span class=o>]</span>  <span class=c1># 过滤特定 Pod 的事件</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>作用</strong>：
<strong>回溯历史</strong>，查看 Pod 的完整生命周期事件，包括创建、调度、删除等</p><p><strong>典型输出</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>LAST SEEN   TYPE     REASON      OBJECT         MESSAGE
</span></span><span class=line><span class=cl>5m          Normal   Scheduled   pod/nginx-pod   Successfully assigned default/nginx-pod to worker1
</span></span><span class=line><span class=cl>4m          Normal   Pulling     pod/nginx-pod   Pulling image &#34;nginx:1.25&#34;
</span></span><span class=line><span class=cl>4m          Normal   Pulled      pod/nginx-pod   Successfully pulled image
</span></span><span class=line><span class=cl>4m          Normal   Created     pod/nginx-pod   Created container nginx
</span></span><span class=line><span class=cl>4m          Normal   Started     pod/nginx-pod   Started container nginx
</span></span><span class=line><span class=cl>2m          Normal   Killing     pod/nginx-pod   Stopping container nginx
</span></span><span class=line><span class=cl>2m          Normal   Deleted     pod/nginx-pod   Pod deleted by user &#34;admin&#34;
</span></span></code></pre></td></tr></table></div></div><p><strong>关键事件</strong>：</p><ul><li><strong>Deleted</strong>：明确显示 Pod 被删除</li><li><strong>Killing</strong>：容器被终止</li></ul><p><strong>权限要求</strong>：</p><ul><li>需要 <strong>ClusterRole</strong> 的 <code>events/list</code> 权限</li><li>事件默认保留 1 小时（可由 <code>--event-ttl</code> 配置）</li></ul><p><strong>注意事项</strong>：</p><ul><li>事件存储在 etcd，<strong>不支持长期审计</strong>，如需持久化需接入外部系统（如 ELK）</li><li>若未找到 Deleted 事件，可能 Pod <strong>从未创建成功</strong></li></ul><hr><h3 id=场景-4名称拼写错误>场景 4：名称拼写错误</h3><h4 id=命令14kubectl-get-pods--a--grep--i-nginx>命令14：<code>kubectl get pods -A | grep -i nginx</code></h4><p><strong>命令说明</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>grep -i <span class=o>[</span>pattern<span class=o>]</span>      <span class=c1># -i = --ignore-case，不区分大小写</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>作用</strong>：
<strong>模糊匹配</strong> Pod 名称，快速找到相似名称，解决大小写、后缀差异问题</p><p><strong>典型输出</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>default       nginx-Pod                          1/1     Running  # 大小写差异
</span></span><span class=line><span class=cl>default       nginx-pod-7788ff99c6-abcde         1/1     Running  # Deployment 生成的 Pod
</span></span><span class=line><span class=cl>default       my-nginx-app                       1/1     Running  # 包含关键词
</span></span></code></pre></td></tr></table></div></div><p><strong>后续操作</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 找到正确名称后，查询日志</span>
</span></span><span class=line><span class=cl>kubectl logs nginx-pod-7788ff99c6-abcde
</span></span></code></pre></td></tr></table></div></div><p><strong>注意事项</strong>：</p><ul><li>grep 是<strong>客户端过滤</strong>，会先获取所有 Pod 再过滤，大集群性能差</li><li>生产环境建议使用 <code>--field-selector</code> 替代 grep</li></ul><hr><h2 id=三查看日志的正确命令>三、查看日志的正确命令</h2><h3 id=命令15kubectl-logs-nginx-pod>命令15：<code>kubectl logs nginx-pod</code></h3><p><strong>命令说明</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl logs <span class=o>[</span>pod-name<span class=o>]</span> <span class=o>[</span>-c container-name<span class=o>]</span> <span class=o>[</span>-n namespace<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>作用</strong>：
获取 Pod 中容器的**标准输出（stdout）和标准错误（stderr）**日志</p><p><strong>输出示例</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>2025/01/15 10:30:15 [notice] 1#1: using the &#34;epoll&#34; event method
</span></span><span class=line><span class=cl>2025/01/15 10:30:15 [notice] 1#1: nginx/1.25.1
</span></span><span class=line><span class=cl>2025/01/15 10:30:15 [notice] 1#1: start worker processes
</span></span></code></pre></td></tr></table></div></div><p><strong>权限要求</strong>：</p><ul><li>需要 <strong>Role</strong> 权限：<code>pods/log</code></li><li>默认 Role <code>edit</code> 包含此权限，<code>view</code> 也包含</li></ul><p><strong>注意事项</strong>：</p><ul><li>仅显示<strong>当前运行</strong>容器的日志，崩溃重启后旧日志丢失（需用 <code>--previous</code>）</li><li>日志存储在节点 <code>/var/log/pods/</code> 目录，受节点磁盘空间限制</li></ul><hr><h3 id=命令16kubectl-logs--f-nginx-pod>命令16：<code>kubectl logs -f nginx-pod</code></h3><p><strong>命令说明</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl logs --follow <span class=o>[</span>pod-name<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=c1># -f = --follow，实时流式传输</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>作用</strong>：
<strong>持续监视</strong>日志输出，类似 <code>tail -f</code>，用于观察实时请求或调试线上问题</p><p><strong>使用场景</strong>：</p><ul><li>观察用户请求处理日志</li><li>监控错误发生时机</li><li>性能压测时实时查看</li></ul><p><strong>退出方式</strong>：
按 <code>Ctrl+C</code> 终止</p><p><strong>权限要求</strong>：
同 <code>pods/log</code>，但会<strong>保持长连接</strong>，防火墙需允许 WebSocket 连接</p><p><strong>注意事项</strong>：</p><ul><li>长时间运行可能<strong>消耗较多网络带宽</strong></li><li>若 Pod 重启，连接会中断，需重新执行命令</li></ul><hr><h3 id=命令17kubectl-logs---tail100-nginx-pod>命令17：<code>kubectl logs --tail=100 nginx-pod</code></h3><p><strong>命令说明</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl logs --tail<span class=o>=[</span>行数<span class=o>]</span> <span class=o>[</span>pod-name<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>作用</strong>：
仅显示<strong>最后 N 行</strong>日志，避免全量日志刷屏，快速查看最新事件</p><p><strong>输出</strong>：
直接输出最近的 100 条日志记录</p><p><strong>对比</strong>：<code>tail -f</code> vs <code>tail -n</code></p><ul><li><code>--tail</code>：<strong>静态</strong>输出最后 N 行</li><li><code>-f</code>：<strong>动态</strong>流式输出</li></ul><p><strong>权限要求</strong>：
同 <code>pods/log</code></p><hr><h3 id=命令18kubectl-logs-nginx-pod--c-sidecar>命令18：<code>kubectl logs nginx-pod -c sidecar</code></h3><p><strong>命令说明</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl logs <span class=o>[</span>pod-name<span class=o>]</span> -c <span class=o>[</span>container-name<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=c1># -c = --container，指定容器名称</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>作用</strong>：
<strong>多容器 Pod</strong> 中，精确查看特定容器的日志（默认仅查看第一个容器）</p><p><strong>使用场景</strong>：</p><ul><li>Sidecar 日志收集器（Fluentd）异常</li><li>Istio 代理（envoy）日志</li><li>初始化容器（initContainer）日志</li></ul><p><strong>典型 Pod 结构</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>nginx         </span><span class=w> </span><span class=c># 主容器</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>sidecar       </span><span class=w> </span><span class=c># 辅助容器</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>权限要求</strong>：</p><ul><li><code>pods/log</code> 权限即可，无需额外配置</li></ul><hr><h3 id=命令19kubectl-logs---previous-nginx-pod>命令19：<code>kubectl logs --previous nginx-pod</code></h3><p><strong>命令说明</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl logs --previous <span class=o>[</span>pod-name<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=c1># 或 -p（缩写）</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>作用</strong>：
查看<strong>上一个容器实例</strong>的日志（容器崩溃重启前的日志），诊断 CrashLoopBackOff 关键命令</p><p><strong>输出示例</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>panic: runtime error: index out of range [10] with length 10
</span></span><span class=line><span class=cl>goroutine 1 [running]:
</span></span><span class=line><span class=cl>main.main()
</span></span><span class=line><span class=cl>    /app/main.go:15 +0x2f
</span></span></code></pre></td></tr></table></div></div><p><strong>使用前提</strong>：</p><ul><li>Pod 必须<strong>至少重启过一次</strong>（RESTARTS > 0）</li><li>kubelet 保留旧日志（默认保留，直到被新日志覆盖）</li></ul><p><strong>权限要求</strong>：</p><ul><li><code>pods/log</code> 权限（部分集群需额外配置 <code>pods/log/previous</code>）</li></ul><p><strong>注意事项</strong>：</p><ul><li>若容器频繁重启（如每 10 秒），旧日志可能很快被覆盖</li><li>配合 <code>kubectl describe pod</code> 查看 Restart Count 和 Last State</li></ul><hr><h2 id=四生产环境建议>四、生产环境建议</h2><h3 id=41-避免手动创建-pod>4.1 避免手动创建 Pod</h3><h4 id=命令20kubectl-create-deployment-nginx-deploy---imagenginx125---replicas2>命令20：<code>kubectl create deployment nginx-deploy --image=nginx:1.25 --replicas=2</code></h4><p><strong>命令说明</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl create deployment <span class=o>[</span>name<span class=o>]</span> --image<span class=o>=[</span>image<span class=o>]</span> --replicas<span class=o>=[</span>number<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>作用</strong>：
创建 <strong>Deployment</strong> 控制器，自动管理 Pod 副本，实现<strong>自愈、滚动更新、回滚</strong></p><p><strong>对比：Pod vs Deployment</strong></p><div class=table-wrapper><table><thead><tr><th>特性</th><th>独立 Pod</th><th>Deployment</th></tr></thead><tbody><tr><td><strong>自愈</strong></td><td>❌ 删除后永久消失</td><td>✅ 自动重建</td></tr><tr><td><strong>扩缩容</strong></td><td>手动创建多个</td><td>✅ 一键扩缩</td></tr><tr><td><strong>更新</strong></td><td>手动删除重建</td><td>✅ 滚动更新</td></tr><tr><td><strong>版本管理</strong></td><td>❌</td><td>✅ 记录 revision</td></tr><tr><td><strong>生产推荐</strong></td><td>❌ 仅测试</td><td>✅ 标准方式</td></tr></tbody></table></div><p><strong>底层机制</strong>：</p><ul><li>Deployment → ReplicaSet → Pod</li><li>删除 Pod 后，ReplicaSet 立即创建新 Pod 保证副本数</li></ul><p><strong>权限要求</strong>：</p><ul><li><code>deployments/create</code>、<code>replicasets/create</code>、<code>pods/create</code></li><li>生产环境应通过 CI/CD 执行，<strong>禁止</strong>手动创建</li></ul><hr><h4 id=命令21kubectl-get-pods--l-appnginx-deploy>命令21：<code>kubectl get pods -l app=nginx-deploy</code></h4><p><strong>命令说明</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods -l <span class=o>[</span>label-key<span class=o>]=[</span>label-value<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=c1># -l = --selector，标签选择器</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>作用</strong>：
通过<strong>标签</strong>查询 Deployment 管理的所有 Pod，无需关心具体名称</p><p><strong>输出示例</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>NAME                            READY   STATUS    RESTARTS   AGE
</span></span><span class=line><span class=cl>nginx-deploy-5c6f7d8f99-abcde   1/1     Running   0          5m
</span></span><span class=line><span class=cl>nginx-deploy-5c6f7d8f99-fghij   1/1     Running   0          5m
</span></span></code></pre></td></tr></table></div></div><p><strong>优势</strong>：</p><ul><li>无需记忆自动生成的 Pod 后缀</li><li>Deployment 更新后 Pod 名称变化，但标签不变</li></ul><hr><h4 id=命令22kubectl-logs--l-appnginx-deploy>命令22：<code>kubectl logs -l app=nginx-deploy</code></h4><p><strong>命令说明</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl logs -l <span class=o>[</span>label<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>作用</strong>：
<strong>聚合查询</strong>所有匹配标签的 Pod 日志，批量查看</p><p><strong>权限要求</strong>：</p><ul><li><code>pods/log</code> 权限 + 标签选择器范围</li></ul><p><strong>注意事项</strong>：</p><ul><li>日志会<strong>交错输出</strong>，需配合 <code>--prefix</code> 区分来源</li><li>单个 Pod 日志量大的场景慎用</li></ul><hr><h3 id=42-常用别名与快捷方式>4.2 常用别名与快捷方式</h3><h4 id=命令23配置-shell-别名>命令23：配置 Shell 别名</h4><p><strong>配置方法</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ~/.bashrc 或 ~/.zshrc</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>k</span><span class=o>=</span><span class=s1>&#39;kubectl&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>kgp</span><span class=o>=</span><span class=s1>&#39;kubectl get pods&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>kgn</span><span class=o>=</span><span class=s1>&#39;kubectl get nodes&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>klogs</span><span class=o>=</span><span class=s1>&#39;kubectl logs&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>kdesc</span><span class=o>=</span><span class=s1>&#39;kubectl describe pod&#39;</span>
</span></span><span class=line><span class=cl><span class=nb>alias</span> <span class=nv>kevents</span><span class=o>=</span><span class=s1>&#39;kubectl get events&#39;</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>作用</strong>：
<strong>提升效率</strong>，减少重复输入（运维高频操作）</p><p><strong>生效方式</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>source</span> ~/.bashrc
</span></span></code></pre></td></tr></table></div></div><p><strong>安全注意事项</strong>：</p><ul><li>别名在<strong>共享环境</strong>（如 jump server）可能覆盖他人配置</li><li>脚本中<strong>禁用别名</strong>，应使用完整命令保证可移植性</li></ul><hr><h3 id=43-调试技巧>4.3 调试技巧</h3><h4 id=命令24kubectl-describe-pod-nginx-pod>命令24：<code>kubectl describe pod nginx-pod</code></h4><p><strong>命令说明</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl describe <span class=o>[</span>resource-type<span class=o>]</span> <span class=o>[</span>resource-name<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>作用</strong>：
<strong>获取 Pod 的详细状态信息</strong>，包括事件、资源、调度、网络等，是排查问题的<strong>首选命令</strong></p><p><strong>输出详解</strong>：</p><div class=table-wrapper><table><thead><tr><th>段落</th><th>关键信息</th><th>排查价值</th></tr></thead><tbody><tr><td><strong>Name/Namespace</strong></td><td>Pod 全称</td><td>确认查询对象正确</td></tr><tr><td><strong>Node</strong></td><td>所在节点</td><td>节点故障时定位</td></tr><tr><td><strong>Labels</strong></td><td>标签</td><td>Service 是否匹配</td></tr><tr><td><strong>Annotations</strong></td><td>注解</td><td>审计、监控配置</td></tr><tr><td><strong>Status</strong></td><td>Pod 阶段</td><td>Pending/CrashLoopBackOff</td></tr><tr><td><strong>IP</strong></td><td>Pod IP</td><td>网络连通性测试</td></tr><tr><td><strong>Containers</strong></td><td>容器状态</td><td>退出码、重启次数</td></tr><tr><td><strong>Events</strong></td><td><strong>核心事件</strong></td><td><strong>调度失败、镜像拉取、启动错误</strong></td></tr></tbody></table></div><p><strong>典型 Events 分析</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>Events:
</span></span><span class=line><span class=cl>  Type     Reason            Age   From               Message
</span></span><span class=line><span class=cl>  ----     ------            ----  ----               -------
</span></span><span class=line><span class=cl>  Warning  FailedScheduling  2m    default-scheduler  0/3 nodes are available: ...
</span></span><span class=line><span class=cl>  Warning  FailedMount       1m    kubelet            MountVolume.SetUp failed for volume &#34;pvc-xxx&#34;
</span></span><span class=line><span class=cl>  Warning  BackOff           30s   kubelet            Back-off restarting failed container
</span></span></code></pre></td></tr></table></div></div><p><strong>权限要求</strong>：</p><ul><li>需要 <code>pods/get</code> 权限</li><li>节点信息需 <code>nodes/get</code>（系统组件事件）</li></ul><hr><h2 id=五快速检查清单>五、快速检查清单</h2><h3 id=完整排查流程含命令详解>完整排查流程（含命令详解）</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Step 1: 全局确认 Pod 是否存在</span>
</span></span><span class=line><span class=cl>kubectl get pods -A <span class=p>|</span> grep nginx
</span></span><span class=line><span class=cl><span class=c1># 含义：扫描所有命名空间，过滤含 &#34;nginx&#34; 的 Pod</span>
</span></span><span class=line><span class=cl><span class=c1># 若为空 → 未创建或被删除</span>
</span></span><span class=line><span class=cl><span class=c1># 若有 → 记录 NAMESPACE 和完整 NAME</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 2: 确认当前操作上下文</span>
</span></span><span class=line><span class=cl>kubectl config view --minify <span class=p>|</span> grep namespace
</span></span><span class=line><span class=cl><span class=c1># 含义：查看当前默认命名空间</span>
</span></span><span class=line><span class=cl><span class=c1># 若返回空 → 使用 default</span>
</span></span><span class=line><span class=cl><span class=c1># 若返回其他 → 与 Step 1 结果对比</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 3: 按需创建测试 Pod</span>
</span></span><span class=line><span class=cl>kubectl run nginx-pod --image<span class=o>=</span>nginx:1.25
</span></span><span class=line><span class=cl><span class=c1># 含义：快速创建单容器 Pod测试</span>
</span></span><span class=line><span class=cl><span class=c1># 注意：生产环境禁用，应使用 Deployment</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 4: 持续监视状态变化</span>
</span></span><span class=line><span class=cl>kubectl get pods nginx-pod -w
</span></span><span class=line><span class=cl><span class=c1># 含义：watch 模式实时查看</span>
</span></span><span class=line><span class=cl><span class=c1># 预期：Pending → ContainerCreating → Running（30s内）</span>
</span></span><span class=line><span class=cl><span class=c1># 若卡 Pending → 立即执行 Step 5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 5: 详细诊断</span>
</span></span><span class=line><span class=cl>kubectl describe pod nginx-pod
</span></span><span class=line><span class=cl><span class=c1># 含义：获取完整信息和事件</span>
</span></span><span class=line><span class=cl><span class=c1># 重点查看 Events 段的 Reason/Message</span>
</span></span><span class=line><span class=cl><span class=c1># 常见：FailedScheduling/ImagePullBackOff/CrashLoopBackOff</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Step 6: 成功运行后查看日志</span>
</span></span><span class=line><span class=cl>kubectl logs nginx-pod --tail<span class=o>=</span><span class=m>20</span>
</span></span><span class=line><span class=cl><span class=c1># 含义：查看最后 20 行日志验证服务</span>
</span></span><span class=line><span class=cl><span class=c1># 预期：看到 Nginx 启动 success 信息</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=生产环境标准排查命令集>生产环境标准排查命令集</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 1. 检查 Deployment 状态（推荐）</span>
</span></span><span class=line><span class=cl>kubectl get deploy -n your-ns
</span></span><span class=line><span class=cl>kubectl describe deploy/nginx-deploy -n your-ns
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. 查看 Pod 列表（通过标签）</span>
</span></span><span class=line><span class=cl>kubectl get pods -l <span class=nv>app</span><span class=o>=</span>nginx -n your-ns
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. 查看 Pod 详细信息</span>
</span></span><span class=line><span class=cl>kubectl describe pod <span class=o>[</span>pod-name<span class=o>]</span> -n your-ns
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 4. 查看实时日志</span>
</span></span><span class=line><span class=cl>kubectl logs -f <span class=o>[</span>pod-name<span class=o>]</span> -n your-ns
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 5. 查看历史事件（30分钟内）</span>
</span></span><span class=line><span class=cl>kubectl get events -n your-ns --sort-by<span class=o>=</span><span class=s1>&#39;.lastTimestamp&#39;</span>
</span></span></code></pre></td></tr></table></div></div><hr><p><strong>总结</strong>：<code>kubectl get/describe/logs</code> 是排查 Pod NotFound 的核心三剑客，理解每个命令的<strong>权限范围、命名空间上下文、输出含义</strong>，是 Kubernetes 运维的基本功。生产环境务必遵循<strong>最小权限、声明式部署、标签化管理</strong>三大原则。</p></section><footer class=article-footer><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>本文采用 CC BY-NC-SA 4.0 许可协议</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/linux/vmware-ubuntu/><div class=article-details><h2 class=article-title>Ubuntu</h2></div></a></article><article><a href=/project/%E9%A1%B9%E7%9B%AE04centos%E9%83%A8%E7%BD%B2mha/><div class=article-details><h2 class=article-title>centos部署MHA</h2></div></a></article><article><a href=/docker/docker%E6%BA%90/><div class=article-details><h2 class=article-title>docker源</h2></div></a></article><article><a href=/linux/%E4%BF%AE%E6%94%B9%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/><div class=article-details><h2 class=article-title>修改网络配置</h2></div></a></article><article><a href=/posts/%E6%8A%80%E6%9C%AF%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B/><div class=article-details><h2 class=article-title>技术文件类型</h2></div></a></article></div></div></aside><script src=https://giscus.app/client.js data-repo data-repo-id data-category data-category-id data-mapping=title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=en data-loading crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark_dimmed")}})()</script><footer class=site-footer><section class=copyright>&copy;
2025 © 2025 win. 保留所有权利.</section><section class=powerby>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 构建<br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.31.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>