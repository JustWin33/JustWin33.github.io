<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="NFS 文件共享服务部署指南 1. 工作原理 NFS（Network File System）服务启动时会随机选择端口，因此客户端无法直接与NFS通信。NFS通过**RPC（Remote Procedure Call）**服务来解决这个问题：\n"><title>NFS</title><link rel=canonical href=http://localhost:1313/utility/nfs/><link rel=stylesheet href=/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css><meta property='og:title' content="NFS"><meta property='og:description' content="NFS 文件共享服务部署指南 1. 工作原理 NFS（Network File System）服务启动时会随机选择端口，因此客户端无法直接与NFS通信。NFS通过**RPC（Remote Procedure Call）**服务来解决这个问题：\n"><meta property='og:url' content='http://localhost:1313/utility/nfs/'><meta property='og:site_name' content='JustWin'><meta property='og:type' content='article'><meta property='article:section' content='Utility'><meta property='article:published_time' content='2025-12-14T00:00:00+00:00'><meta property='article:modified_time' content='2025-12-14T00:00:00+00:00'><meta property='og:image' content='http://localhost:1313/'><meta name=twitter:title content="NFS"><meta name=twitter:description content="NFS 文件共享服务部署指南 1. 工作原理 NFS（Network File System）服务启动时会随机选择端口，因此客户端无法直接与NFS通信。NFS通过**RPC（Remote Procedure Call）**服务来解决这个问题：\n"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='http://localhost:1313/'><link rel=stylesheet href=/css/custom.css><link rel="shortcut icon" href=/favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"light")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/images/avatar_hu_89ca753ea8ea85c7.jpg width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>✍️</span></figure><div class=site-meta><h1 class=site-name><a href=/>JustWin</a></h1><h2 class=site-description>分享技术与生活</h2></div></header><ol class=menu-social><li><a href=https://github.com/passion-win target=_blank title=GitHub rel=me><svg width="800" height="800" viewBox="0 0 20 20" xmlns:xlink="http://www.w3.org/1999/xlink"><title>github [#142]</title><desc>Created with Sketch.</desc><defs/><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Dribbble-Light-Preview" transform="translate(-140.000000, -7559.000000)" fill="#000"><g id="icons" transform="translate(56.000000, 160.000000)"><path d="M94 7399C99.523 7399 104 7403.59 104 7409.253 104 7413.782 101.138 7417.624 97.167 7418.981 96.66 7419.082 96.48 7418.762 96.48 7418.489 96.48 7418.151 96.492 7417.047 96.492 7415.675 96.492 7414.719 96.172 7414.095 95.813 7413.777 98.04 7413.523 100.38 7412.656 100.38 7408.718 100.38 7407.598 99.992 7406.684 99.35 7405.966 99.454 7405.707 99.797 7404.664 99.252 7403.252 99.252 7403.252 98.414 7402.977 96.505 7404.303 95.706 7404.076 94.85 7403.962 94 7403.958 93.15 7403.962 92.295 7404.076 91.497 7404.303 89.586 7402.977 88.746 7403.252 88.746 7403.252 88.203 7404.664 88.546 7405.707 88.649 7405.966 88.01 7406.684 87.619 7407.598 87.619 7408.718 87.619 7412.646 89.954 7413.526 92.175 7413.785 91.889 7414.041 91.63 7414.493 91.54 7415.156 90.97 7415.418 89.522 7415.871 88.63 7414.304 88.63 7414.304 88.101 7413.319 87.097 7413.247 87.097 7413.247 86.122 7413.234 87.029 7413.87 87.029 7413.87 87.684 7414.185 88.139 7415.37 88.139 7415.37 88.726 7417.2 91.508 7416.58 91.513 7417.437 91.522 7418.245 91.522 7418.489 91.522 7418.76 91.338 7419.077 90.839 7418.982 86.865 7417.627 84 7413.783 84 7409.253 84 7403.59 88.478 7399 94 7399" id="github-[#142]"/></g></g></g></svg></a></li><li><a href=https://t.me/+TFjBeZzowwU1YTY1 target=_blank title=telegram rel=me><svg viewBox="0 0 640 640"><path d="M320 72C183 72 72 183 72 320S183 568 320 568 568 457 568 320 457 72 320 72zM435 240.7C431.3 279.9 415.1 375.1 406.9 419c-3.5 18.6-10.3 24.8-16.9 25.4C375.6 445.7 364.7 434.9 350.7 425.7c-21.8-14.3-34.2-23.2-55.3-37.2C270.9 372.4 286.8 363.5 300.7 349 304.4 345.2 367.8 287.5 369 282.3 369.2 281.6 369.3 279.2 367.8 277.9 366.3 276.6 364.2 277.1 362.7 277.4 360.5 277.9 325.6 300.9 258.1 346.5 248.2 353.3 239.2 356.6 231.2 356.4 222.3 356.2 205.3 351.4 192.6 347.3 177.1 342.3 164.7 339.6 165.8 331 166.4 326.5 172.5 322 184.2 317.3 256.5 285.8 304.7 265 328.8 255c68.9-28.6 83.2-33.6 92.5-33.8C423.4 221.2 427.9 221.7 430.9 224.1 432.9 225.8 434.1 228.2 434.4 230.8 434.9 234 435 237.3 434.8 240.6z"/></svg></a></li><li><a href=https://twitter.com/@win1688888888 target=_blank title=twitter rel=me><svg width="800" height="800" viewBox="0 -2 20 20" xmlns:xlink="http://www.w3.org/1999/xlink"><title>twitter [#154]</title><desc>Created with Sketch.</desc><defs/><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Dribbble-Light-Preview" transform="translate(-60.000000, -7521.000000)" fill="#000"><g id="icons" transform="translate(56.000000, 160.000000)"><path d="M10.29 7377C17.837 7377 21.965 7370.84365 21.965 7365.50546 21.965 7365.33021 21.965 7365.15595 21.953 7364.98267 22.756 7364.41163 23.449 7363.70276 24 7362.8915 23.252 7363.21837 22.457 7363.433 21.644 7363.52751 22.5 7363.02244 23.141 7362.2289 23.448 7361.2926 22.642 7361.76321 21.761 7362.095 20.842 7362.27321 19.288 7360.64674 16.689 7360.56798 15.036 7362.09796 13.971 7363.08447 13.518 7364.55538 13.849 7365.95835 10.55 7365.79492 7.476 7364.261 5.392 7361.73762 4.303 7363.58363 4.86 7365.94457 6.663 7367.12996 6.01 7367.11125 5.371 7366.93797 4.8 7366.62489V7366.67608C4.801 7368.5989 6.178 7370.2549 8.092 7370.63591 7.488 7370.79836 6.854 7370.82199 6.24 7370.70483 6.777 7372.35099 8.318 7373.47829 10.073 7373.51078 8.62 7374.63513 6.825 7375.24554 4.977 7375.24358 4.651 7375.24259 4.325 7375.22388 4 7375.18549 5.877 7376.37088 8.06 7377 10.29 7376.99705" id="twitter-[#154]"/></g></g></g></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><span>首页</span></a></li><li><a href=/links/><span>网站</span></a></li><li><a href=/linux/><span>Linux</span></a></li><li><a href=/docker/><span>docker</span></a></li><li><a href=/k8s/><span>k8s</span></a></li><li><a href=/mysql/><span>mysql</span></a></li><li><a href=/project/><span>项目</span></a></li><li><a href=/kali/><span>kali</span></a></li><li><a href=/ubuntu/><span>ubuntu</span></a></li><li><a href=/utility/><span>Utility</span></a></li><li><a href=/about/><span>关于</span></a></li><li class=menu-bottom-section><ol class=menu><li id=i18n-switch><svg class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language title=language onchange="window.location.href=this.selectedOptions[0].value"><option value=http://localhost:1313/ selected>中文</option><option value=http://localhost:1313/en/>English</option></select></li><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>暗色模式</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#1-工作原理>1. 工作原理</a></li><li><a href=#2-环境准备>2. 环境准备</a></li><li><a href=#3-nfs-服务端配置>3. NFS 服务端配置</a><ol><li><a href=#31-安装软件包>3.1 安装软件包</a></li><li><a href=#32-启动服务>3.2 启动服务</a></li><li><a href=#33-检查服务状态>3.3 检查服务状态</a></li><li><a href=#34-配置共享目录>3.4 配置共享目录</a></li></ol></li><li><a href=#4-nfs-客户端配置>4. NFS 客户端配置</a><ol><li><a href=#41-安装软件包>4.1 安装软件包</a></li><li><a href=#42-发现共享>4.2 发现共享</a></li><li><a href=#43-挂载目录>4.3 挂载目录</a></li><li><a href=#44-权限问题处理重点>4.4 权限问题处理（重点）</a></li></ol></li><li><a href=#5-卸载与强制卸载>5. 卸载与强制卸载</a></li><li><a href=#6-配置文件参数详解>6. 配置文件参数详解</a></li><li><a href=#7-常用管理命令汇总>7. 常用管理命令汇总</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category></header><div class=article-title-wrapper><h2 class=article-title><a href=/utility/nfs/>NFS</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>2025-12-14</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>阅读时长: 4 分钟</time></div></footer></div></header><section class=article-content><h1 id=nfs-文件共享服务部署指南>NFS 文件共享服务部署指南</h1><h2 id=1-工作原理>1. 工作原理</h2><p>NFS（Network File System）服务启动时会随机选择端口，因此客户端无法直接与NFS通信。NFS通过**RPC（Remote Procedure Call）**服务来解决这个问题：</p><ol><li>NFS启动时，将随机端口注册到RPC服务（默认端口111）。</li><li>客户端连接NFS前，先向服务端的RPC服务查询NFS端口。</li><li>RPC告知客户端NFS的端口，客户端再通过该端口建立连接进行数据传输。</li></ol><blockquote><p><strong>注意</strong>：因此在启动NFS之前，必须先启动RPC服务（<code>rpcbind</code>）。</p></blockquote><hr><h2 id=2-环境准备>2. 环境准备</h2><p>为确保实验顺利，建议在服务端和客户端均执行以下操作（生产环境需通过防火墙放行特定端口）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 1. 关闭防火墙</span>
</span></span><span class=line><span class=cl>systemctl stop firewalld
</span></span><span class=line><span class=cl>systemctl disable firewalld
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. 关闭SELinux</span>
</span></span><span class=line><span class=cl>setenforce <span class=m>0</span>
</span></span><span class=line><span class=cl>sed -i <span class=s1>&#39;s/SELINUX=enforcing/SELINUX=disabled/&#39;</span> /etc/selinux/config
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=3-nfs-服务端配置>3. NFS 服务端配置</h2><h3 id=31-安装软件包>3.1 安装软件包</h3><p>服务端需要安装 <code>nfs-utils</code>（核心包）和 <code>rpcbind</code>（RPC服务）。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>yum -y install nfs-utils rpcbind
</span></span></code></pre></td></tr></table></div></div><h3 id=32-启动服务>3.2 启动服务</h3><p><strong>注意启动顺序</strong>：必须先启动 <code>rpcbind</code>，再启动 <code>nfs</code>。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 启动 rpcbind 并设置开机自启</span>
</span></span><span class=line><span class=cl>systemctl start rpcbind
</span></span><span class=line><span class=cl>systemctl <span class=nb>enable</span> rpcbind
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 启动 nfs 并设置开机自启</span>
</span></span><span class=line><span class=cl>systemctl start nfs
</span></span><span class=line><span class=cl>systemctl <span class=nb>enable</span> nfs
</span></span></code></pre></td></tr></table></div></div><h3 id=33-检查服务状态>3.3 检查服务状态</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 查看RPC端口（111）是否开启</span>
</span></span><span class=line><span class=cl>lsof -i:111
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查看本机RPC注册情况</span>
</span></span><span class=line><span class=cl>rpcinfo -p localhost
</span></span></code></pre></td></tr></table></div></div><h3 id=34-配置共享目录>3.4 配置共享目录</h3><p>NFS的主配置文件是 <code>/etc/exports</code>。</p><ol><li><p><strong>创建共享目录</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkdir /data
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>编辑配置文件</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vim /etc/exports
</span></span></code></pre></td></tr></table></div></div><p><strong>写入内容示例：</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>/data  192.168.200.0/24(rw,sync)
</span></span></code></pre></td></tr></table></div></div><p><em>解释：共享 <code>/data</code> 目录，允许 <code>192.168.200.0</code> 网段的所有主机访问，权限为读写（rw）且同步写入（sync）。</em></p></li><li><p><strong>生效配置</strong>
修改配置文件后，无需重启服务，使用 <code>exportfs</code> 命令即可生效：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>exportfs -rv
</span></span></code></pre></td></tr></table></div></div><ul><li><code>-r</code>: 重新挂载</li><li><code>-v</code>: 显示详细信息</li></ul></li><li><p><strong>本地验证</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>showmount -e localhost
</span></span><span class=line><span class=cl><span class=c1># 预期输出：Export list for localhost: /data 192.168.200.0/24</span>
</span></span></code></pre></td></tr></table></div></div></li></ol><hr><h2 id=4-nfs-客户端配置>4. NFS 客户端配置</h2><h3 id=41-安装软件包>4.1 安装软件包</h3><p>客户端也需要安装相关工具才能挂载。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 纠错：原文写成了 nfs-utlis，正确为 nfs-utils</span>
</span></span><span class=line><span class=cl>yum -y install nfs-utils rpcbind
</span></span></code></pre></td></tr></table></div></div><h3 id=42-发现共享>4.2 发现共享</h3><p>查看服务端（假设IP为 192.168.200.100）共享了哪些目录：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>showmount -e 192.168.200.100
</span></span></code></pre></td></tr></table></div></div><h3 id=43-挂载目录>4.3 挂载目录</h3><p>将服务端的 <code>/data</code> 挂载到本地的 <code>/mnt</code> 目录。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mount -t nfs 192.168.200.100:/data /mnt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 查看挂载情况</span>
</span></span><span class=line><span class=cl>df -hT <span class=p>|</span> grep nfs
</span></span></code></pre></td></tr></table></div></div><h3 id=44-权限问题处理重点>4.4 权限问题处理（重点）</h3><p><strong>现象</strong>：客户端挂载成功，但在 <code>/mnt</code> 下创建文件时提示 <code>Permission denied</code>（权限不够）。</p><p><strong>原因</strong>：
NFS默认配置了 <code>root_squash</code>（root用户压缩）。即：客户端使用 <code>root</code> 身份访问时，服务端会将其映射为匿名用户 <code>nfsnobody</code>（UID通常为65534）。如果服务端 <code>/data</code> 目录属于 <code>root</code> 用户，则 <code>nfsnobody</code> 没有写入权限。</p><p><strong>解决方法（二选一）</strong>：</p><ul><li><p><strong>方法A：修改服务端目录权限（推荐）</strong>
在<strong>服务端</strong>执行，将共享目录所有者改为 <code>nfsnobody</code>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>chown -R nfsnobody /data/
</span></span><span class=line><span class=cl><span class=c1># 此时客户端即可正常写入，文件属主会自动变为 nfsnobody</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p><strong>方法B：修改配置文件权限参数（不安全）</strong>
在 <code>/etc/exports</code> 中添加 <code>no_root_squash</code> 参数，允许客户端保留root权限：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>/data 192.168.200.0/24(rw,sync,no_root_squash)
</span></span></code></pre></td></tr></table></div></div></li></ul><hr><h2 id=5-卸载与强制卸载>5. 卸载与强制卸载</h2><p>正常卸载：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>umount /mnt
</span></span></code></pre></td></tr></table></div></div><p><strong>故障处理</strong>：如果提示 <code>umount: /mnt: target is busy</code>（设备忙），说明有进程正在使用该目录，或者网络已断开导致挂死。
<strong>强制卸载命令</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>umount -lf /mnt
</span></span></code></pre></td></tr></table></div></div><ul><li><code>-l</code> (lazy): 立即从文件系统层次结构中分离文件系统，并在不再繁忙时清理所有引用。</li><li><code>-f</code> (force): 强制卸载（主要用于NFS不可达时）。</li></ul><hr><h2 id=6-配置文件参数详解>6. 配置文件参数详解</h2><p><code>/etc/exports</code> 中常用参数说明：</p><div class=table-wrapper><table><thead><tr><th style=text-align:left>参数</th><th style=text-align:left>说明</th><th style=text-align:left>备注</th></tr></thead><tbody><tr><td style=text-align:left><strong>rw</strong></td><td style=text-align:left>读写权限</td><td style=text-align:left>Read-Write</td></tr><tr><td style=text-align:left><strong>ro</strong></td><td style=text-align:left>只读权限</td><td style=text-align:left>Read-Only</td></tr><tr><td style=text-align:left><strong>sync</strong></td><td style=text-align:left>同步写入</td><td style=text-align:left>数据同时写入内存和硬盘，数据安全但速度稍慢</td></tr><tr><td style=text-align:left><strong>async</strong></td><td style=text-align:left>异步写入</td><td style=text-align:left>数据先暂存内存，稍后写入硬盘，速度快但断电可能丢数据</td></tr><tr><td style=text-align:left><strong>root_squash</strong></td><td style=text-align:left>压缩root权限</td><td style=text-align:left><strong>默认启用</strong>。客户端root访问时，服务端映射为nfsnobody</td></tr><tr><td style=text-align:left><strong>no_root_squash</strong></td><td style=text-align:left>不压缩root权限</td><td style=text-align:left>客户端root访问时，服务端保留root权限（高风险）</td></tr><tr><td style=text-align:left><strong>all_squash</strong></td><td style=text-align:left>压缩所有用户</td><td style=text-align:left>无论客户端用什么身份，服务端都将其映射为匿名用户</td></tr><tr><td style=text-align:left><strong>anonuid/anongid</strong></td><td style=text-align:left>指定匿名ID</td><td style=text-align:left>配合 <code>all_squash</code> 使用，指定映射后的具体UID/GID</td></tr></tbody></table></div><hr><h2 id=7-常用管理命令汇总>7. 常用管理命令汇总</h2><div class=table-wrapper><table><thead><tr><th style=text-align:left>命令</th><th style=text-align:left>作用</th></tr></thead><tbody><tr><td style=text-align:left><code>rpcinfo -p</code></td><td style=text-align:left>查看RPC注册的端口信息</td></tr><tr><td style=text-align:left><code>showmount -e [IP]</code></td><td style=text-align:left>查看指定IP的NFS共享列表</td></tr><tr><td style=text-align:left><code>exportfs -rv</code></td><td style=text-align:left>重新加载配置文件并显示过程（无需重启服务）</td></tr><tr><td style=text-align:left><code>exportfs -auv</code></td><td style=text-align:left>暂停/卸载所有当前的共享</td></tr></tbody></table></div></section><footer class=article-footer><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>本文采用 CC BY-NC-SA 4.0 许可协议</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/utility/wireshar/><div class=article-details><h2 class=article-title>Wireshar</h2></div></a></article><article><a href=/utility/tcpdump/><div class=article-details><h2 class=article-title>Tcpdump</h2></div></a></article><article><a href=/utility/ansible/><div class=article-details><h2 class=article-title>Ansible</h2></div></a></article><article><a href=/utility/jenkins/><div class=article-details><h2 class=article-title>Jenkins</h2></div></a></article><article><a href=/utility/prometheus-/><div class=article-details><h2 class=article-title>Prometheus</h2></div></a></article></div></div></aside><script src=https://giscus.app/client.js data-repo data-repo-id data-category data-category-id data-mapping=title data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=en data-loading crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark_dimmed")}})()</script><footer class=site-footer><section class=copyright>&copy;
2025 © 2025 win. 保留所有权利.</section><section class=powerby>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 构建<br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.31.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>