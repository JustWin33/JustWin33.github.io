---
title: Linuxå‘½ä»¤
description: 
date: 2025-11-08
categories:
    - 
    - 
---



# ğŸ§ Linux è¿ç»´å‘½ä»¤

**é€‚ç”¨åœºæ™¯**ï¼šç³»ç»Ÿç®¡ç†ã€æ•…éšœæ’æŸ¥ã€æ€§èƒ½è°ƒä¼˜ã€è‡ªåŠ¨åŒ–è¿ç»´
**æ ¸å¿ƒåŸåˆ™**ï¼šç”Ÿäº§ç¯å¢ƒå®‰å…¨ç¬¬ä¸€ï¼Œæ“ä½œå‰ç¡®è®¤ï¼Œé«˜å±å‘½ä»¤éœ€è°¨æ…ã€‚

-----

## ğŸ“‚ ç¬¬ä¸€ç« ï¼šæ–‡ä»¶ç®¡ç†ä¸æœç´¢ (æ ¸å¿ƒåŸºç¡€)

### 1.1 ç›®å½•ä¸æ–‡ä»¶æ“ä½œå¢å¼ºç‰ˆ (`ls`, `cd`, `pwd`, `ln`)

  * **`ls` (List)**

      * `ls -lhS --color=auto`ï¼š**[æ¨è]** æŒ‰æ–‡ä»¶å¤§å°æ’åºï¼ˆå¤§æ–‡ä»¶åœ¨é¡¶ï¼‰ï¼Œæ˜¾ç¤ºå•ä½(KB/MB)ã€‚
      * `ls -lart`ï¼šæŒ‰ä¿®æ”¹æ—¶é—´å€’åºï¼ˆæœ€æ–°çš„åœ¨æœ€ä¸‹ï¼‰ï¼Œå¿«é€Ÿå®šä½åˆšåˆšè¢«æ”¹åŠ¨çš„æ–‡ä»¶ã€‚
      * `ls -i`ï¼šæŸ¥çœ‹ inode å·ï¼ˆè§£å†³æ–‡ä»¶åä¹±ç æ— æ³•åˆ é™¤çš„â€œé’‰å­æˆ·â€æ–‡ä»¶ï¼‰ã€‚

  * **`ln` (Link) â€”â€” é“¾æ¥ç®¡ç†**

      * `ln -s /path/to/source /path/to/link`ï¼š**[å¸¸ç”¨]** åˆ›å»ºè½¯é“¾æ¥ï¼ˆå¿«æ·æ–¹å¼ï¼‰ã€‚*æ³¨æ„ï¼šæºè·¯å¾„å»ºè®®å†™ç»å¯¹è·¯å¾„ï¼Œé˜²æ­¢å¤±æ•ˆã€‚*
      * `ln source target`ï¼šåˆ›å»ºç¡¬é“¾æ¥ï¼ˆåŒä¸€ä¸ª inodeï¼Œé˜²è¯¯åˆ ï¼‰ã€‚

### 1.2 æ–‡ä»¶å¢åˆ æ”¹ (`mkdir`, `rm`, `cp`, `mv`)

  * **`rm` (Remove) â€”â€” âš ï¸ é«˜å±åŒº**

      * **[é»„é‡‘æ³•åˆ™]**ï¼šä½¿ç”¨é€šé…ç¬¦å‰ï¼Œå…ˆç”¨ `ls` ç¡®è®¤ï¼ä¾‹å¦‚ï¼š`ls *.log && rm -f *.log`ã€‚
      * `rm -rf /path`ï¼šå¼ºåˆ¶é€’å½’åˆ é™¤ã€‚
      * **[é¿å‘]**ï¼šä¸¥ç¦åœ¨è„šæœ¬ä¸­ä½¿ç”¨ `rm -rf /${VAR}/*`ï¼Œå¦‚æœå˜é‡æœªå®šä¹‰ï¼Œå°±æ˜¯åˆ æ ¹ï¼

  * **`cp` (Copy) & `mv` (Move)**

      * `cp -a source dest`ï¼š**[å¤‡ä»½é¦–é€‰]** å®Œæ•´ä¿ç•™æƒé™ã€æ—¶é—´æˆ³ã€æ‰€å±ä¸»ï¼ˆç­‰åŒäº `-dR --preserve=all`ï¼‰ã€‚
      * `mv -b source dest`ï¼šå¦‚æœç›®æ ‡å­˜åœ¨ï¼Œå…ˆè‡ªåŠ¨å¤‡ä»½ç›®æ ‡æ–‡ä»¶ï¼ˆç”Ÿæˆ `file~`ï¼‰ã€‚

### 1.3 æ–‡ä»¶æŸ¥æ‰¾ä¸å†…å®¹æŸ¥çœ‹ (`find`, `tail`, `less`)

  * **`find` (æœç´¢ç¥å™¨)**

      * `find /var/log -name "*.log" -mtime +7`ï¼šæŸ¥æ‰¾ `/var/log` ä¸‹ 7 å¤©å‰çš„ log æ–‡ä»¶ã€‚
      * `find / -size +100M`ï¼š**[ç£ç›˜æ¸…ç†]** å…¨ç›˜æŸ¥æ‰¾å¤§äº 100M çš„å¤§æ–‡ä»¶ã€‚
      * `find . -name "*.tmp" -exec rm -f {} \;`ï¼šæŸ¥æ‰¾å¹¶ç›´æ¥åˆ é™¤ï¼ˆæ…ç”¨ï¼‰ã€‚
      * `find / -perm -u=s -type f`ï¼šæŸ¥æ‰¾å…·æœ‰ SUID æƒé™çš„å±é™©æ–‡ä»¶ï¼ˆå®‰å…¨å®¡è®¡ï¼‰ã€‚

  * **å†…å®¹æŸ¥çœ‹**

      * `tail -f app.log`ï¼š**[è¿ç»´é«˜é¢‘]** å®æ—¶ç›‘æ§æ—¥å¿—æœ«å°¾è¾“å‡ºã€‚
      * `tail -100f app.log`ï¼šæŸ¥çœ‹æœ€å 100 è¡Œå¹¶ä¿æŒå®æ—¶åˆ·æ–°ã€‚
      * `less file`ï¼šç¿»é¡µæŸ¥çœ‹å¤§æ–‡ä»¶ï¼ˆæ¯” `cat` æ›´æœ‰åˆ©äºå†…å­˜ï¼ŒæŒ‰ `G` åˆ°åº•éƒ¨ï¼Œ`/keyword` æœç´¢ï¼‰ã€‚

-----

## ğŸ“Š ç¬¬äºŒç« ï¼šç³»ç»Ÿèµ„æºä¸æ€§èƒ½æ·±åº¦ç›‘æ§

### 2.1 CPU ä¸ è´Ÿè½½ (`top`, `uptime`, `mpstat`)

  * **`top` (å®æ—¶ç›‘æ§)**

      * `top -Hp <PID>`ï¼š**[æ’æŸ¥ç¥å™¨]** æŸ¥çœ‹æŒ‡å®šè¿›ç¨‹å†…çš„**çº¿ç¨‹**èµ„æºå ç”¨ï¼ˆå®šä½ Java/Go æŸçº¿ç¨‹é«˜è´Ÿè½½ï¼‰ã€‚
      * *å¿«æ·é”®*ï¼š`1` (å±•å¼€å¤šæ ¸), `c` (æ˜¾ç¤ºå®Œæ•´å‘½ä»¤è·¯å¾„), `k` (æ€è¿›ç¨‹).
      * **[Load Average è§£è¯»]**ï¼šå³ä¸Šè§’çš„ä¸‰ä¸ªæ•°å­—åˆ†åˆ«ä»£è¡¨ 1ã€5ã€15 åˆ†é’Ÿçš„å¹³å‡è´Ÿè½½ã€‚å¦‚æœæ•°å€¼ \> CPU æ ¸æ•°ï¼Œè¯´æ˜ç³»ç»Ÿè¿‡è½½ã€‚

  * **`vmstat` (è™šæ‹Ÿå†…å­˜ä¸ç³»ç»Ÿç“¶é¢ˆ)**

      * `vmstat 1`ï¼šæ¯ç§’åˆ·æ–°ã€‚
      * **[å…³é”®æŒ‡æ ‡]**ï¼š
          * `r` (Run)ï¼šè¿è¡Œé˜Ÿåˆ—ï¼Œ\> CPU æ ¸æ•° = CPU ç“¶é¢ˆã€‚
          * `b` (Block)ï¼šç­‰å¾… IO çš„è¿›ç¨‹æ•°ï¼Œé«˜è¯´æ˜ç£ç›˜ IO å µå¡ã€‚
          * `si/so`ï¼šé 0 è¯´æ˜ç‰©ç†å†…å­˜ä¸å¤Ÿï¼Œæ­£åœ¨ç”¨ Swapã€‚

### 2.2 å†…å­˜åˆ†æ (`free`, `smem`)

  * **`free`**
      * `free -h`ï¼šçœ‹å†…å­˜æ€»é‡ã€‚
      * **[æ ¸å¿ƒè®¤çŸ¥]**ï¼šLinux å†…å­˜ç®¡ç†ç­–ç•¥æ˜¯â€œåƒå…‰ç”¨å°½â€ã€‚`buff/cache` å ç”¨é«˜æ˜¯æ­£å¸¸çš„ï¼ˆç”¨äºåŠ é€Ÿè¯»å†™ï¼‰ï¼Œé‡ç‚¹çœ‹ `available`ï¼ˆåº”ç”¨ç¨‹åºçœŸæ­£å¯ç”¨çš„ï¼‰ã€‚

### 2.3 ç£ç›˜ IO (`iostat`, `iotop`, `du`, `df`)

  * **`iostat`**

      * `iostat -xzk 1`ï¼šè¯¦ç»† IO ç»Ÿè®¡ã€‚
      * **[åˆ¤æ®]**ï¼š`%util` \> 80% (ç£ç›˜å¿™ç¢Œ)ï¼›`await` \> 10ms (å“åº”æ…¢)ï¼›`svctm` (å®é™…å¤„ç†æ—¶é—´)ã€‚

  * **`du` / `df`**

      * `df -Th`ï¼šæŸ¥çœ‹åˆ†åŒºç±»å‹ï¼ˆxfs/ext4ï¼‰å’Œä½¿ç”¨ç‡ã€‚
      * `df -i`ï¼šæŸ¥çœ‹ inode ä½¿ç”¨ç‡ï¼ˆinode è€—å°½ä¼šå¯¼è‡´æœ‰ç©ºé—´ä½†æ— æ³•å†™å…¥ï¼‰ã€‚
      * `du -h --max-depth=1 /var | sort -hr | head -10`ï¼š**[ç©ºé—´æ¸…ç†]** å¿«é€Ÿæ‰¾å‡º `/var` ä¸‹æœ€å¤§çš„ 10 ä¸ªç›®å½•ã€‚

-----

## ğŸŒ ç¬¬ä¸‰ç« ï¼šç½‘ç»œä¸è¿æ¥ (æ–°å¢å¢å¼ºç« èŠ‚)

### 3.1 ç½‘ç»œè¿æ¥ä¸æµé‡ (`ss`, `iftop`, `nload`)

  * **`ss` (Socket Statistics - æ¨èæ›¿ä»£ netstat)**

      * `ss -tulnp`ï¼šæ˜¾ç¤ºæ‰€æœ‰ç›‘å¬ç«¯å£åŠå¯¹åº”çš„è¿›ç¨‹åï¼ˆéœ€ rootï¼‰ã€‚
      * `ss -an state established`ï¼šæŸ¥çœ‹æ‰€æœ‰å·²å»ºç«‹çš„è¿æ¥ã€‚
      * `ss -s`ï¼šå¿«é€Ÿç»Ÿè®¡è¿æ¥æ€»æ•°ï¼ˆSYN, ESTABLISHED ç­‰ï¼‰ã€‚

  * **`iftop`**

      * `iftop -P`ï¼šå®æ—¶æµé‡ç›‘æ§ï¼Œæ˜¾ç¤ºè°åœ¨è·Ÿè°é€šä¿¡ï¼Œä»¥åŠå ç”¨çš„å¸¦å®½ã€‚

### 3.2 ç½‘ç»œè¿é€šæ€§æµ‹è¯• (`curl`, `nc`, `ping`)

  * **`curl` (æ¥å£æµ‹è¯•)**

      * `curl -I www.google.com`ï¼šåªçœ‹ HTTP å“åº”å¤´ï¼ˆæ£€æŸ¥ 200 OKï¼‰ã€‚
      * `curl -v http://127.0.0.1:8080`ï¼šæ‰“å°è¯¦ç»†é€šä¿¡è¿‡ç¨‹ï¼ˆDebug ä¸“ç”¨ï¼‰ã€‚
      * `curl -o /dev/null -s -w "%{time_total}\n" http://baidu.com`ï¼šæµ‹è¯•ç½‘ç«™å“åº”è€—æ—¶ã€‚

  * **`nc` (Netcat - ç½‘ç»œç‘å£«å†›åˆ€)**

      * `nc -z -v -w 2 192.168.1.1 3306`ï¼š**[æ¢æµ‹ç«¯å£]** æ¢æµ‹ç›®æ ‡ IP çš„ 3306 ç«¯å£æ˜¯å¦é€šï¼ˆæ›¿ä»£ telnetï¼‰ã€‚

  * **`ip` (IPé…ç½®)**

      * `ip addr`ï¼šæŸ¥çœ‹ IP åœ°å€ï¼ˆæ›¿ä»£ ifconfigï¼‰ã€‚
      * `ip route`ï¼šæŸ¥çœ‹è·¯ç”±è¡¨ï¼ˆæ’æŸ¥ç½‘å…³é—®é¢˜ï¼‰ã€‚

-----

## ğŸ“ ç¬¬å››ç« ï¼šæ–‡æœ¬å¤„ç†â€œä¸‰å‰‘å®¢â€ (è¿ç»´å¿…ä¿®)

### 4.1 `grep` (è¿‡æ»¤)

  * `grep -r "Error" /var/log/`ï¼šé€’å½’æœç´¢ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ã€‚
  * `grep -E "Failed|Error" file`ï¼šæ­£åˆ™åŒ¹é…å¤šä¸ªå…³é”®è¯ã€‚
  * `grep -v "^#" config.conf | grep -v "^$"`ï¼š**[é…ç½®æ¸…æ´—]** å»é™¤é…ç½®æ–‡ä»¶ä¸­çš„æ³¨é‡Šè¡Œå’Œç©ºè¡Œã€‚
  * `grep -C 5 "Exception" app.log`ï¼šæŸ¥çœ‹æŠ¥é”™å‰å 5 è¡Œä¸Šä¸‹æ–‡ã€‚

### 4.2 `awk` (å–åˆ—ä¸ç»Ÿè®¡)

  * `awk '{print $1, $NF}' file`ï¼šæ‰“å°ç¬¬ 1 åˆ—å’Œæœ€åä¸€åˆ—ã€‚
  * **[å®æˆ˜] ç»Ÿè®¡ Nginx æ—¥å¿— Top 10 è®¿é—® IP**ï¼š
    ```bash
    awk '{print $1}' access.log | sort | uniq -c | sort -nr | head -10
    ```
  * **[å®æˆ˜] ç»Ÿè®¡ TCP è¿æ¥çŠ¶æ€**ï¼š
    ```bash
    ss -an | awk '{print $1}' | sort | uniq -c
    ```

### 4.3 `sed` (æ›¿æ¢ä¸ä¿®æ”¹)

  * `sed 's/old/new/g' file`ï¼šåœ¨å±å¹•è¾“å‡ºæ›¿æ¢ç»“æœã€‚
  * `sed -i.bak 's/8080/9090/g' config.xml`ï¼š**[å®‰å…¨]** ç›´æ¥ä¿®æ”¹æ–‡ä»¶ï¼Œå¹¶è‡ªåŠ¨å¤‡ä»½ä¸º `.bak`ã€‚
  * `sed -n '/10:00/,/11:00/p' access.log`ï¼šæŒ‰æ—¶é—´èŒƒå›´æˆªå–æ—¥å¿—ã€‚

-----

## ğŸ’» ç¬¬äº”ç« ï¼šè¿›ç¨‹ç®¡ç†

  * **`ps` & `pgrep`**

      * `ps aux --sort=-%cpu | head`ï¼šåˆ—å‡ºæœ€è€— CPU çš„è¿›ç¨‹ã€‚
      * `pgrep -a java`ï¼šæŸ¥çœ‹æ‰€æœ‰ Java è¿›ç¨‹çš„å®Œæ•´å‘½ä»¤ã€‚

  * **`kill`**

      * `kill -15 <PID>`ï¼š**[æ¨è]** ä¼˜é›…é€€å‡ºï¼ˆTERM ä¿¡å·ï¼‰ã€‚
      * `kill -9 <PID>`ï¼šå¼ºåˆ¶æ€æ­»ï¼ˆKILL ä¿¡å·ï¼Œå¯èƒ½ä¸¢æ•°æ®ï¼‰ã€‚
      * `pkill -u user1`ï¼šè¸¢æ‰æŸä¸ªç”¨æˆ·çš„æ‰€æœ‰è¿›ç¨‹ã€‚

-----

## ğŸ› ï¸ ç¬¬å…­ç« ï¼šç³»ç»ŸæœåŠ¡ä¸æ—¥å¿— (Systemd)

  * **`systemctl`**

      * `systemctl status/start/stop/restart nginx`
      * `systemctl enable nginx`ï¼šå¼€æœºè‡ªå¯ã€‚
      * `systemctl list-units --type=service --state=failed`ï¼š**[æ•…éšœæ¦‚è§ˆ]** åˆ—å‡ºæ‰€æœ‰æŒ‚æ‰çš„æœåŠ¡ã€‚

  * **`journalctl`**

      * `journalctl -u nginx -f`ï¼šå®æ—¶çœ‹æŸæœåŠ¡æ—¥å¿—ã€‚
      * `journalctl -xe`ï¼šæœåŠ¡å¯åŠ¨å¤±è´¥æ—¶ï¼Œçœ‹è¯¦ç»†æŠ¥é”™å †æ ˆã€‚
      * `journalctl --disk-usage` / `journalctl --vacuum-time=7d`ï¼šæŸ¥çœ‹å¹¶æ¸…ç† 7 å¤©å‰çš„ç³»ç»Ÿæ—¥å¿—ã€‚

-----

## ğŸ“¦ ç¬¬ä¸ƒç« ï¼šå‹ç¼©ã€ä¼ è¾“ä¸è½¯ä»¶åŒ…

### 7.1 å‹ç¼© (`tar`)

  * `tar -czf backup.tar.gz /data`ï¼šæ‰“åŒ…å‹ç¼©ã€‚
  * `tar -xzf backup.tar.gz -C /opt`ï¼šè§£å‹åˆ°æŒ‡å®šç›®å½•ã€‚

### 7.2 ä¼ è¾“ (`rsync`, `scp`)

  * `scp -r /local/dir user@host:/remote/dir`ï¼šç®€å•çš„è¿œç¨‹æ‹·è´ã€‚
  * `rsync -avzP /source/ user@host:/dest/`ï¼š**[æ¨è]** å¢é‡åŒæ­¥ï¼Œæ˜¾ç¤ºè¿›åº¦æ¡ (`P`)ã€‚

### 7.3 è½¯ä»¶åŒ…ç®¡ç† (åŸºç¡€)

  * **CentOS/RHEL**: `yum update`, `yum install tree`, `yum clean all`.
  * **Ubuntu/Debian**: `apt update`, `apt install tree`.

-----

## ğŸ” ç¬¬å…«ç« ï¼šç”¨æˆ·æƒé™ä¸å®‰å…¨åŠ å›º

  * **`chmod` / `chown`**

      * `chmod 755 file` (è„šæœ¬å¸¸ç”¨) / `chmod 600 id_rsa` (ç§é’¥æ–‡ä»¶å¿…é¡»æƒé™)ã€‚
      * `chown -R user:group /data`ã€‚

  * **`chattr` (æ–‡ä»¶é”)**

      * `chattr +i /etc/passwd`ï¼š**[é˜²é»‘]** é”å®šå…³é”®æ–‡ä»¶ï¼Œroot ä¹Ÿæ— æ³•ä¿®æ”¹/åˆ é™¤ã€‚
      * `lsattr file`ï¼šæŸ¥çœ‹é”å®šçŠ¶æ€ã€‚

  * **`sudo`**

      * `visudo`ï¼šç¼–è¾‘ sudo æƒé™é…ç½®ï¼ˆè¯­æ³•æ£€æŸ¥é˜²é”™ï¼‰ã€‚

-----

## âš™ï¸ ç¬¬ä¹ç« ï¼šå†…æ ¸ä¸ç¡¬ä»¶ä¿¡æ¯ (ä¸“å®¶çº§)

  * `uname -a` / `cat /etc/os-release`ï¼šæŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬å†…æ ¸ã€‚
  * `lscpu`ï¼šæŸ¥çœ‹ CPU æ¶æ„æ ¸æ•°ã€‚
  * `lsblk`ï¼šæŸ¥çœ‹ç£ç›˜åˆ†åŒºæŒ‚è½½ã€‚
  * `dmesg | tail -20`ï¼š**[ç¡¬ä»¶æ•…éšœ]** æŸ¥çœ‹å†…æ ¸ç¯å½¢ç¼“å†²åŒºï¼ˆOOM Killerã€ç¡¬ä»¶æŠ¥é”™éƒ½åœ¨è¿™ï¼‰ã€‚
  * `sysctl -p`ï¼šé‡æ–°åŠ è½½å†…æ ¸å‚æ•°ï¼ˆå¦‚ TCP è°ƒä¼˜åï¼‰ã€‚

-----

## ğŸ§© ç¬¬åç« ï¼šç”Ÿäº§ç¯å¢ƒæ•…éšœæ’æŸ¥å®æˆ˜æ¡ˆä¾‹ (FAQ)

### æ¡ˆä¾‹ 1ï¼šCPU 100% ä½†æ‰¾ä¸åˆ°é«˜è´Ÿè½½è¿›ç¨‹

**ç°è±¡**ï¼š`top` CPU é«˜ï¼Œä½†è¿›ç¨‹åˆ—è¡¨é‡Œæ²¡æœ‰ç‰¹åˆ«é«˜çš„ã€‚
**åŸå› **ï¼šçŸ­å‘½è¿›ç¨‹ï¼ˆé¢‘ç¹å¯åŠ¨é€€å‡ºï¼‰æˆ– å†…æ ¸æ€å ç”¨ã€‚
**æ’æŸ¥**ï¼š

1.  çœ‹ `top` è¡¨å¤´çš„ `sy` (System) å’Œ `wa` (IO Wait)ã€‚
2.  å¦‚æœæ˜¯ `sy` é«˜ï¼Œå¯èƒ½æ˜¯é©±åŠ¨æˆ–å†…æ ¸ bugã€‚
3.  å¦‚æœæ˜¯ `wa` é«˜ï¼Œä½¿ç”¨ `iotop` æŠ“ç£ç›˜è¯»å†™è¿›ç¨‹ã€‚

### æ¡ˆä¾‹ 2ï¼šç£ç›˜æ»¡äº†ä½† `du` ç»Ÿè®¡ä¸åˆ°å¤§æ–‡ä»¶

**ç°è±¡**ï¼š`df -h` æ˜¾ç¤º 100%ï¼Œ`du -sh` å´åªæœ‰ 50%ã€‚
**åŸå› **ï¼šæ–‡ä»¶è¢« `rm` åˆ é™¤ï¼Œä½†è¿›ç¨‹ä»æŒæœ‰å¥æŸ„ï¼ˆæ–‡ä»¶æœªçœŸæ­£é‡Šæ”¾ï¼‰ã€‚
**æ’æŸ¥**ï¼š

```bash
lsof | grep deleted
```

**è§£å†³**ï¼šé‡å¯æŒæœ‰å¥æŸ„çš„è¿›ç¨‹ï¼ˆå¦‚ nginx/javaï¼‰ï¼Œæˆ– `echo > /proc/<PID>/fd/<FD>` ç½®ç©ºã€‚

### æ¡ˆä¾‹ 3ï¼šæœåŠ¡å™¨å˜æ…¢ï¼Œç½‘ç»œå¡é¡¿

**æ’æŸ¥ä¸‰æ¿æ–§**ï¼š

1.  `ping <ç½‘å…³>`ï¼šçœ‹å†…ç½‘å»¶è¿Ÿä¸¢åŒ…ã€‚
2.  `curl -v <ç›®æ ‡>`ï¼šçœ‹ TCP å»ºè¿è€—æ—¶ã€‚
3.  `dmesg | grep -i "error"`ï¼šçœ‹ç½‘å¡æ˜¯å¦æœ‰ç‰©ç†æŠ¥é”™ã€‚

-----

## ğŸ“œ ç¬¬åä¸€ç« ï¼šè‡ªåŠ¨åŒ–å·¡æ£€è„šæœ¬ (æœ€ç»ˆç‰ˆ)

ä¿å­˜ä¸º `health_check.sh`ï¼š

```bash
#!/bin/bash
# Linux System Health Check Script
# V2.0 - Added Colors and detailed checks

RED='\033[0;31m'
GREEN='\033[0;32m'
NC='\033[0m' # No Color

echo -e "${GREEN}===== System Health Check $(date) =====${NC}"

# 1. è´Ÿè½½æ£€æŸ¥
load=$(uptime | awk -F'load average:' '{ print $2 }' | cut -d, -f1 | tr -d ' ')
echo -e "\n[1] Load Average (1min): $load"
if (( $(echo "$load > 4.0" | bc -l) )); then
    echo -e "${RED}ALERT: High Load!${NC}"
fi

# 2. ç£ç›˜ç©ºé—´ (>85% å‘Šè­¦)
echo -e "\n[2] Disk Usage > 85%:"
df -h | grep -vE '^Filesystem|tmpfs|cdrom' | awk '{ print $5 " " $1 }' | while read output;
do
  usep=$(echo $output | awk '{ print $1}' | cut -d'%' -f1  )
  partition=$(echo $output | awk '{ print $2 }' )
  if [ $usep -ge 85 ]; then
    echo -e "${RED}WARNING: Running out of space \"$partition ($usep%)\"${NC}"
  else
    echo "  OK: $partition ($usep%)"
  fi
done

# 3. å†…å­˜æƒ…å†µ
echo -e "\n[3] Memory Usage:"
free -h

# 4. æ£€æŸ¥å¤±è´¥çš„æœåŠ¡
echo -e "\n[4] Failed Systemd Services:"
failed_services=$(systemctl list-units --type=service --state=failed --no-pager --plain | grep ".service")
if [ -n "$failed_services" ]; then
    echo -e "${RED}$failed_services${NC}"
else
    echo "  All services are healthy."
fi

# 5. æ£€æŸ¥åƒµå°¸è¿›ç¨‹
zombies=$(ps aux | awk '{if ($8=="Z") print $0}' | wc -l)
echo -e "\n[5] Zombie Processes: $zombies"

echo -e "\n${GREEN}===== Check Complete =====${NC}"
```

